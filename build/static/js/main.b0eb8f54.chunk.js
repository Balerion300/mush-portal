(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{204:function(e,t,n){e.exports=n(402)},384:function(e,t,n){},386:function(e,t,n){},400:function(e,t,n){},402:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),l=n(28),s=n.n(l),o=n(7),r=n(6),c=n(13),u=n(12),d=n(14),h=n(11),m=n(140),p=n.n(m),f=n(92),w=n.n(f),b=Object(h.createMuiTheme)({typography:{useNextVariants:!0},palette:{primary:w.a,secondary:p.a,type:"dark"}}),g=n(162),E=n.n(g),v=n(154),y=n.n(v),k=n(155),S=n.n(k),x=n(26),C=n.n(x),N=n(16),O=n.n(N),j=n(23),T=n.n(j),A=n(153),P=n.n(A),M=n(75),I=n.n(M),L=n(34),R=n.n(L),B=n(31),_=n.n(B),U=n(37),D=n.n(U),H=n(163),F=n.n(H),W=n(27),G=n.n(W),z=n(22),K=n.n(z),X=n(24),q=n.n(X),V=n(94),J=n.n(V),Y=n(74),Z=n.n(Y),$=n(160),Q=n.n($),ee=n(156),te=n.n(ee),ne=n(159),ae=n.n(ne),ie=n(157),le=n.n(ie),se=n(158),oe=n.n(se),re=n(166),ce=n.n(re),ue=n(164),de=n.n(ue),he=n(76),me=n.n(he),pe=n(77),fe=n.n(pe),we=n(165),be=n.n(we),ge=n(161),Ee=n.n(ge),ve=n(167),ye=n.n(ve),ke=n(141),Se=n(35),xe=n(39),Ce=n.n(xe),Ne=n(30),Oe=n.n(Ne),je=n(32),Te=n.n(je),Ae=n(38),Pe=n.n(Ae),Me=n(36),Ie=n.n(Me),Le=n(5),Re=n.n(Le),Be=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).show=function(e){n.setState({anchor:e.currentTarget})},n.hide=function(){n.setState({anchor:null})},n.choose=function(e){return function(t){n.hide(),n.setState({value:e}),n.props.onChange(e)}},n.state={anchor:null,value:e.value};var a=e.background?40:30;n.rows=[];var i,l,s=[];for(i=0;i<8;i++)s.push("ansi-"+(i+a));for(i=0;i<8;i++)s.push("ansi-"+(i+a)+"-1");for(n.rows.push(s),i=1;i<16;i++){for(s=[],l=0;l<16;l++)s.push("ansi-"+(8+a)+"-5-"+(16*i+l));n.rows.push(s)}return n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.classes,l=n.background,s=n.label,o=this.state,r=o.anchor,c=o.value;return l&&(e=a.bgfix),i.a.createElement("div",null,i.a.createElement(O.a,{"aria-haspopup":"true","aria-owns":r?"colorpicker":null,onClick:this.show},i.a.createElement("div",{className:c},s)),i.a.createElement(D.a,{className:a.popover,id:"colorpicker",anchorEl:r,open:Boolean(r),onClose:this.hide},this.rows.map(function(n,l){return i.a.createElement("div",{key:1e3+l},n.map(function(n,s){return i.a.createElement("span",{key:16*l+s,className:Re()(a.swatch,e,n),onClick:t.choose(n)},"\u2588")}))})))}}]),t}(i.a.Component),_e=Object(h.withStyles)(function(e){return{popover:{overflow:"hidden"},swatch:{cursor:"pointer",margin:0,border:0,padding:0,height:"1em",width:"1em",lineHeight:"100%"},bgfix:{color:"transparent"}}},{withTheme:!0})(Be),Ue=n(142),De=n.n(Ue),He=n(80),Fe=n.n(He),We=n(143),Ge=n.n(We),ze=n(144),Ke=n.n(ze),Xe=n(145),qe=n.n(Xe),Ve=n(148),Je=n.n(Ve),Ye=n(149),Ze=n.n(Ye),$e=n(146),Qe=n.n($e),et=n(147),tt=n.n(et),nt=n(152),at=n.n(nt),it=n(151),lt=n.n(it),st=n(93),ot=n.n(st),rt=n(150),ct=n.n(rt),ut=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSwitch=function(e){return function(t){window.client.changeSetting(e,t.target.checked),n.setState(Object(Se.a)({},e,window.client.settings[e])),window.client.saveSettings(),window.client.react.portal.forceUpdate()}},n.handleValue=function(e){return function(t){window.client.changeSetting(e,t.target.value),n.setState(Object(Se.a)({},e,window.client.settings[e])),window.client.saveSettings(),window.client.react.portal.forceUpdate()}},n.handleColor=function(e){return function(t){window.client.changeSetting(e,t),n.setState(Object(Se.a)({},e,window.client.settings[e])),window.client.saveSettings(),window.client.react.portal.forceUpdate()}},n.showColor=function(e){return function(t){n.color=e,n.setState({colorAnchor:t.currentTarget})}},n.closeColor=function(){n.setState({colorAnchor:null})},n.chooseColor=function(e){return function(t){n.setState(Object(Se.a)({},n.color,"ansi-"+e)),n.closeColor()}},n.loadSettings=function(){n.setState(Object(ke.a)({},window.client.settings))},n.resetSettings=function(){window.confirm("Are you sure you want to reset settings to defaults?")&&(window.client.settings=Object.assign({},window.client.defaultSettings),n.loadSettings(),window.client.saveSettings(),window.client.react.portal.forceUpdate())},n.state={colorAnchor:null},n.color=null,n.state=Object.assign(n.state,window.client.settings),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.closeDrawer,a=this.state,l=a.debugEvents,s=a.decompileEditor,o=a.decompileKey,r=a.ansiFG,c=a.ansiBG,u=a.wrapWidth,d=a.invertHighlight,h=a.sidebarOpen,m=a.sidebarAnchor,p=a.sidebarAlwaysShow,f=a.colorAnchor,w=a.sidebarShowPlayers,b=a.sidebarShowThings,g=a.sidebarShowExits,E=a.sidebarShowCompass,v=a.sidebarWidth;return i.a.createElement("div",{className:t.frame},i.a.createElement("div",{className:t.left},i.a.createElement("div",{className:t.content,tabIndex:0,role:"button"},i.a.createElement(D.a,{id:"settings.color",anchorEl:f,open:!1,onClose:this.closeColor}),i.a.createElement(G.a,{disablePadding:!0,dense:!0,subheader:i.a.createElement(Pe.a,null,"Debugging")},i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(De.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Debug server events?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{checked:l,value:"debugEvents",onChange:this.handleSwitch("debugEvents")})))),i.a.createElement(G.a,{disablePadding:!0,dense:!0,subheader:i.a.createElement(Pe.a,null,"Display Settings")},i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(Ge.a,null)),i.a.createElement(_.a,{label:"Terminal Width",value:u,onChange:this.handleValue("wrapWidth"),type:"number"})),i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(Fe.a,null)),i.a.createElement(_e,{label:"Background Color",value:c,onChange:this.handleColor("ansiBG"),background:!0})),i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(Fe.a,null)),i.a.createElement(_e,{label:"Foreground Color",value:r,onChange:this.handleColor("ansiFG")})),i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(Fe.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Swap black and white?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{checked:d,value:"invertHighlight",onChange:this.handleSwitch("invertHighlight")})))),i.a.createElement(G.a,{disablePadding:!0,dense:!0,subheader:i.a.createElement(Pe.a,null,"@decompile/tf")},i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(Ke.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Send @dec/tf to editor."}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{checked:s,value:"decompileEditor",onChange:this.handleSwitch("decompileEditor")}))),i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(qe.a,null)),i.a.createElement(_.a,{label:"TFPREFIX",value:o,onChange:this.handleValue("decompileKey"),helperText:"Prefix used by @dec/tf."}))),i.a.createElement(G.a,{disablePadding:!0,dense:!0,subheader:i.a.createElement(Pe.a,null,"Sidebar Display")},i.a.createElement(K.a,{dense:!0},i.a.createElement(Oe.a,null,i.a.createElement(Qe.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Show sidebar?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{checked:h,value:"sidebarOpen",onChange:this.handleSwitch("sidebarOpen")}))),i.a.createElement(K.a,{dense:!0,disabled:!h},i.a.createElement(Oe.a,null,i.a.createElement(tt.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Keep panels off sidebar?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{disabled:!h,checked:p,value:"sidebarAlwaysShow",onChange:this.handleSwitch("sidebarAlwaysShow")}))),i.a.createElement(K.a,{dense:!0,disabled:!h},i.a.createElement(Ce.a,{color:"action"},i.a.createElement(Je.a,null)),i.a.createElement(q.a,{primary:"Left"}),i.a.createElement(Ie.a,{checked:"right"===m,color:"default",disabled:!h,value:"right"===m?"left":"right",onChange:this.handleValue("sidebarAnchor")}),i.a.createElement(q.a,{primary:"Right"}),i.a.createElement(Ce.a,{color:"action"},i.a.createElement(Ze.a,null))),i.a.createElement(K.a,{dense:!0,disabled:!h},i.a.createElement(Oe.a,null,i.a.createElement(ct.a,null)),i.a.createElement(_.a,{label:"Sidebar Width",value:v,onChange:this.handleValue("sidebarWidth")}))),i.a.createElement(G.a,{disabled:!h,disablePadding:!0,dense:!0,subheader:i.a.createElement(Pe.a,null,"Sidebar Content")},i.a.createElement(K.a,{dense:!0,disabled:!h},i.a.createElement(Oe.a,null,i.a.createElement(lt.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Show players?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{disabled:!h,checked:w,value:"sidebarShowPlayers",onChange:this.handleSwitch("sidebarShowPlayers")}))),i.a.createElement(K.a,{dense:!0,disabled:!h},i.a.createElement(Oe.a,null,i.a.createElement(at.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Show things?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{disabled:!h,checked:b,value:"sidebarShowThings",onChange:this.handleSwitch("sidebarShowThings")}))),i.a.createElement(K.a,{dense:!0,disabled:!h},i.a.createElement(Oe.a,null,i.a.createElement(ot.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Show exits?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{checked:g,disabled:!h,value:"sidebarShowExits",onChange:this.handleSwitch("sidebarShowExits")}))),i.a.createElement(K.a,{dense:!0,disabled:!h||!g},i.a.createElement(Oe.a,null,i.a.createElement(ot.a,null)),i.a.createElement(q.a,{className:t.switchText,primary:"Show compass?"}),i.a.createElement(Te.a,null,i.a.createElement(Ie.a,{disabled:!h||!g,checked:E,value:"sidebarShowCompass",onChange:this.handleSwitch("sidebarShowCompass")})))))),i.a.createElement("div",{className:t.right},i.a.createElement("div",{className:t.buttons},i.a.createElement(O.a,{className:t.reset,onClick:this.resetSettings},"Reset"),i.a.createElement(O.a,{className:t.close,onClick:n},"Close"))))}}]),t}(i.a.Component),dt=Object(h.withStyles)(function(e){return{frame:{position:"relative",height:"auto",width:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"stretch"},left:{flex:1},right:{display:"flex",flexFlow:"column nowrap"},content:{display:"flex",justifyContent:"flex-end"},switchText:{paddingLeft:0,marginRight:2*e.spacing.unit},buttons:{flex:1,display:"flex",flexFlow:"row nowrap",height:"100%"}}},{withTheme:!0})(ut);function ht(e){return e.count>0?i.a.createElement(P.a,{badgeContent:e.count,color:"error"},e.children):e.children}var mt=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).openDrawer=function(){n.closeMenu(),n.setState({open:!0})},n.closeDrawer=function(){n.setState({open:!1}),window.client.react.portal.forceUpdate(),window.client.focus(!0)},n.setTitle=function(e){n.setState({title:e})},n.clearScreen=function(){window.confirm("Do you want to clear the screen?")&&window.client.clear()},n.sendCommand=function(e){window.client.sendCommand(e)},n.sendText=function(e){window.client.sendText(e)},n.sendAPI=function(e,t){window.client.sendAPI(e,t)},n.setUnreadMail=function(e){n.setState({unreadMail:e})},n.setUnreadBB=function(e){n.setState({unreadBB:e})},n.pushTask=function(e){var t=n.state.taskbar;t.push(e),n.setState({taskbar:t})},n.popTask=function(e){var t=n.state.taskbar,a=t.indexOf(e);t.splice(a,1),e.unsmallify(),e.front(),n.setState({taskbar:t})},n.showMenu=function(e){n.setState({menuAnchor:e.currentTarget})},n.closeMenu=function(){n.setState({menuAnchor:null}),window.client.focus(!0)},n.showHelp=function(e){n.help=null,n.setState({helpAnchor:e.currentTarget})},n.closeHelp=function(){n.setState({helpAnchor:null}),window.client.focus(!0)},n.typeHelp=function(e){n.help=e.target.value},n.searchHelp=function(e){e.preventDefault(),n.help&&n.help.length>0?window.client.sendCommand("help "+n.help):window.client.sendCommand("help"),n.closeHelp()},n.showUpload=function(e){n.file=null,n.closeMenu(),n.setState({uploadAnchor:e.currentTarget})},n.closeUpload=function(){n.setState({uploadAnchor:null}),window.client.focus(!0)},n.insertCommand=function(e){return function(t){window.client.input.root.value=e,n.closeHistory()}},n.clearHistory=function(){window.confirm("Do you want to clear the command history?")&&(window.client.input.clearHistory(),n.closeHistory())},n.showHistory=function(e){n.closeMenu(),n.setState({historyAnchor:e.currentTarget})},n.closeHistory=function(){n.setState({historyAnchor:null}),window.client.focus(!0)},n.showLog=function(e){n.logname=null,n.closeMenu(),n.setState({logAnchor:e.currentTarget})},n.closeLog=function(){n.setState({logAnchor:null}),window.client.focus(!0)},n.typeLog=function(e){n.logname=e.target.value},n.saveLog=function(e){e.preventDefault(),n.logname&&n.logname.length>0&&(window.client.saveLog(n.logname+".txt"),n.closeLog())},n.typeURL=function(e){n.url=e.target.value},n.previewUpload=function(){window.client.addReactPanel("Upload"),n.file&&n.file.length>0&&window.client.react.upload.setText(n.file),n.closeUpload()},n.handleFile=function(e){e.preventDefault();var t=e.target.files;if(t.length>0){var a=new FileReader;a.onload=function(){n.file=a.result,n.previewUpload()},a.readAsText(t[0])}},n.handleURL=function(e){if(e.preventDefault(),n.url&&n.url.startsWith("http")){var t=new window.XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?(n.file=t.responseText,n.previewUpload()):alert("Unable to download URL! See console for more information."))},t.open("GET",n.url),t.send()}},n.state={open:!1,title:e.title,taskbar:[],unreadBB:0,unreadMail:0,menuAnchor:null,uploadAnchor:null,helpAnchor:null,logAnchor:null,historyAnchor:null},n.help="",n.url="",n.file="",n.logname="",n.history=null,n.frame=i.a.createRef(),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"reconnect",value:function(){window.confirm("Do you want to reconnect?")&&window.client.conn.reconnect()}},{key:"componentDidMount",value:function(){window.client.react.taskbar=this}},{key:"componentWillUnmount",value:function(){window.client.react.taskbar=null}},{key:"render",value:function(){var e=this,t=window.client.input,n=this.props.classes,a=this.state,l=a.title,s=a.taskbar,o=a.open,r=a.unreadBB,c=a.unreadMail,u=a.historyAnchor,d=a.menuAnchor,h=a.uploadAnchor,m=a.helpAnchor,p=a.logAnchor,f=t?t.history.slice().reverse():[];return i.a.createElement(y.a,{className:n.root,position:"static",onClick:function(){return window.client.focus()}},i.a.createElement(S.a,{disableGutters:!this.state.open},i.a.createElement(C.a,{variant:"h6",color:"inherit",noWrap:!0,className:n.title},l),i.a.createElement("div",{className:n.flex}),s.map(function(t,a){return i.a.createElement(T.a,{key:a,title:t.headertitle.innerText},i.a.createElement(O.a,{key:t.id,classes:{label:n.tasklabel},className:n.taskbutton,"aria-label":"open-task",onClick:function(){return e.popTask(t)}},i.a.createElement(te.a,{className:n.taskicon}),t.headertitle.innerText))}),i.a.createElement("div",{className:n.tasksep}),i.a.createElement(T.a,{title:"Look around."},i.a.createElement(O.a,{"aria-label":"send-look",onClick:function(){e.sendCommand("look"),e.sendAPI("listcontents")}},i.a.createElement(le.a,null))),i.a.createElement(T.a,{title:"What am I carrying?"},i.a.createElement(O.a,{"aria-label":"send-inventory",onClick:function(){return e.sendCommand("inventory")}},i.a.createElement(oe.a,null))),i.a.createElement(T.a,{title:"Who's online?"},i.a.createElement(O.a,{"aria-label":"send-who",onClick:function(){return e.sendCommand("who")}},i.a.createElement(ae.a,null))),i.a.createElement(T.a,{title:"Bulletin Boards"},i.a.createElement(O.a,{"aria-label":"open-bbs",onClick:function(){return e.sendAPI("boardlist")}},i.a.createElement(ht,{count:r},i.a.createElement(Q.a,null)))),i.a.createElement(T.a,{title:"@mail Inbox"},i.a.createElement(O.a,{"aria-label":"open-mail",onClick:function(){return e.sendAPI("maillist")}},i.a.createElement(ht,{count:c},i.a.createElement(Z.a,null)))),i.a.createElement(T.a,{title:"Need help?"},i.a.createElement(O.a,{"aria-owns":m?"taskbar.help":null,"aria-label":"help","aria-haspopup":"true",onClick:this.showHelp},i.a.createElement(Ee.a,null))),i.a.createElement(T.a,{title:"More tasks..."},i.a.createElement(O.a,{"aria-owns":d?"taskbar.menu":null,"aria-label":"open-menu","aria-haspopup":"true",onClick:this.showMenu},i.a.createElement(J.a,null))),i.a.createElement(E.a,{variant:"temporary",anchor:"top",open:o,onClose:this.closeDrawer,onOpen:this.openDrawer},i.a.createElement(dt,{closeDrawer:this.closeDrawer})),i.a.createElement(D.a,{id:"taskbar.help",anchorEl:m,open:Boolean(m),onClose:this.closeHelp},i.a.createElement("form",{onSubmit:this.searchHelp},i.a.createElement(_.a,{label:"Help topic",className:n.padded,autoComplete:"false",autoFocus:!0,variant:"outlined",onChange:this.typeHelp})),i.a.createElement(O.a,{fullWidth:!0,onClick:this.searchHelp},"Get Help")),i.a.createElement(D.a,{id:"taskbar.log",anchorEl:p,open:Boolean(p),onClose:this.closeLog},i.a.createElement("form",{onSubmit:this.saveLog},i.a.createElement(_.a,{label:"File Name",variant:"outlined",className:n.padded,onChange:this.typeLog,autoFocus:!0,InputProps:{inputProps:{style:{textAlign:"right"}},endAdornment:i.a.createElement(F.a,{position:"end"},".txt")}})),i.a.createElement(O.a,{fullWidth:!0,onClick:this.saveLog},"Save Log")),i.a.createElement(D.a,{id:"taskbar.upload",anchorEl:h,open:Boolean(h),onClose:this.closeUpload},i.a.createElement("form",{onSubmit:this.handleURL,className:n.padded},i.a.createElement(_.a,{type:"url",fullWidth:!0,label:"Insert URL",variant:"outlined",onChange:this.typeURL,autoFocus:!0})),i.a.createElement(O.a,{onClick:this.handleURL},"Upload URL"),i.a.createElement("input",{accept:"text/plain",className:n.fileinput,id:"file.upload",type:"file",onChange:this.handleFile}),i.a.createElement("label",{htmlFor:"file.upload"},i.a.createElement(O.a,{component:"span"},"Choose File")),i.a.createElement(O.a,{onClick:this.previewUpload},"Paste Text")),i.a.createElement(D.a,{id:"taskbar.history",anchorEl:u,open:Boolean(u),onClose:this.closeHistory},i.a.createElement(G.a,{className:n.historyPopover},f.map(function(t,n){return i.a.createElement(K.a,{key:n,button:!0,dense:!0,divider:!0,onClick:e.insertCommand(t)},i.a.createElement(q.a,{primary:t}))})),i.a.createElement(O.a,{onClick:this.clearHistory},"Clear History")),i.a.createElement(I.a,{disableEnforceFocus:!0,id:"taskbar.menu",anchorEl:d,open:Boolean(d),onClick:this.closeMenu,onClose:this.closeMenu},i.a.createElement(R.a,{onClick:this.closeMenu},i.a.createElement(T.a,{title:"Close menu."},i.a.createElement(J.a,null))),i.a.createElement(R.a,{onClick:this.openDrawer},i.a.createElement(T.a,{title:"Change settings."},i.a.createElement(me.a,null))),i.a.createElement(R.a,{"aria-owns":h?"taskbar.upload":null,"aria-label":"open-upload","aria-haspopup":"true",onClick:this.showUpload},i.a.createElement(T.a,{title:"Upload file/URL."},i.a.createElement(fe.a,null))),i.a.createElement(R.a,{"aria-owns":p?"taskbar.log":null,"aria-label":"open-log","aria-haspopup":"true",onClick:this.showLog},i.a.createElement(T.a,{title:"Save display log."},i.a.createElement(de.a,null))),i.a.createElement(R.a,{"aria-owns":u?"taskbar.history":null,"aria-label":"open-history","aria-haspopup":"true",onClick:this.showHistory},i.a.createElement(T.a,{title:"Show command history."},i.a.createElement(be.a,null))),i.a.createElement(R.a,{onClick:this.clearScreen},i.a.createElement(T.a,{title:"Clear screen."},i.a.createElement(ce.a,null))),i.a.createElement(R.a,{onClick:this.reconnect},i.a.createElement(T.a,{title:"Reconnect."},i.a.createElement(ye.a,null)))),i.a.createElement("div",{className:n.tasksep})))}}]),t}(i.a.Component),pt=Object(h.withStyles)(function(e){return{root:{flexGrow:1},title:{margin:"0 20px"},tasksep:{marginRight:e.spacing.unit},taskbutton:{margin:e.spacing.unit},taskicon:{marginRight:e.spacing.unit},tasklabel:{},cmdbutton:{},cmdlabel:{display:"flex","flex-direction":"column"},flex:{flex:1},drawerFrame:{width:"100%"},drawerButton:{margin:e.spacing.unit},hide:{display:"none"},drawerPaper:{position:"relative",height:240},mailButton:{margin:e.spacing.unit},BBButton:{margin:e.spacing.unit},fileinput:{display:"none"},padded:{width:"calc(100%-"+2*e.spacing.unit+")",padding:-e.spacing.unit,margin:e.spacing.unit},historyPopover:{maxHeight:"10em",overflowY:"auto"}}},{withTheme:!0})(mt),ft=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).focusInput=function(){window.client.focus()},n.onResize=function(e){window.client.output.calcDimensions(),window.client.sendText("SCREENWIDTH "+window.client.settings.wrapWidth),window.client.sendText("SCREENHEIGHT "+Math.floor(window.client.output.root.parentNode.clientHeight/window.client.output.dims.height)),window.client.output.scrollDown(),n.onChange()},n.onChange=function(){n.setState({lines:n.linesOfScroll()})},n.state={lines:0},n.terminal=i.a.createRef(),n.output=i.a.createRef(),n.prompt=i.a.createRef(),n.init=!1,n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("resize",this.onResize),window.client.react.terminal=this,window.client.initOutput(this.output.current,this.terminal.current),window.client.initPrompt(this.prompt.current),this.init=!0,this.forceUpdate()}},{key:"linesOfScroll",value:function(){return window.client.output.linesOfScroll()}},{key:"render",value:function(){var e,t=this.props,n=t.classes,a=t.width,l=t.ansiFG,s=t.ansiBG,o=t.containerRef,r=this.state.lines;return e=this.init?a*window.client.output.dims.width+"px":"100%",i.a.createElement("div",{id:"terminal-container",className:n.frame,onClick:this.focusInput,ref:o},i.a.createElement("div",{ref:this.terminal,className:Re()(n.terminal,l,s),onScroll:this.onChange},i.a.createElement("div",{ref:this.output,className:Re()(n.output,l,s),style:{maxWidth:e}})),i.a.createElement("div",{className:n.taskbar},i.a.createElement("div",{ref:this.prompt,className:Re()(n.prompt,l,s)}),i.a.createElement("div",{className:n.scrollcount},i.a.createElement(C.a,{color:"error",align:"right"},r>0&&"...and "+r+" more lines..."))))}}]),t}(i.a.Component),wt=Object(h.withStyles)(function(e){return{frame:Object(Se.a)({position:"relative",display:"flex","flex-flow":"column nowrap",margin:0,padding:0,border:"none","background-color":e.palette.primary.main,flex:1,height:"100%","font-family":"'Courier New', monospace","font-weight":"normal","font-size":"10pt"},e.breakpoints.down("sm"),{"font-size":"5pt"}),terminal:{flex:1,position:"relative",overflowY:"scroll",overflowX:"hidden",padding:"0.25em 0.5em"},output:{"white-space":"pre-wrap","word-wrap":"break-word",position:"absolute",margin:0,border:0,padding:0},taskbar:{padding:"0",position:"relative",overflow:"hidden"},prompt:{overflow:"hidden","white-space":"pre-wrap","text-align":"left","vertical-align":"middle",height:"1em",padding:"0.25em"},scrollcount:{position:"absolute",right:0,bottom:0}}},{withTheme:!0})(ft),bt=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n.input=i.a.createRef(),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.client.react.input=this,window.client.initInput(this.input.current)}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",{className:e.frame},i.a.createElement("textarea",{ref:this.input,className:e.text,autoComplete:"off",autoFocus:!0}))}}]),t}(i.a.Component),gt=Object(h.withStyles)(function(e){return{frame:{"background-color":e.palette.primary.main,display:"flex"},text:{flex:1,"background-color":"black",color:"silver",margin:"1px 0 0 0",border:"none",outline:"none","vertical-align":"middle",padding:"0.25em",resize:"none",height:"3em","font-family":"'Courier New', monospace","font-weight":"normal","font-size":"16pt"}}},{withTheme:!0})(bt),Et=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={status:"."},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"setStatus",value:function(e){this.setState({status:e})}},{key:"componentDidMount",value:function(){window.client.react.statusbar=this}},{key:"componentWillUnmount",value:function(){window.client.react.statusbar=null}},{key:"render",value:function(){var e=this.props.classes,t=this.state.status;return i.a.createElement("div",{className:e.frame,onClick:function(){return window.client.focus()}},i.a.createElement(C.a,{align:"right",color:"textPrimary",noWrap:!0},t))}}]),t}(i.a.Component),vt=Object(h.withStyles)(function(e){return{frame:{background:e.palette.primary.main,margin:0,border:"none",outline:"none","text-align":"right","vertical-align":"middle",padding:"0.25em"}}},{withTheme:!0})(Et),yt=n(168),kt=n.n(yt),St=n(172),xt=n.n(St),Ct=n(170),Nt=n.n(Ct),Ot=n(171),jt=n.n(Ot),Tt=n(169),At=n.n(Tt),Pt=n(176),Mt=n.n(Pt),It=n(33),Lt=n.n(It),Rt=n(175),Bt=n.n(Rt),_t=n(174),Ut=n.n(_t),Dt=n(173),Ht=n.n(Dt),Ft=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).openLogin=function(e){n.setState({open:!0}),n.setState({msg:e}),n.focusInput("username")},n.closeLogin=function(){n.setState({open:!1}),window.client.focus()},n.submitLogin=function(){var e=document.getElementById("username").value,t=document.getElementById("password").value;document.getElementById("password").value="";var a='connect "'+e+'" '+t;window.client.sendText(a),n.closeLogin()},n.submitGuest=function(){window.client.sendText("connect guest"),n.closeLogin()},n.submitCreate=function(){var e=document.getElementById("username").value,t=document.getElementById("password").value;document.getElementById("password").value="";var a='create "'+e+'" '+t;window.client.sendText(a),n.closeLogin()},n.catchReturn=function(e){"Enter"===e.key&&(n.submitLogin(),e.preventDefault())},n.state={open:!1,msg:null},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"focusInput",value:function(e){var t=document.getElementById(e);t&&t.focus()}},{key:"componentDidMount",value:function(){window.client.react.login=this}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.open,a=t.msg;return i.a.createElement("div",{className:e.frame},i.a.createElement(kt.a,{open:n,onEscapeKeyDown:function(){return window.client.react.taskbar.openDrawer()},onClose:this.closeLogin,"aria-labelledby":"responsive-dialog-title",disableBackdropClick:!0,disableEscapeKeyDown:!0},i.a.createElement(At.a,{className:e.title,id:"responsive-dialog-title"},"Character Login",i.a.createElement(Te.a,null,i.a.createElement(Lt.a,{onClick:function(){return window.client.react.taskbar.openDrawer()}},i.a.createElement(me.a,null)))),i.a.createElement(Nt.a,null,i.a.createElement(jt.a,null,i.a.createElement("span",{dangerouslySetInnerHTML:{__html:a}})),i.a.createElement(_.a,{className:e.text,margin:"dense",id:"username",label:"Character Name",type:"string",fullWidth:!0,onKeyPress:this.catchReturn}),i.a.createElement(_.a,{className:e.text,margin:"dense",id:"password",label:"Password",type:"password",fullWidth:!0,onKeyPress:this.catchReturn})),i.a.createElement(xt.a,null,i.a.createElement(O.a,{className:e.left,classes:{label:e.block},onClick:this.submitCreate,color:"primary",variant:"extendedFab"},i.a.createElement(Ht.a,null),"Register"),i.a.createElement(O.a,{classes:{label:e.block},onClick:this.submitGuest,color:"primary",variant:"extendedFab"},i.a.createElement(Ut.a,null),"Guest"),i.a.createElement(O.a,{classes:{label:e.block},onClick:this.submitLogin,color:"primary",variant:"extendedFab","aria-label":"login"},i.a.createElement(Bt.a,null),"Login"))))}}]),t}(i.a.Component),Wt=Mt()()(Object(h.withStyles)(function(e){return{frame:{},left:{marginRight:"auto"},text:{"font-size":"16pt"},title:{position:"relative"},block:{display:"flex","flex-direction":"column"}}},{withTheme:!0})(Ft)),Gt=n(185),zt=n.n(Gt),Kt=n(186),Xt=n.n(Kt),qt=n(42),Vt=n.n(qt),Jt=n(180),Yt=n.n(Jt),Zt=n(179),$t=n.n(Zt),Qt=n(177),en=n.n(Qt),tn=n(178),nn=n.n(tn),an=n(181),ln=n.n(an),sn=n(182),on=n.n(sn),rn=n(183),cn=n.n(rn),un=n(184),dn=n.n(un),hn={NORTH:i.a.createElement(en.a,null),SOUTH:i.a.createElement(nn.a,null),WEST:i.a.createElement($t.a,null),EAST:i.a.createElement(Yt.a,null),SOUTHEAST:i.a.createElement(Vt.a,null,i.a.createElement("polygon",{points:"12,12 0,12 12,0"})),SOUTHWEST:i.a.createElement(Vt.a,null,i.a.createElement("polygon",{points:"12,12 12,0 24,12"})),NORTHEAST:i.a.createElement(Vt.a,null,i.a.createElement("polygon",{points:"12,12 12,24 0,12"})),NORTHWEST:i.a.createElement(Vt.a,null,i.a.createElement("polygon",{points:"12,12 12,24 24,12"})),UP:i.a.createElement(ln.a,null),DOWN:i.a.createElement(on.a,null),IN:i.a.createElement(cn.a,null),OUT:i.a.createElement(dn.a,null)},mn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).go=function(e){return function(t){var a=window.client,i=a.jsonapi,l=a.delayContents;e&&e.length>0&&(n.sendCommand("go "+e),i||(clearTimeout(n.getContents),setTimeout(n.getContents,l)))}},n.action=function(e){window.client.sendCommand("look"),window.client.sendAPI("listcontents")},n.matchExit=function(e){for(var t=0;t<n.ucExits.length;t++){if(-1!==n.ucExits[t].split(";").indexOf(e))return t}return-1},n.buildExit=function(e){var t=e.toUpperCase(),a=-1===n.matchExit(t);return i.a.createElement(T.a,{disabled:a,title:e},i.a.createElement("span",null,i.a.createElement(Lt.a,{onClick:n.go(e),disabled:a},hn[t])))},n.sendCommand=function(e){window.client.sendCommand(e)},n.state={exits:[],things:[],players:[],friends:[]},n.ucExits=[],n.customExits=[],n.useCompass=!1,n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"parseExits",value:function(e){var t=this,n=this.props.sidebarShowCompass;if(this.ucExits=[],this.customExits=[],this.useCompass=!1,e.forEach(function(e,n){t.ucExits.push(e.toUpperCase())}),n)for(var a=Object.keys(hn),i=function(n){var i=t.ucExits[n],l=-1;i.split(";").forEach(function(e,t){-1===l&&(l=a.indexOf(e))}),-1===l?t.customExits.push(e[n]):t.useCompass=!0},l=0;l<e.length;l++)i(l);else this.customExits=e.slice(0)}},{key:"getContents",value:function(){window.client.sendAPI("listcontents")}},{key:"updateExits",value:function(e){this.setState({exits:e})}},{key:"updateThings",value:function(e){this.setState({things:e})}},{key:"updatePlayers",value:function(e){this.setState({players:e})}},{key:"addObject",value:function(e){var t=this.state,n=t.players,a=t.things;e.player?(n.push(e.name),this.setState({players:n})):(a.push(e.name),this.setState({things:a}))}},{key:"delObject",value:function(e){var t,n=this.state,a=n.players,i=n.things;e.player?-1!==(t=a.indexOf(e.name))&&(a.splice(t,1),this.setState({players:a})):-1!==(t=i.indexOf(e.name))&&(i.splice(t,1),this.setState({things:i}))}},{key:"componentDidMount",value:function(){window.client.react.sidebar=this,window.client.sendAPI("listcontents")}},{key:"componentWillUnMount",value:function(){window.client.react.sidebar=null}},{key:"render",value:function(){var e,t,n=this,a=this.props,l=a.classes,s=a.sidebarWidth,o=a.sidebarShowPlayers,r=a.sidebarShowThings,c=a.sidebarShowExits,u=a.sidebarShowCompass,d=this.state,h=d.exits,m=d.things,p=d.players,f=this.customExits;return c&&(this.parseExits(h),f.length>0&&(e=i.a.createElement("div",{className:l.customExits},i.a.createElement("div",{className:l.bottom},i.a.createElement(G.a,{dense:!0,disablePadding:!0,subheader:i.a.createElement(Pe.a,{component:"div"},"Other Exits")},f.map(function(e,t){return i.a.createElement(K.a,{className:l.exitItem,key:t,button:!0,onClick:n.go(e.split(";")[0])},i.a.createElement(q.a,{primary:e.split(";")[0]}))}))))),this.useCompass&&(t=i.a.createElement("div",{className:l.navWidget},i.a.createElement(C.a,{variant:"subtitle2",color:"textSecondary"},"Navigation"),this.buildExit("Northwest"),this.buildExit("North"),this.buildExit("Northeast"),this.buildExit("Up"),i.a.createElement("br",null),this.buildExit("West"),this.buildExit("In"),this.buildExit("East"),this.buildExit("Out"),i.a.createElement("br",null),this.buildExit("Southwest"),this.buildExit("South"),this.buildExit("Southeast"),this.buildExit("Down")))),i.a.createElement("div",{className:l.frame,style:{width:s},onClick:function(){return window.client.focus()}},i.a.createElement("div",{className:l.contents},i.a.createElement("span",null,o&&p.length>0&&i.a.createElement(G.a,{dense:!0,disablePadding:!0,subheader:i.a.createElement(Pe.a,{component:"div"},"Players")},p.map(function(e,t){return i.a.createElement(K.a,{disableGutters:!0,className:l.playerItem,key:t,button:!0,onClick:function(){return n.sendCommand("look "+e)}},i.a.createElement(zt.a,null,i.a.createElement(Xt.a,null,e.split(" ").map(function(e){return e[0]}).join(""))),i.a.createElement(q.a,{primary:e}))})),r&&m.length>0&&i.a.createElement(G.a,{dense:!0,disablePadding:!0,subheader:i.a.createElement(Pe.a,{component:"div"},"Contents")},m.map(function(e,t){return i.a.createElement(K.a,{className:l.thingItem,key:t,button:!0,onClick:function(){return n.sendCommand("look "+e)}},i.a.createElement(q.a,{primary:e}))})))),c&&e,c&&u&&t)}}]),t}(i.a.Component),pn=Object(h.withStyles)(function(e){return{frame:{position:"relative",height:"100%",minWidth:"192px",backgroundColor:e.palette.background.paper,display:"flex","flex-flow":"column nowrap",textAlign:"center",justifyContent:"space-between"},contents:{flexShrink:1,overflowX:"hidden",overflowY:"auto"},playerItem:{padding:2},thingItem:{},customExits:{flexGrow:1,position:"relative",overflowY:"auto",overflowX:"hidden"},bottom:{position:"absolute",bottom:0,width:"100%"},navWidget:{position:"relative",bottom:0,left:"50%",flexShrink:0,"-webkit-transform":"translateX(-50%)",transform:"translateX(-50%)"}}},{withTheme:!0})(mn),fn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n.middle=i.a.createRef(),n.terminal=i.a.createRef(),n.dock=i.a.createRef(),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=window.client.settings.sidebarAlwaysShow;window.client.react.portal=this,window.scrollTo(0,1),window.client.container=this.middle.current,window.client.container=e?this.terminal.current:this.middle.current}},{key:"componentWillUnmount",value:function(){window.client.react.portal=null}},{key:"render",value:function(){var e=this.props.classes,t=window.client.settings,n=t.sidebarOpen,a=t.sidebarAnchor,l=t.ansiFG,s=t.ansiBG,o=t.wrapWidth,r=t.sidebarAlwaysShow,c=t.sidebarShowExits,u=t.sidebarShowPlayers,d=t.sidebarShowThings,m=t.sidebarShowCompass,p=t.sidebarWidth,f=n&&"left"===a,w=n&&"right"===a;window.client.container=r?this.terminal.current:this.middle.current;var g=i.a.createElement(pn,{sidebarShowCompass:m,sidebarWidth:p,sidebarShowExits:c,sidebarShowPlayers:u,sidebarShowThings:d});return i.a.createElement(h.MuiThemeProvider,{theme:b},i.a.createElement("div",{className:e.frame},i.a.createElement("div",{className:e.top},i.a.createElement(pt,{title:"MUSH Portal"})),i.a.createElement("div",{className:e.middle,ref:this.middle},f&&g,i.a.createElement(wt,{width:o,ansiFG:l,ansiBG:s,containerRef:this.terminal}),w&&g),i.a.createElement("div",{className:e.bottom},i.a.createElement(gt,null),i.a.createElement(vt,null)),i.a.createElement(Wt,null)))}}]),t}(i.a.Component),wn=Object(h.withStyles)(function(e){return{frame:{width:"100%",height:"100%",background:"white",position:"absolute",top:0,left:0,display:"flex","flex-flow":"column nowrap"},top:{top:0,left:0,width:"100%"},middle:{position:"relative",display:"flex","flex-flow":"row nowrap",flex:1,left:0,width:"100%"},flex:{flex:1},bottom:{bottom:0,left:0,width:"100%"},dock:{position:"relative",height:"100%",backgroundColor:e.palette.background.paper}}},{withTheme:!0})(fn),bn=n(187),gn=n.n(bn),En=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement("div",{className:e.frame},"Character Builder?")}}]),t}(i.a.Component),vn=Object(h.withStyles)(function(e){return{frame:{}}},{withTheme:!0})(En),yn=n(193),kn=n.n(yn),Sn=n(192),xn=n.n(Sn),Cn=n(194),Nn=n.n(Cn),On=n(190),jn=n.n(On),Tn=n(189),An=n.n(Tn),Pn=n(188),Mn=n.n(Pn),In=n(191),Ln=n.n(In),Rn=n(78),Bn=n.n(Rn),_n=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.classes,a=t.mail,l=t.onOpen,s=t.quickDelete,o=t.handleMark,r=t.selected,c=t.id;e=a.deleted?i.a.createElement(Mn.a,{className:a.unread?null:n.read}):a.unread?a.urgent?i.a.createElement(An.a,null):i.a.createElement(Z.a,null):i.a.createElement(jn.a,{className:n.read});var u=c%2===0;return i.a.createElement("div",{className:n.frame},i.a.createElement(K.a,{key:a.id,button:!0,dense:!0,divider:!0,selected:r,onClick:s?function(){}:l,className:u?n.even:n.odd},i.a.createElement(Oe.a,{className:n.listicon},e),i.a.createElement(q.a,{primary:a.subject,secondary:i.a.createElement("span",null,i.a.createElement("span",null,a.from),i.a.createElement("br",null),i.a.createElement("span",null,a.time))}),s&&i.a.createElement(Te.a,null,i.a.createElement(Lt.a,{onClick:o},a.deleted?i.a.createElement(Ln.a,null):i.a.createElement(Bn.a,null)))))}}]),t}(i.a.Component),Un=Object(h.withStyles)(function(e){return{frame:{},listicon:{margin:0},read:{opacity:.5},odd:{backgroundColor:"rgba(0, 0, 0, 0.2)"},even:{backgroundColor:"rgba(0, 0, 0, 0.05)"}}},{withTheme:!0})(_n),Dn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).purgeMail=function(){window.client.react.mailbox.purgeMail(),n.setState({quickDelete:!1})},n.sendMail=function(){window.client.react.mailbox.sendMail(null,"","")},n.toggleDelete=function(){n.setState({quickDelete:!n.state.quickDelete})},n.state={quickDelete:!1,selected:-1},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.openMail,l=t.maillist,s=t.unread,o=t.handleMark,r=this.state,c=r.quickDelete,u=r.selected;return i.a.createElement("div",{className:n.frame},i.a.createElement("div",{className:n.header},i.a.createElement(C.a,{variant:"subtitle1",className:n.title},i.a.createElement("span",{className:n.container},l.length," Messages (",s," unread)",i.a.createElement(T.a,{title:"Move multiple files to trash."},i.a.createElement(Lt.a,{onClick:this.toggleDelete},i.a.createElement(xn.a,null))),i.a.createElement(T.a,{title:"Purge deleted mail."},i.a.createElement(Lt.a,{onClick:this.purgeMail},i.a.createElement(kn.a,null))),i.a.createElement(T.a,{title:"Send a new message."},i.a.createElement(Lt.a,{onClick:this.sendMail,disabled:c},i.a.createElement(Nn.a,null)))))),i.a.createElement("div",{className:n.overflow},i.a.createElement(G.a,{dense:!0,disablePadding:!0},l.map(function(t,n){return i.a.createElement(Un,{selected:u===n,id:n,key:n,quickDelete:c,mail:t,onOpen:function(){e.setState({selected:n}),a(n)},handleMark:function(){return o(n)}})}))))}}]),t}(i.a.Component),Hn=Object(h.withStyles)(function(e){return{frame:{maxHeight:"100%",display:"flex","flex-flow":"column nowrap"},header:{},title:{},overflow:{overflowY:"auto",flex:1},container:{display:"inline-flex",paddingLeft:e.spacing.unit,"align-items":"center"},flex:{flex:1}}},{withTheme:!0})(Dn),Fn=n(51),Wn=n.n(Fn),Gn=n(52),zn=n.n(Gn),Kn=n(53),Xn=n.n(Kn),qn=n(54),Vn=n.n(qn),Jn=n(197),Yn=n.n(Jn),Zn=n(195),$n=n.n(Zn),Qn=n(196),ea=n.n(Qn),ta=function(){function e(t){Object(o.a)(this,e),this.root=t,this.container=null,this.dims={},this.calcDimensions(),this.onCommand=null,this.clear()}return Object(r.a)(e,null,[{key:"PARSE_PLAIN",get:function(){return 0}},{key:"PARSE_CR",get:function(){return 1}},{key:"PARSE_ESC1",get:function(){return 2}},{key:"PARSE_ESC2",get:function(){return 3}},{key:"ANSI_NORMAL",get:function(){return 0}},{key:"ANSI_BRIGHT",get:function(){return 1}},{key:"ANSI_UNDERLINE",get:function(){return 4}},{key:"ANSI_BLINK",get:function(){return 5}},{key:"ANSI_INVERSE",get:function(){return 7}},{key:"ANSI_XTERM_FG",get:function(){return 38}},{key:"ANSI_XTERM_BG",get:function(){return 48}},{key:"DEFAULT_FG",get:function(){return 37}},{key:"DEFAULT_BG",get:function(){return 30}},{key:"UNCLOSED_TAGS",get:function(){return["area","base","br","col","command","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]}}]),Object(r.a)(e,[{key:"getANSI",value:function(){return this.ansiState||(this.ansiState={fg:e.DEFAULT_FG,bg:e.DEFAULT_BG,fg256:!1,bg256:!1}),this.ansiState}},{key:"applyANSI",value:function(t){switch(t.charCodeAt(t.length-1)){case 109:for(var n,a,i=t.substring(0,t.length-1).split(";"),l=0;void 0!==(n=i[l]);++l){if(n=0===n.length?e.ANSI_NORMAL:parseInt(n,10),(a=this.getANSI())[e.ANSI_XTERM_FG]&&a[e.ANSI_BLINK])n>=0&&n<=255?(a.fg=n,a.fg256=!0,a[e.ANSI_XTERM_FG]=!1,a[e.ANSI_BLINK]=!1):this.ansiState=null;else if(a[e.ANSI_XTERM_BG]&&a[e.ANSI_BLINK])n>=0&&n<=255?(a.bg=n,a.bg256=!0,a[e.ANSI_XTERM_BG]=!1,a[e.ANSI_BLINK]=!1):this.ansiState=null;else switch(n){case e.ANSI_NORMAL:this.ansiState=null;break;case e.ANSI_BRIGHT:case e.ANSI_UNDERLINE:case e.ANSI_BLINK:case e.ANSI_INVERSE:case e.ANSI_XTERM_FG:case e.ANSI_XTERM_BG:a[n]=!0;break;default:30<=n&&n<=37?a.fg=n:40<=n&&n<=47&&(a.bg=n-10)}this.ansiDirty=!0}}}},{key:"write",value:function(t,n,a){if(n!==a){if(this.ansiDirty){var i=e.encodeState(this.ansiState);this.ansiClass!==i&&(this.ansiClass=i,this.span=null),this.ansiDirty=!1}this.ansiClass&&!this.span&&(this.span=document.createElement("span"),this.span.className=this.ansiClass,this.stack[this.stack.length-1].appendChild(this.span));var l=document.createTextNode(t.substring(n,a));this.lineBuf[this.lineBuf.length]=l,this.appendChild(l)}}},{key:"endLine",value:function(){this.onLine&&this.onLine(this,this.lineBuf),this.write("\n",0,1),this.lineBuf.length=0}},{key:"abortParse",value:function(t,n,a){switch(this.state){case e.PARSE_PLAIN:this.write(t,n,a);break;case e.PARSE_ESC1:this.write("\x1b",0,1);break;case e.PARSE_ESC2:this.write("\x1b[",0,2),this.write(this.parseBuf,0,this.parseBuf.length),this.parseBuf=""}}},{key:"appendText",value:function(t){for(var n=0,a=0,i=t.length;a<i;++a){var l=t.charCodeAt(a);switch(l){case 10:this.state!==e.PARSE_CR&&(this.abortParse(t,n,a),this.endLine()),n=a+1,this.state=e.PARSE_PLAIN;continue;case 13:this.abortParse(t,n,a),this.endLine(),n=a+1,this.state=e.PARSE_CR;continue;case 27:this.abortParse(t,n,a),n=a+1,this.state=e.PARSE_ESC1;continue}switch(this.state){case e.PARSE_CR:this.state=e.PARSE_PLAIN;break;case e.PARSE_ESC1:91===l?(n=a+1,this.state=e.PARSE_ESC2):(this.abortParse(t,n,a),n=a,this.state=e.PARSE_PLAIN);break;case e.PARSE_ESC2:64<=l&&l<=126&&(this.parseBuf+=t.substring(n,n=a+1),this.applyANSI(this.parseBuf),this.parseBuf="",this.state=e.PARSE_PLAIN)}}switch(this.state){case e.PARSE_PLAIN:this.write(t,n,t.length);break;case e.PARSE_ESC2:this.parseBuf+=t.substring(n)}}},{key:"appendHTML",value:function(e){var t=document.createElement("div"),n=document.createDocumentFragment();t.innerHTML=e;for(var a=t.firstChild;a;a=a.nextSibling){var i=a.getAttribute("xch_cmd");null!==i&&""!==i&&(a.setAttribute("onclick",'this.onCommand("'+i+'");'),a.onCommand=this.onCommand,a.removeAttribute("xch_cmd")),n.appendChild(a)}this.appendChild(n)}},{key:"appendChild",value:function(e){(this.span||this.stack[this.stack.length-1]).appendChild(e)}},{key:"appendMessage",value:function(e,t){var n=document.createElement("div");n.className=e;var a=document.createTextNode(t);n.appendChild(a),this.appendChild(n)}},{key:"pushElement",value:function(e){this.span=null,this.stack[this.stack.length-1].appendChild(e),this.stack[this.stack.length]=e}},{key:"popElement",value:function(){this.span=null,this.stack.length>1?--this.stack.length:window.console&&window.console.warn("element stack underflow")}},{key:"appendPueblo",value:function(t){var n,a,i=t.indexOf(" ");-1!==i?(n=t.substring(0,i),a=t.substring(i+1)):(n=t,a="");var l,s="<"+n+(a?" ":"")+a+">";"/"!==n[0]?l=!0:(l=!1,n=n.substring(1));var o=!1;if("/"!==n.substring(-1)&&"/"!==a.substring(-1)||(o=!0),e.UNCLOSED_TAGS.indexOf(n.toLowerCase())>-1&&(o=!0),"XCH_PAGE"!==n&&("IMG"!==n||-1===a.search(/xch_graph=(("[^"]*")|('[^']*')|([^\s]*))/i)))if(l){var r=document.createElement("div");s=(s=(s=s.replace(/xch_graph=(("[^"]*")|('[^']*')|([^\s]*))/i,"")).replace(/xch_mode=(("[^"]*")|('[^']*')|([^\s]*))/i,"")).replace(/xch_hint="([^"]*)"/i,'title="$1"'),r.innerHTML=s.replace(/xch_cmd="([^"]*)"/i,"onclick='this.onCommand(&quot;$1&quot;)'"),r.firstChild.onCommand=this.onCommand,r.setAttribute("target","_blank"),this.pushElement(r.firstChild),o&&this.popElement()}else o||this.popElement()}},{key:"clear",value:function(){if(null===this.root)return null;this.root.innerHTML="",this.stack=[this.root],this.state=e.PARSE_PLAIN,this.line=null,this.lineBuf=[],this.span=null,this.parseBuf="",this.ansiClass="",this.ansiState=null,this.ansiDirty=!1}},{key:"nearBottom",value:function(e){return!!this.root&&this.linesOfScroll()<=e}},{key:"calcDimensions",value:function(){var e=this.root;if(!e)return 0;var t=document.createElement(e.nodeName);return t.setAttribute("style","margin:0px;padding:0px;font-family:"+e.style.fontFamily+";font-size:"+e.style.fontSize),t.innerText="0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789",t=e.appendChild(t),this.dims.width=t.clientWidth/100,this.dims.height=t.clientHeight,t.parentNode.removeChild(t),this.dims}},{key:"linesOfScroll",value:function(){var e=this.container||this.root;return e?this.dims.height<=0?0:Math.round(Math.abs((e.scrollHeight-e.offsetHeight-e.scrollTop)/this.dims.height)):0}},{key:"scrollPageUp",value:function(){var e=this.container||this.root;e.scrollTop-=e.clientHeight-5*this.dims.height}},{key:"scrollPageDown",value:function(){var e=this.container||this.root;e.scrollTop+=e.clientHeight-4*this.dims.height}},{key:"scrollDown",value:function(){var e=this.container||this.root;e&&(e.scrollTop=e.scrollHeight)}}],[{key:"encodeState",value:function(t){if(!t)return"";var n=[];if(t[e.ANSI_INVERSE]){var a=t.fg;t.fg=t.bg,t.bg=a,a=t.fg256,t.fg256=t.bg256,t.bg256=a}var i=t.fg,l=t.bg;return t[e.ANSI_UNDERLINE]&&(n[n.length]="ansi-"+e.ANSI_UNDERLINE),t.fg256?n[n.length]="ansi-38-5-"+t.fg:t[e.ANSI_BRIGHT]?t[e.ANSI_INVERSE]?i!==e.DEFAULT_FG&&(n[n.length]="ansi-"+i):n[n.length]="ansi-"+i+"-1":i!==e.DEFAULT_FG&&(n[n.length]="ansi-"+i),t.bg256?n[n.length]="ansi-48-5-"+t.bg:t[e.ANSI_BRIGHT]&&t[e.ANSI_INVERSE]?n[n.length]="ansi-"+(l+10)+"-1":l!==e.DEFAULT_BG&&(n[n.length]="ansi-"+(l+10)),!t[e.ANSI_BLINK]||t.fg256||t.bg256||(n[n.length]="ansi-"+e.ANSI_BLINK),n.join(" ")}}]),e}(),na=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).showMenu=function(e){n.setState({anchorEl:e.currentTarget})},n.closeMenu=function(){n.setState({anchorEl:null})},n.markUnread=function(){window.client.react.mailbox.markUnread(),n.closeMenu()},n.markDeleted=function(){window.client.react.mailbox.markDeleted(),n.closeMenu()},n.markUndeleted=function(){window.client.react.mailbox.markUndeleted(),n.closeMenu()},n.replyMail=function(){var e=n.props.mail;window.client.react.mailbox.sendMail(e.from,"Re: "+e.subject,"")},n.forwardMail=function(){var e=n.props.mail;window.client.react.mailbox.sendMail("","Fwd: "+e.subject,e.body)},n.state={anchorEl:null},n.body=i.a.createRef(),n.emulator=null,n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.mail;this.emulator=new ta(this.body.current),this.emulator.appendText(e.body)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.mail,a=this.state.anchorEl,l=window.client.settings,s=l.ansiFG,o=l.ansiBG;return this.emulator&&this.emulator.clear(),this.emulator&&this.emulator.appendText(n.body),i.a.createElement(Wn.a,{className:t.card},i.a.createElement(zn.a,{className:t.header,title:n.subject,subheader:i.a.createElement("span",{className:t.sub},i.a.createElement("span",{className:t.left},n.from),i.a.createElement("span",{className:t.right},n.time))}),i.a.createElement(Xn.a,{className:t.body},i.a.createElement("div",{ref:this.body,className:Re()(t.wrap,s,o)})),i.a.createElement(Vn.a,{className:t.actions},i.a.createElement(O.a,{className:t.button,onClick:this.replyMail},i.a.createElement(Ce.a,null,i.a.createElement($n.a,null)),"Reply"),i.a.createElement(O.a,{className:t.button,onClick:this.forwardMail},i.a.createElement(Ce.a,null,i.a.createElement(ea.a,null)),"Forward"),i.a.createElement(Lt.a,{"aria-owns":a?"mailitem.menu":null,"aria-haspopup":"true",onClick:this.showMenu},i.a.createElement(Yn.a,null)),i.a.createElement(I.a,{id:"mailitem.menu",anchorEl:a,open:Boolean(a),onClose:this.closeMenu},i.a.createElement(R.a,{onClick:this.markUnread},"Mark as Unread"),n.deleted?i.a.createElement(R.a,{onClick:this.markUndeleted},"Restore Message"):i.a.createElement(R.a,{onClick:this.markDeleted},"Move to Trash"))))}}]),t}(i.a.Component),aa=Object(h.withStyles)(function(e){return{card:{height:"100%",display:"flex","flex-flow":"column nowrap"},header:{display:"flex","flex-flow":"row nowrap"},sub:{display:"flex"},left:{flex:1},right:{marginLeft:"3em"},body:{flex:1,display:"flex"},actions:{"justify-content":"space-evenly"},button:{display:"block"},wrap:{"font-family":"'Courier New', monospace","font-weight":"normal","font-size":"10pt",width:"100%",flex:1,"overflow-y":"auto","overflow-x":"hidden","white-space":"pre-wrap","word-wrap":"break-word",padding:"0.25em 0.5em"}}},{withTheme:!0})(na),ia=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).openMail=function(e){var t=n.state,a=t.maillist,i=t.unreadMail,l=a[e];l.unread&&(l.unread=!1,n.setState({maillist:a,unreadMail:i-1}),window.client.sendText("@mail/status "+l.id+"=read")),window.client.sendAPI("mailitem",l.id)},n.handleMark=function(e){var t=n.state.maillist,a=t[e];a.deleted=!a.deleted,a.deleted?window.client.sendText("@mail/clear "+a.id):window.client.sendText("@mail/unclear "+a.id),n.setState({maillist:t})},n.state={mailitem:null,unreadMail:e.unread?e.unread:0,folder:e.folder?e.folder:0,folderlist:[{id:0,name:"Inbox"}],maillist:e.maillist?e.maillist:[]},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"setUnreadMail",value:function(e){this.setState({unreadMail:e}),window.client.react.taskbar.setUnreadMail(e)}},{key:"markDeleted",value:function(){var e=this.state,t=e.maillist,n=e.mailitem;n.deleted||(n.deleted=!0,t[n.key].deleted=!0,window.client.sendText("@mail/clear "+n.id),this.setState({maillist:t,mailitem:n}))}},{key:"markUndeleted",value:function(){var e=this.state,t=e.maillist,n=e.mailitem;n.deleted&&(n.deleted=!1,t[n.key].deleted=!1,window.client.sendText("@mail/unclear "+n.id),this.setState({maillist:t,mailitem:n}))}},{key:"markUnread",value:function(){var e=this.state,t=e.maillist,n=e.mailitem,a=e.unreadMail;n.unread||(n.unread=!0,t[n.key].unread=!0,window.client.sendText("@mail/status "+n.id+"=unread"),this.setState({maillist:t,mailitem:n,unreadMail:a+1}))}},{key:"purgeMail",value:function(){if(window.confirm("Do you want to purge deleted mail?")){var e=this.state,t=e.maillist,n=e.mailitem;n&&t[n.key].deleted&&this.setState({mailitem:null}),window.client.sendText("@mail/purge"),window.client.sendAPI("maillist")}}},{key:"sendMail",value:function(e,t,n){window.client.react.sendmail?(window.client.focusPanel("Sendmail"),window.confirm("Replace current draft with new mail?")&&window.client.react.sendmail.setFields(e,t,n)):(window.client.addReactPanel("Sendmail",{panelSize:"30em 30em"}),window.client.react.sendmail.setFields(e,t,n))}},{key:"componentDidMount",value:function(){window.client.react.mailbox=this}},{key:"componentWillUnmount",value:function(){window.client.react.mailbox=null}},{key:"updateMailList",value:function(e,t,n){this.setState({folder:e,maillist:t,unreadMail:n})}},{key:"updateFolderList",value:function(e){this.setState({folderlist:e})}},{key:"openMailItem",value:function(e){this.state.maillist.forEach(function(t,n){t.id===e.id&&(e.key=n)}),this.setState({mailitem:e})}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.maillist,a=t.mailitem,l=t.unreadMail;return i.a.createElement("div",{className:e.frame},i.a.createElement("div",{className:e.left},n&&i.a.createElement(Hn,{maillist:n,unread:l,openMail:this.openMail,handleMark:this.handleMark})),i.a.createElement("div",{className:e.right},a&&i.a.createElement(aa,{mail:a})))}}]),t}(i.a.Component),la=Object(h.withStyles)(function(e){return{frame:{position:"absolute",height:"100%",width:"100%",display:"flex","flex-flow":"row nowrap"},left:{position:"relative",maxHeight:"100%"},right:{flex:1,maxHeight:"100%",position:"relative"}}},{withTheme:!0})(ia),sa=n(199),oa=n.n(sa),ra=n(198),ca=n.n(ra),ua=n(79),da=n.n(ua),ha=(n(137),n(138),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).sendMail=function(){var e=n.state,t=e.chips,a=e.subject,i=e.body,l=a;if(t.length<1)alert("Invalid recipients.");else if(i&&""!==i){a&&""!==a||(l=i.length>20?i.substr(0,20)+"...":i);var s='"'+t.join('" "')+'"';window.client.sendCommand("@mail "+s+"="+l+"/"+i.split("\n").join("%r")),n.closePanel()}else alert("Empty message.")},n.closePanel=function(){window.client.closePanel("Sendmail")},n.handleChange=function(e){return function(t){n.setState(Object(Se.a)({},e,t.target.value))}},n.changeText=function(e){n.setState({body:e})},n.onResize=function(){n.editor.current.editor.resize()},n.setError=function(e){n.setState({error:e})},n.onInput=function(){n.setError(null)},n.addChip=function(e){var t=n.state.chips,a=e.replace(/(?!\\)\\/g,"").replace(/(?!\\)"/g,"");window.client.execString('if(setr(0,namelist("'+a+'")),name(%q0))',function(e){""!==e?(-1===t.indexOf(e)&&(t.push(e),n.setState({chips:t})),n.setError(null)):n.setError("Unknown player.")})},n.delChip=function(e,t){var a=n.state.chips;a.splice(t,1),n.setState({chips:a}),n.setError(null)},n.beforeAdd=function(e){return!(e.startsWith('"')&&!e.endsWith('"')||e.startsWith("'")&&!e.endsWith("'")||e.endsWith("\\"))},n.state={subject:e.subject?e.subject:"",body:e.body?e.body:"",error:null,chips:[]},n.editor=i.a.createRef(),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"setTarget",value:function(e){this.addChip(e)}},{key:"setSubject",value:function(e){this.setState({subject:e})}},{key:"setBody",value:function(e){this.setState({body:e})}},{key:"setFields",value:function(e,t,n){e&&this.addChip(e),this.setState({subject:t,body:n})}},{key:"componentDidMount",value:function(){window.client.react.sendmail=this;var e=this.props,t=e.panel,n=e.to;t.options.resizeit.resize=this.onResize,window.client.panels.resizeit(t,t.options.resizeit),n&&this.addChip(n)}},{key:"componentWillUnmount",value:function(){window.client.react.sendmail=null}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.chips,a=t.subject,l=t.body,s=t.error;return i.a.createElement(Wn.a,{className:e.card},i.a.createElement(zn.a,{className:e.header,title:i.a.createElement(ca.a,{label:"Recipients",fullWidth:!0,value:n,blurBehavior:"add",onUpdateInput:this.onInput,newChipKeyCodes:[13,32,187],onBeforeAdd:this.beforeAdd,onAdd:this.addChip,classes:{input:e.nameInput},onDelete:this.delChip,helperText:s,FormHelperTextProps:{error:!0,className:e.helperText}}),subheader:i.a.createElement(_.a,{label:"Subject",value:a,onChange:this.handleChange("subject"),className:e.stretch})}),i.a.createElement(Xn.a,{className:e.body},i.a.createElement(da.a,{className:e.bodytext,ref:this.editor,mode:"mushcode",width:"100%",theme:"tomorrow_night_bright",value:l,onChange:this.changeText,wrapEnabled:!0,highlightActiveLine:!1,editorProps:{$blockScrolling:1/0}})),i.a.createElement(Vn.a,{className:e.actions},i.a.createElement(T.a,{title:"Send draft."},i.a.createElement(O.a,{fullWidth:!0,className:e.button,onClick:this.sendMail},i.a.createElement(Ce.a,null,i.a.createElement(oa.a,null)))),i.a.createElement(T.a,{title:"Discard draft."},i.a.createElement(O.a,{fullWidth:!0,className:e.button,onClick:this.closePanel},i.a.createElement(Ce.a,null,i.a.createElement(Bn.a,null))))))}}]),t}(i.a.Component)),ma=Object(h.withStyles)(function(e){return{card:{position:"absolute",width:"100%",height:"100%",display:"flex","flex-flow":"column nowrap"},header:{display:"flex","flex-flow":"row nowrap"},sub:{display:"flex"},left:{flex:1},right:{marginLeft:"3em"},stretch:{width:"100%"},body:{position:"relative",flex:1,display:"flex",overflow:"hidden","flex-flow":"column nowrap"},bodytext:{flex:1},actions:{"justify-content":"space-evenly"},button:{display:"block"},helperText:{textAlign:"right",width:"100%"},nameInput:{minWidth:"10em"}}},{withTheme:!0})(ha),pa=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.board,a=e.onOpen;return i.a.createElement("div",{className:t.frame},i.a.createElement(K.a,{key:n.id,button:!0,dense:!0,divider:!0,onClick:a},i.a.createElement(q.a,{primary:n.name,secondary:i.a.createElement("span",null,i.a.createElement("span",null,n.posts," Posts"),i.a.createElement("br",null),i.a.createElement("span",null,n.lastmod))})))}}]),t}(i.a.Component),fa=Object(h.withStyles)(function(e){return{frame:{},listicon:{margin:0},read:{opacity:.5}}},{withTheme:!0})(pa),wa=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.openBoard,a=e.boardlist;return i.a.createElement("div",{className:t.frame},i.a.createElement("div",{className:t.header},i.a.createElement(C.a,{variant:"subtitle1",className:t.title},i.a.createElement("span",{className:t.container},a.length," Bulletin Boards",i.a.createElement("span",{className:t.flex})))),i.a.createElement("div",{className:t.overflow},i.a.createElement(G.a,{dense:!0,disablePadding:!0},a.map(function(e,t){return i.a.createElement(fa,{key:t,board:e,onOpen:function(){return n(t)}})}))))}}]),t}(i.a.Component),ba=Object(h.withStyles)(function(e){return{frame:{maxHeight:"100%",display:"flex","flex-flow":"column nowrap"},header:{},title:{},overflow:{overflowY:"auto",flex:1},container:{display:"flex",paddingLeft:"2em"},flex:{flex:1}}},{withTheme:!0})(wa),ga=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.message,a=e.onOpen;return i.a.createElement("div",{className:t.frame},i.a.createElement(K.a,{key:n.id,button:!0,dense:!0,divider:!0,onClick:a},i.a.createElement(q.a,{primary:n.subject,secondary:i.a.createElement("span",null,i.a.createElement("span",null,n.author),i.a.createElement("br",null),i.a.createElement("span",null,n.date))})))}}]),t}(i.a.Component),Ea=Object(h.withStyles)(function(e){return{frame:{},listicon:{margin:0},read:{opacity:.5}}},{withTheme:!0})(ga),va=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.openMessage,a=e.board;return i.a.createElement("div",{className:t.frame},i.a.createElement("div",{className:t.header},i.a.createElement(C.a,{variant:"subtitle1",className:t.title},i.a.createElement("span",{className:t.container},a.messages.length," Posts",i.a.createElement("span",{className:t.flex})))),i.a.createElement("div",{className:t.overflow},i.a.createElement(G.a,{dense:!0,disablePadding:!0},a.messages.map(function(e,t){return i.a.createElement(Ea,{key:t,message:e,onOpen:function(){return n(t)}})}))))}}]),t}(i.a.Component),ya=Object(h.withStyles)(function(e){return{frame:{maxHeight:"100%",display:"flex","flex-flow":"column nowrap"},header:{},title:{},overflow:{overflowY:"auto",flex:1},container:{display:"flex",paddingLeft:"2em"},flex:{flex:1}}},{withTheme:!0})(va),ka=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n.body=i.a.createRef(),n.emulator=null,n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.message;this.emulator=new ta(this.body.current),this.emulator.appendText(e.body)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.message,a=window.client.settings,l=a.ansiFG,s=a.ansiBG;return this.emulator&&this.emulator.clear(),this.emulator&&this.emulator.appendText(n.body),i.a.createElement(Wn.a,{className:t.card},i.a.createElement(zn.a,{className:t.header,title:n.subject,subheader:i.a.createElement("span",{className:t.sub},i.a.createElement("span",{className:t.left},n.author),i.a.createElement("span",{className:t.right},n.date))}),i.a.createElement(Xn.a,{className:t.body},i.a.createElement("div",{ref:this.body,className:Re()(t.output,l,s)})),i.a.createElement(Vn.a,{className:t.actions}))}}]),t}(i.a.Component),Sa=Object(h.withStyles)(function(e){return{card:{height:"100%",display:"flex","flex-flow":"column nowrap"},header:{display:"flex","flex-flow":"row nowrap"},sub:{display:"flex"},left:{flex:1},right:{marginLeft:"3em"},body:{flex:1,"overflow-y":"auto","overflow-x":"hidden"},actions:{"justify-content":"space-evenly"},button:{display:"block"},output:{"font-family":"'Courier New', monospace","font-weight":"normal","font-size":"10pt",width:"100%",height:"100%","overflow-y":"scroll","overflow-x":"hidden","white-space":"pre-wrap","word-wrap":"break-word"}}},{withTheme:!0})(ka),xa=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).openBB=function(e){var t=n.state.boardlist[e];window.client.sendAPI("bbmsglist",t.id)},n.openBBMsg=function(e){var t=n.state.board,a=t.messages[e];window.client.sendAPI("bbmsg",t.id+"="+a.id)},n.state={bbmsg:null,board:null,boardlist:e.boardlist?e.boardlist:[]},n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.client.react.bboard=this}},{key:"componentWillUnmount",value:function(){window.client.react.bboard=null}},{key:"updateBoardList",value:function(e){this.setState({boardlist:e,board:null,bbmsg:null})}},{key:"updateBoard",value:function(e){this.setState({board:e,bbmsg:null})}},{key:"openMessage",value:function(e){this.state.board.messages.forEach(function(t,n){e.id===t.id&&(e.key=n)}),this.setState({bbmsg:e})}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.boardlist,a=t.board,l=t.bbmsg;return i.a.createElement("div",{className:e.frame},a?i.a.createElement("div",{className:e.full},i.a.createElement("div",{className:e.left},i.a.createElement(ya,{board:a,openMessage:this.openBBMsg})),i.a.createElement("div",{className:e.right},l&&i.a.createElement(Sa,{message:l}))):i.a.createElement("div",{className:e.full},i.a.createElement("div",{className:e.left},i.a.createElement(ba,{boardlist:n,openBoard:this.openBB})),i.a.createElement("div",{className:e.right})))}}]),t}(i.a.Component),Ca=Object(h.withStyles)(function(e){return{frame:{position:"absolute",height:"100%",width:"100%",display:"flex","flex-flow":"row nowrap"},left:{position:"relative",maxHeight:"100%",flex:1},right:{flex:1,maxHeight:"100%",position:"relative"},full:{flex:1,position:"relative",display:"flex"}}},{withTheme:!0})(xa),Na=n(201),Oa=n.n(Na),ja=n(200),Ta=n.n(ja),Aa=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).startUpload=function(){n.setState({uploading:!0}),n.uploadLine()},n.pauseUpload=function(){n.setState({uploading:!1})},n.resetText=function(){n.setState({text:n.text})},n.changeDelay=function(e){if(!n.state.uploading){var t=e.target.value;n.setState({delay:t})}},n.changeText=function(e){n.state.uploading||n.setText(e)},n.onResize=function(){n.editor.current.editor.resize()},n.state={uploading:!1,text:"",delay:1e3},n.text="",n.editor=i.a.createRef(),n}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.client.react.upload=this;var e=this.props.panel;e.options.resizeit.resize=this.onResize,window.client.panels.resizeit(e,e.options.resizeit)}},{key:"componentWillUnmount",value:function(){window.client.react.upload=null}},{key:"setText",value:function(e){this.text=e,this.setState({text:e})}},{key:"uploadLine",value:function(){var e=this,t=this.state.text,n=this.state.delay;n<100?n=100:n>1e5&&(n=1e5),setTimeout(function(){if(e.state.uploading){var n=t.split("\n");if(n.length>0){var a=n[0];a.length>0&&window.client.sendCommand(a),n.splice(0,1);var i=n.join("\n");e.setState({text:i}),n.length>0?e.uploadLine():(e.setState({uploading:!1}),window.client.closePanel("Upload"))}else e.setState({uploading:!1}),window.client.closePanel("Upload")}},n)}},{key:"render",value:function(){var e=this.props.classes,t=this.state,n=t.text,a=t.uploading,l=t.delay;return i.a.createElement("div",{className:e.frame},i.a.createElement(da.a,{className:e.editor,ref:this.editor,mode:"mushcode",width:"100%",theme:"tomorrow_night_bright",value:n,onChange:this.changeText,readOnly:a,wrapEnabled:!0,highlightActiveLine:!1,editorProps:{$blockScrolling:1/0}}),i.a.createElement("div",{className:e.flex},i.a.createElement("div",{className:e.stretchflex},i.a.createElement("div",{className:e.pad}),i.a.createElement(_.a,{className:e.padded,label:"Command delay (in ms)",value:l,type:"number",variant:"outlined",onChange:this.changeDelay,fullWidth:!0})),a?i.a.createElement("div",{className:e.stretchflex},i.a.createElement(T.a,{title:"Pause uploading."},i.a.createElement(O.a,{className:e.stretch,onClick:this.pauseUpload},i.a.createElement(Oa.a,null)))):i.a.createElement("div",{className:e.stretchflex},i.a.createElement(T.a,{title:"Start uploading."},i.a.createElement(O.a,{className:e.stretch,onClick:this.startUpload},i.a.createElement(fe.a,null))),i.a.createElement(T.a,{title:"Reset partially uploaded text."},i.a.createElement(O.a,{className:e.stretch,onClick:this.resetText},i.a.createElement(Ta.a,null))))))}}]),t}(i.a.Component),Pa=Object(h.withStyles)(function(e){return{frame:{position:"absolute",display:"flex",height:"100%",width:"100%","flex-flow":"column nowrap"},editor:{flex:1},flex:{display:"flex"},stretch:{flex:1},stretchflex:{display:"flex",flex:1},pad:{margin:"1em"},padded:{margin:e.spacing.unit}}},{withTheme:!0})(Aa),Ma=function(){function e(t){Object(o.a)(this,e);this.url=t,this.socket=null,this.isOpen=!1,this.onOpen=null,this.onError=null,this.onClose=null,this.onUpdate=null,this.onText=null,this.onObject=null,this.onHTML=null,this.onPueblo=null,this.onPrompt=null,this.hasData=!1,this.reconnect(this)}return Object(r.a)(e,null,[{key:"CHANNEL_TEXT",get:function(){return"t"}},{key:"CHANNEL_JSON",get:function(){return"j"}},{key:"CHANNEL_HTML",get:function(){return"h"}},{key:"CHANNEL_PUEBLO",get:function(){return"p"}},{key:"CHANNEL_PROMPT",get:function(){return">"}}]),Object(r.a)(e,[{key:"reconnect",value:function(){var t=this;this.isConnected()&&this.sendText("QUIT"),this.socket=new window.WebSocket(this.url),this.isOpen=!1,this.socket.onopen=function(n){e.onopen(t,n)},this.socket.onerror=function(n){e.onerror(t,n)},this.socket.onclose=function(n){e.onclose(t,n)},this.socket.onmessage=function(n){e.onmessage(t,n)}}},{key:"isConnected",value:function(){return this.socket&&this.isOpen&&1===this.socket.readyState}},{key:"close",value:function(){this.socket&&this.socket.close()}},{key:"sendText",value:function(t){this.isConnected()&&this.socket.send(e.CHANNEL_TEXT+t+"\r\n")}},{key:"sendObject",value:function(t){this.isConnected()&&this.socket.send(e.CHANNEL_JSON+window.JSON.stringify(t))}},{key:"onMessage",value:function(t,n){switch(this.onUpdate&&this.onUpdate(t,n),this.hasData=!0,t){case e.CHANNEL_TEXT:this.onText&&this.onText(n);break;case e.CHANNEL_JSON:try{this.onObject&&this.onObject(window.JSON.parse(n))}catch(a){console.log("JSON ERROR ",a,n)}break;case e.CHANNEL_HTML:this.onHTML&&this.onHTML(n);break;case e.CHANNEL_PUEBLO:this.onPueblo&&this.onPueblo(n);break;case e.CHANNEL_PROMPT:this.onPrompt&&this.onPrompt(n);break;default:return window.console&&window.console.log("unhandled message",t,n),!1}return!0}}],[{key:"reconnect",value:function(e){e.reconnect()}},{key:"onopen",value:function(e,t){e.isOpen=!0,e.onOpen&&e.onOpen(t)}},{key:"onerror",value:function(e,t){e.isOpen=!1,e.onError&&e.onError(t)}},{key:"onclose",value:function(e,t){e.isOpen=!1,e.onClose&&e.onClose(t)}},{key:"onmessage",value:function(e,t){e.onMessage&&e.onMessage(t.data[0],t.data.substring(1))}}]),e}(),Ia=function(){function e(t){Object(o.a)(this,e);var n=this;this.root=t,this.selectionStart=0,this.selectionStop=0,this.onEnter=null,this.onEscape=null,this.onPageUp=null,this.onPageDown=null,this.keyCycleForward=null,this.keyCycleBackward=null,this.clearHistory(),this.root.onkeydown=function(t){e.onkeydown(n,t)},this.root.onkeyup=function(t){e.onkeyup(n,t)}}return Object(r.a)(e,null,[{key:"clearhistory",value:function(e){e.clearHistory&&e.clearHistory()}},{key:"onkeydown",value:function(e,t){e.onKeyDown&&e.onKeyDown(t)}},{key:"onkeyup",value:function(e,t){e.onKeyUp&&e.onKeyUp(t)}},{key:"isKeyCycleForward",value:function(e,t){return e&&e.keyCycleForward?e.keyCycleForward(t):78===t.code&&t.ctrl}},{key:"isKeyCycleBackward",value:function(e,t){return e&&e.keyCycleBackward?e.keyCycleBackward(t):80===t.code&&t.ctrl}},{key:"pressKey",value:function(t,n){var a={code:n.keyCode?n.keyCode:n.which,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey},i=!0;if(e.isKeyCycleBackward(t,a))t.cycleBackward();else if(e.isKeyCycleForward(t,a))t.cycleForward();else if(13===a.code){var l=t.root.value;t.saveCommand(),t.onEnter&&t.onEnter(l)}else 27===a.code?t.onEscape&&t.onEscape():33===a.code?t.onPageUp&&t.onPageUp():34===a.code?t.onPageUp&&t.onPageDown():i=!1;i&&n.preventDefault(),t.focus()}},{key:"releaseKey",value:function(t,n){var a={code:n.keyCode?n.keyCode:n.which,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey};(e.isKeyCycleBackward(t,a)||e.isKeyCycleForward(t,a))&&t.moveCursor()}}]),Object(r.a)(e,[{key:"onKeyDown",value:function(t){e.pressKey(this,t)}},{key:"onKeyUp",value:function(t){e.releaseKey(this,t)}},{key:"clearHistory",value:function(){this.history=[],this.ncommand=0,this.save_current="",this.current=-1}},{key:"saveCommand",value:function(){""!==this.root.value&&(this.history[this.ncommand]=this.root.value,this.ncommand++,this.save_current="",this.current=-1,this.root.value="")}},{key:"cycleBackward",value:function(){this.current<0&&(this.save_current=this.root.value),this.current<this.ncommand-1&&(this.current++,this.root.value=this.history[this.ncommand-this.current-1])}},{key:"cycleForward",value:function(){this.current>0?(this.current--,this.root.value=this.history[this.ncommand-this.current-1]):0===this.current&&(this.current=-1,this.root.value=this.save_current)}},{key:"moveCursor",value:function(){if("number"===typeof this.root.selectionStart)this.root.selectionStart=this.root.selectionEnd=this.root.value.length;else if("undefined"!==typeof this.root.createTextRange){this.focus();var e=this.root.createTextRange();e.collapse(!1),e.select()}}},{key:"saveCursor",value:function(){this.selectionStart=this.root.selectionStart,this.selectionStop=this.root.selectionStop}},{key:"resetCursor",value:function(){this.selectionStart&&this.selectionStop?(this.root.selectionStart=this.selectionStart,this.root.selectionStop=this.selectionStop,this.selectionStart=null,this.selectionStop=null):this.root.selectionStart=this.root.selectionStop=this.root.value.length}},{key:"clear",value:function(){this.root.value=""}},{key:"value",value:function(){return this.root.value}},{key:"focus",value:function(e){var t="";if(!e){window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(t=document.selection.createRange().text);var n=document.activeElement,a=n.tagName.toLowerCase();if("textarea"===a)return;if("input"===a){var i=n.getAttribute("type").toLowerCase();if(["text","password","number","email","tel","url","search","date","datetime","datetime-local","time","month","week"].indexOf(i)>=0)return}}t.match(/^\w*$/)&&this.root.focus()}}]),e}(),La=function(){function e(){Object(o.a)(this,e)}return Object(r.a)(e,null,[{key:"extractLinks",value:function(e){var t,n=[],a=/(^|[^a-zA-Z0-9]+)(?:((?:http|https):\/\/[-a-zA-Z0-9_.~:\/?#[\]@!$&'()*+,;=%]+[-a-zA-Z0-9_~:\/?#@!$&*+;=%])|([-.+a-zA-Z0-9_]+@[-a-zA-Z0-9]+(?:\.[-a-zA-Z0-9]+)+)|(@[a-zA-Z]\w*))/g;for(a.lastIndex=0;t=a.exec(e);){var i={};i.start=t.index+t[1].length,i.xch_cmd="",t[2]?(t=t[2],i.url=t):t[3]?(t=t[3],i.url="mailto:"+t):t[4]&&(t=t[4],i.url="",i.xch_cmd="help "+t,i.className="ansi-1-37"),i.end=i.start+t.length,n[n.length]=i}return n}},{key:"parseLinks",value:function(t,n){if(n.length){var a,i,l="";for(a=0,i=n.length;a<i;++a)l+=n[a].nodeValue;var s=e.extractLinks(l);if(s.length){var o=0,r=0,c=n[0].nodeValue.length;for(a=0,i=s.length;a<i;++a){for(var u,d,h,m,p=s[a];c<=p.start;)r=c,c+=n[++o].nodeValue.length;for(u=p.start-r,d=n[o];c<p.end;)r=c,c+=n[++o].nodeValue.length;if(h=p.end-r,d===(m=n[o])){n[o]=m.splitText(h),r+=h;var f=d.splitText(u),w=document.createElement("a");f.parentNode.replaceChild(w,f),w.target="_blank",""===p.url&&""!==p.xch_cmd?(w.setAttribute("onClick",'this.onCommand("'+p.xch_cmd+'");'),w.onCommand=t.onCommand):w.href=p.url,w.appendChild(f)}else window.console&&window.console.warn("link",p)}}}}},{key:"parseCommand",value:function(e){var t=e,n=/\?\?/;if(-1!==t.search(n)){var a=prompt(e);t=null===a?"":t.replace(n,a)}return t}}]),e}(),Ra={maillist:function(e,t){e.sendText("th null(oob(%#,maillist,json(object,folder,json(number,if(%0,before(%0,:),0)),maillist,\\[[iter(maillist(%#,if(%0,before(%0,:):,0:)),json(object,id,json(string,%i0),deleted,switch(setr(0,mailstatus(%#,%i0)),*C*,true,false),unread,switch(%q0,N*,true,false),urgent,switch(%q0,*U*,true,false),time,json(string,mailtime(%#,%i0)),subject,json(string,mailsubject(%#,%i0)),from,json(string,if(setr(0,mailfrom(%#,%i0)),name(%q0),!PURGED!))),,\\,)]\\],unread,json(number,extract(mailfstats(%#),6,1)))))")},mailitem:function(e,t){e.sendText("th null(oob(%#,mailitem,json(object,id,json(string,"+t+"),deleted,switch(setr(0,mailstatus(%#,"+t+")),*C*,true,false),unread,switch(%q0,N*,true,false),urgent,switch(%q0,*U*,true,false),time,json(string,mailtime(%#,"+t+")),subject,json(string,mailsubject(%#,"+t+")),from,json(string,if(setr(0,mailfrom(%#,"+t+")),name(%q0),!PURGED!)),body,json(string,mail(%#,"+t+")))))")},boardlist:function(e,t){e.sendText("+bbread")},bbmsglist:function(e,t){e.sendText("+bbread "+t)},bbmsg:function(e,t){e.sendText("+bbread "+t)},listcontents:function(e,t){e.sendText("th null(oob(%#,listcontents,json(object,players,\\[[iter(remove(lvplayers(%l),%#),json(string,name(%i0)),,\\,)]\\],exits,\\[[iter(lexits(%l),json(string,fullname(%i0)),,\\,)]\\],things,\\[[iter(lvthings(%l),json(string,name(%i0)),,\\,)]\\])))")}},Ba=(n(384),n(386),n(388),n(202)),_a=n(95),Ua=n.n(_a),Da=n(398),Ha=n(399),Fa=[/There is no player with that name\./,/That is not the correct password\./,/Either that player does not exist, or has a different password\./,/You cannot connect to that player at this time\./,/Guest connections not allowed\./,/Connection to .* (Non-GUEST) not allowed from .* (.*)/,/Too many guests are connected now\./],Wa=function(){function e(){var t=this;Object(o.a)(this,e),this.setBubble=function(){t.hidden?t.tinycon.setBubble(t.updateCounter):t.tinycon.setBubble(0)},this.settings={ansiFG:"ansi-37",ansiBG:"ansi-40",wrapWidth:100,invertHighlight:!1,decompileEditor:!0,decompileKey:"FugueEdit > ",sidebarOpen:!0,sidebarAnchor:"left",sidebarWidth:"192px",sidebarAlwaysShow:!0,sidebarShowPlayers:!0,sidebarShowThings:!0,sidebarShowExits:!0,sidebarShowCompass:!0,debugEvents:!1},this.defaultSettings=Object.assign({},this.settings),this.loadSettings(),this.output=null,this.prompt=null,this.input=null,this.events=new Da,this.panels=Ba.a,this.theme=b,this.tinycon=Ha,this.react={portal:null,taskbar:null,terminal:null,input:null,statusbar:null,login:null,mailbox:null,sendmail:null,bboard:null,upload:null},this.conn=null,this.container=null,this.serverAddress="node.grapenut.org",this.serverPort=2001,this.serverSSL=!0,this.loggedIn=!1,this.jsonapi=!1,this.hidden=!1,this.updateCounter=0,this.updateLines=0,this.eatNewline=!1,this.delayContents=500,this.scrollThreshold=5,this.reconnectTimer=2e3,this.reconnectCount=0,this.reconnectMaxCount=10,window.client=this,this.initPanels(),this.initNotifications()}return Object(r.a)(e,[{key:"loadScript",value:function(e){var t=document.createElement("script");t.async=!1,t.src=e,document.getElementsByTagName("body")[0].appendChild(t)}},{key:"loadStyle",value:function(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"unloadStyle",value:function(e){for(var t=document.getElementsByTagName("link"),n=t.length;n>=0;n--)t[n]&&null!==t[n].getAttribute("href")&&-1!==t[n].getAttribute("href").indexOf(e)&&t[n].parentNode.removeChild(t[n])}},{key:"loadSettings",value:function(){var e=this,t=window.localStorage;Object.keys(this.settings).forEach(function(n){t["settings_"+n]&&e.changeSetting(n,t["settings_"+n])})}},{key:"saveSettings",value:function(){var e=this,t=window.localStorage;Object.keys(this.settings).forEach(function(n){t["settings_"+n]=String(e.settings[n])})}},{key:"changeSetting",value:function(e,t){if(this.settings.hasOwnProperty(e)){var n=typeof this.settings[e];if(typeof t===n)this.settings[e]=t;else switch(n){case"string":this.settings[e]=String.bind(null,t)();break;case"number":this.settings[e]=Number.bind(null,t)();break;case"boolean":this.settings[e]="true"===t;break;default:this.settings[e]=t}"invertHighlight"===e&&(this.settings[e]?this.loadStyle("./inverse.css"):this.unloadStyle("./inverse.css"))}}},{key:"onCommand",value:function(e){this.sendCommand&&this.sendCommand(La.parseCommand(e))}},{key:"appendMessage",value:function(e,t){var n=!1;this.output&&(this.output.nearBottom(this.scrollThreshold)&&(n=!0),this.output.appendMessage(e,t),n&&this.output.scrollDown(),this.react.terminal&&this.react.terminal.onChange())}},{key:"clear",value:function(){this.output&&this.output.clear(),this.prompt&&this.prompt.clear(),this.input&&this.input.clear()}},{key:"initInput",value:function(e){var t=this;null!==e&&(this.input=new Ia(e),this.input.onEnter=function(e){t.sendCommand(e),t.prompt&&t.prompt.clear()},this.input.onEscape=function(){t.input.clear()},this.input.onPageUp=function(){t.output&&t.output.scrollPageUp()},this.input.onPageDown=function(){t.output&&t.output.scrollPageDown()})}},{key:"initOutput",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==e&&(this.output=new ta(e),this.output.container=n,this.output.onCommand=function(e){t.onCommand(e)},e.onunload=function(){t.sendText("QUIT"),t.close()},e.onresize=function(){t.output&&t.output.scrollDown()})}},{key:"initPrompt",value:function(e){null!==e&&(this.prompt=new ta(e))}},{key:"scrollDown",value:function(e){e&&(e.scrollTop=this.root.scrollHeight)}},{key:"focus",value:function(e){this.input&&this.input.focus(e)}},{key:"scrollIfNeeded",value:function(e){var t=!1;this.output&&(this.output.nearBottom(this.scrollThreshold)&&(t=!0),e(),t&&this.output.scrollDown(),this.react.terminal&&this.react.terminal.onChange())}},{key:"addReactPanel",value:function(e,t){var n=null,a=null;switch(e){case"Chargen":n=vn;break;case"Mailbox":n=la,a=this.react.mailbox;break;case"Upload":n=Pa,a=this.react.upload;break;case"Sendmail":n=ma,a=this.react.sendmail;break;case"BBoard":n=Ca,a=this.react.bboard}if(n)if(a)this.focusPanel(e);else{var l=t||{};l.headerTitle||(l.headerTitle=e),l.callback=function(e){e.content.style.backgroundColor=b.palette.background.paper;var t=i.a.createElement(n,{panel:e},null);s.a.render(i.a.createElement(h.MuiThemeProvider,{theme:b},t),e.content)},l.container=this.container,this.panels.create(l)}}},{key:"closePanel",value:function(e){var t=this.panels.getPanels(function(){return this.id===e||this.headertitle.innerText===e});t.length>0&&("minimized"===t[0].status&&this.react.taskbar.popTask(t[0]),t[0].close())}},{key:"focusPanel",value:function(e){var t=this.panels.getPanels(function(){return this.id===e||this.headertitle.innerText===e});t.length>0&&("minimized"===t[0].status?this.react.taskbar.popTask(t[0]):(t[0].unsmallify(),t[0].front()))}},{key:"connect",value:function(){var e=this,t=(this.serverSSL?"wss://":"ws://")+this.serverAddress+":"+this.serverPort+"/wsclient";this.close(),this.conn=new Ma(t),this.conn.onOpen=function(t){e.appendMessage("logMessage","%% Connected."),e.reconnectCount=0},this.conn.onError=function(t){e.appendMessage("logMessage","%% Connection error!"),console.log(t)},this.conn.onClose=function(t){e.appendMessage("logMessage","%% Connection closed."),setTimeout(function(){e.reconnect()},(e.serverSSL?2:1)*e.reconnectTimer)},this.conn.onUpdate=function(t,n){e.conn.hasData||(e.react.login&&e.react.login.openLogin(),e.sendText("SCREENWIDTH "+e.settings.wrapWidth),e.sendText("SCREENHEIGHT "+Math.floor(e.output.root.parentNode.clientHeight/e.output.dims.height))),e.hidden&&n.endsWith("\n")&&(e.updateCounter++,clearTimeout(e.setBubble),setTimeout(e.setBubble,1e3))},this.conn.onText=function(t){if(!e.loggedIn){for(var n=0;n<Fa.length;n++)if(t.match(Fa[n])){e.react.login&&e.react.login.openLogin(t);break}t.match(/Last( FAILED)? connect was from/)&&(e.loggedIn=!0,setTimeout(function(){e.jsonapi||e.sendAPI("listcontents")},e.delayContents))}var a=new RegExp("^"+e.settings.decompileKey);if(t.match(a)){var i=t.replace(a,"");return e.eatNewline=!0,void(e.settings.decompileEditor?(e.addReactPanel("Upload"),e.react.upload.editor.current.editor.insert(i+"\n")):e.input.root.value=i)}!e.eatNewline||"\n"!==t&&"\r\n"!==t?(e.eatNewline=!1,e.scrollIfNeeded(function(){return e.output.appendText(t)})):e.eatNewline=!1},this.conn.onHTML=function(t){e.output&&e.scrollIfNeeded(function(){return e.output.appendHTML(t)})},this.conn.onPueblo=function(t,n){e.output&&e.scrollIfNeeded(function(){return e.output.appendPueblo(t,n)})},this.conn.onPrompt=function(t){null!==e.prompt&&(e.prompt.clear(),e.prompt.appendText(t+"\r\n"))},this.conn.onObject=function(t){var n="";t.hasOwnProperty("gmcp")?n=t.gmcp:t.hasOwnProperty("op")&&(n=t.op),n&&""!==n?(e.settings.debugEvents&&console.log("JSON "+n+":",t),e.events.emit(n,t)):e.settings.debugEvents&&console.log("JSON (unknown):",t)}}},{key:"reconnect",value:function(){this.isConnected()||(this.reconnectCount<this.reconnectMaxCount?(this.reconnectCount++,this.conn&&this.conn.reconnect()):this.appendMessage("logMessage","%% Auto-reconnect aborted."))}},{key:"isConnected",value:function(){return this.conn&&this.conn.isConnected()}},{key:"close",value:function(){this.conn&&this.conn.close()}},{key:"sendText",value:function(e){this.conn&&this.conn.sendText(e)}},{key:"sendCommand",value:function(e){var t=this;this.isConnected()?""!==e&&(this.sendText(e),this.scrollIfNeeded(function(){return t.appendMessage("localEcho",e)})):(this.conn&&this.conn.reconnect(),this.scrollIfNeeded(function(){return t.appendMessage("logMessage","%% Reconnecting to server...")}))}},{key:"sendAPI",value:function(e,t){if(this.jsonapi){var n=String(e);if(t){var a=String(t);a.length>0&&(n+=" "+a)}this.sendText("jsonapi/"+n)}else Ra.hasOwnProperty(e)&&Ra[e](this,t)}},{key:"execString",value:function(e,t){var n=this,a="exec_"+Ua.a.generate(),i="th null(oob(%#,"+a+",json(object,result,json(string,"+e+"))))";this.events.on(a,function(e){t(e.result),n.events.removeAllListeners([a])}),this.sendText(i)}},{key:"execJSON",value:function(e,t){var n=this,a="exec_"+Ua.a.generate(),i="th null(oob(%#,"+a+","+e+"))";this.events.on(a,function(e){t(e),n.events.removeAllListeners([a])}),this.sendText(i)}},{key:"saveLog",value:function(e){if(this.output){var t=this.output.root,n=t.innerText||t.textContent;if(n.length>0){var a=new Blob([n],{type:"text/html;charset=utf-8"});gn()(a,e)}else alert("File not saved! The current output is empty.")}}},{key:"initNotifications",value:function(){var e,t,n=this;"undefined"!==typeof document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==typeof document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),"undefined"===typeof document.addEventListener||void 0===e?console.log("This browser does not support background notifications."):document.addEventListener(t,function(){n.updateCounter=0,n.updateLines=0,document[e]?n.hidden=!0:n.hidden=!1,n.setBubble()},!1),this.tinycon.setOptions({fallback:!0,abbreviate:!0})}},{key:"initPanels",value:function(){this.panels.defaults.minimizeTo=!1,this.panels.defaults.onminimized=function(e){window.client.react.taskbar.pushTask(this),window.client.focus()},this.panels.defaults.onclosed=function(e){s.a.unmountComponentAtNode(e.content),window.client.focus()},this.panels.defaults.dragit.start=function(){window.client.input.saveCursor()},this.panels.defaults.resizeit.start=function(){window.client.input.saveCursor()},this.panels.defaults.dragit.stop=function(){window.client.focus(),window.client.input.resetCursor()},this.panels.defaults.resizeit.stop=function(){window.client.focus(),window.client.input.resetCursor()}}}]),e}(),Ga=(n(400),new Wa);s.a.render(i.a.createElement(wn,null,null),document.getElementById("root")),Ga.loadScript("./local.js")}},[[204,2,1]]]);
//# sourceMappingURL=main.b0eb8f54.chunk.js.map