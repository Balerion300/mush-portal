{"version":3,"sources":["modules/Theme/index.jsx","modules/Settings/index.jsx","modules/Taskbar/index.jsx","modules/Terminal/index.jsx","modules/Input/index.jsx","modules/Statusbar/index.jsx","modules/Login/index.jsx","modules/Sidebar/index.jsx","modules/Portal/index.jsx","modules/Chargen/index.jsx","modules/Mailbox/MailListItem.jsx","modules/Mailbox/MailList.jsx","client/emulator.js","modules/Mailbox/MailItem.jsx","modules/Mailbox/index.jsx","modules/Sendmail/index.jsx","modules/BBoard/BBListItem.jsx","modules/BBoard/BBList.jsx","modules/BBoard/BBMessageListItem.jsx","modules/BBoard/BBMessageList.jsx","modules/BBoard/BBMessage.jsx","modules/BBoard/index.jsx","modules/Upload/index.jsx","client/connection.js","client/userinput.js","client/utils.js","client/jsonapi.js","client/index.js","index.js"],"names":["Theme","createMuiTheme","typography","useNextVariants","palette","primary","indigo","secondary","blueGrey","type","Settings","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleSwitch","name","event","window","client","changeSetting","target","checked","setState","defineProperty","settings","saveSettings","react","portal","forceUpdate","handleValue","value","showColor","color","colorAnchor","currentTarget","closeColor","chooseColor","loadSettings","objectSpread","resetSettings","confirm","assign","defaultSettings","state","_this$props","classes","closeDrawer","_this$state","debugEvents","decompileEditor","decompileKey","ansiFG","ansiBG","wrapWidth","sidebarOpen","sidebarAnchor","sidebarAlwaysShow","sidebarShowPlayers","sidebarShowThings","sidebarShowExits","sidebarShowCompass","sidebarWidth","react_default","a","createElement","className","frame","left","content","tabIndex","role","Popover_default","id","anchorEl","open","onClose","List_default","disablePadding","dense","subheader","ListSubheader_default","ListItem_default","ListItemIcon_default","BugReport_default","ListItemText_default","switchText","ListItemSecondaryAction_default","Switch_default","onChange","WrapText_default","TextField_default","label","Palette_default","Edit_default","Code_default","helperText","VerticalSplit_default","disabled","PictureInPicture_default","Icon_default","BorderLeft_default","BorderRight_default","FormatIndentIncrease_default","AccountCircle_default","GroupWork_default","Explore_default","right","buttons","Button_default","reset","onClick","close","React","Component","withStyles","theme","position","height","width","display","flexDirection","justifyContent","alignItems","flex","flexFlow","paddingLeft","marginRight","spacing","unit","withTheme","BadgeIcon","count","Badge_default","badgeContent","children","Taskbar","openDrawer","closeMenu","focus","setTitle","t","title","clearScreen","clear","sendCommand","cmd","sendText","txt","sendAPI","args","setUnreadMail","u","unreadMail","setUnreadBB","unreadBB","pushTask","task","taskbar","push","popTask","i","indexOf","splice","unsmallify","front","showMenu","menuAnchor","showHelp","help","helpAnchor","closeHelp","typeHelp","searchHelp","preventDefault","length","showUpload","file","uploadAnchor","closeUpload","insertCommand","input","root","closeHistory","clearHistory","showHistory","historyAnchor","showLog","logname","logAnchor","closeLog","typeLog","saveLog","typeURL","url","previewUpload","addReactPanel","upload","setText","handleFile","files","reader","FileReader","onload","result","readAsText","handleURL","startsWith","req","XMLHttpRequest","onreadystatechange","readyState","status","responseText","alert","send","history","createRef","conn","reconnect","_this2","rev","slice","reverse","AppBar_default","Toolbar_default","disableGutters","Typography_default","variant","noWrap","map","Tooltip_default","key","headertitle","innerText","tasklabel","taskbutton","aria-label","Tab_default","taskicon","tasksep","RemoveRedEye_default","BusinessCenter_default","People_default","Forum_default","Mail_default","aria-owns","aria-haspopup","Search_default","icons_Menu_default","SwipeableDrawer_default","anchor","onOpen","modules_Settings","Boolean","onSubmit","padded","autoComplete","autoFocus","fullWidth","InputProps","inputProps","style","textAlign","endAdornment","InputAdornment_default","accept","fileinput","htmlFor","component","historyPopover","button","divider","Menu_default","disableEnforceFocus","MenuItem_default","Settings_default","CloudUpload_default","Save_default","Keyboard_default","Backspace_default","Wifi_default","flexGrow","margin","cmdbutton","cmdlabel","flex-direction","drawerFrame","drawerButton","hide","drawerPaper","mailButton","BBButton","padding","maxHeight","overflowY","Terminal","focusInput","onResize","output","calcDimensions","Math","floor","parentNode","clientHeight","dims","scrollDown","lines","linesOfScroll","terminal","prompt","init","document","addEventListener","initOutput","current","initPrompt","dim","containerRef","ref","classNames","onScroll","maxWidth","scrollcount","align","flex-flow","border","background-color","main","font-family","font-weight","font-size","breakpoints","down","overflowX","white-space","word-wrap","overflow","text-align","vertical-align","bottom","Input","initInput","text","outline","resize","Statusbar","statusbar","background","Login","openLogin","msg","closeLogin","submitLogin","username","getElementById","password","str","submitGuest","submitCreate","catchReturn","e","login","Dialog_default","onEscapeKeyDown","aria-labelledby","disableBackdropClick","disableEscapeKeyDown","DialogTitle_default","IconButton_default","DialogContent_default","DialogContentText_default","dangerouslySetInnerHTML","__html","onKeyPress","DialogActions_default","block","PersonAdd_default","PersonOutline_default","Person_default","withMobileDialog","COMPASS","NORTH","ArrowUpward_default","SOUTH","ArrowDownward_default","WEST","ArrowBack_default","EAST","ArrowForward_default","SOUTHEAST","SvgIcon_default","points","SOUTHWEST","NORTHEAST","NORTHWEST","UP","CallMade_default","DOWN","CallReceived_default","IN","ExitToApp_default","OUT","Launch_default","Sidebar","go","exit","_window$client","jsonapi","delayContents","clearTimeout","getContents","setTimeout","action","matchExit","ucExits","split","buildExit","uc","toUpperCase","exits","things","players","friends","customExits","useCompass","forEach","keys","_loop","fullexit","match","n","obj","player","_this$state2","sidebar","exitWidget","navWidget","_this3","_this$state3","parseExits","exitItem","contents","playerItem","ListItemAvatar_default","Avatar_default","p","join","thing","thingItem","minWidth","backgroundColor","paper","flexShrink","-webkit-transform","transform","Portal","middle","dock","scrollTo","container","_window$client$settin","modules_Sidebar","core_styles","top","modules_Taskbar","modules_Terminal","modules_Input","modules_Statusbar","modules_Login","Chargen","MailListItem","icon","mail","quickDelete","handleMark","selected","deleted","Delete_default","unread","read","urgent","PriorityHigh_default","Drafts_default","even","odd","listicon","subject","from","time","CheckCircle_default","Cancel_default","opacity","MailList","purgeMail","mailbox","sendMail","toggleDelete","openMail","maillist","header","DeleteSweep_default","DeleteForever_default","Create_default","Mailbox_MailListItem","align-items","Emulator","onCommand","ansiState","fg","DEFAULT_FG","bg","DEFAULT_BG","fg256","bg256","ansi","charCodeAt","codes","substring","ii","undefined","ANSI_NORMAL","parseInt","getANSI","ANSI_XTERM_FG","ANSI_BLINK","ANSI_XTERM_BG","ANSI_BRIGHT","ANSI_UNDERLINE","ANSI_INVERSE","ansiDirty","start","end","next","encodeState","ansiClass","span","stack","appendChild","createTextNode","lineBuf","onLine","write","PARSE_PLAIN","PARSE_ESC1","PARSE_ESC2","parseBuf","data","ilen","ch","PARSE_CR","abortParse","endLine","applyANSI","html","div","fragment","createDocumentFragment","innerHTML","child","firstChild","nextSibling","getAttribute","setAttribute","removeAttribute","classid","message","element","console","warn","tag","attrs","idx","selfClosing","UNCLOSED_TAGS","toLowerCase","search","replace","pushElement","popElement","line","threshold","temp","nodeName","fontFamily","fontSize","clientWidth","removeChild","round","abs","scrollHeight","offsetHeight","scrollTop","MailItem","markUnread","markDeleted","markUndeleted","replyMail","forwardMail","body","emulator","appendText","Card_default","card","CardHeader_default","sub","CardContent_default","wrap","CardActions_default","actions","Reply_default","Forward_default","MoreVert_default","marginLeft","justify-content","overflow-y","overflow-x","Mailbox","mailitem","folder","folderlist","_this$state4","_this$state5","to","sendmail","focusPanel","setFields","panelSize","_this$state6","Mailbox_MailList","Mailbox_MailItem","Sendmail","chips","realsub","substr","closePanel","handleChange","changeText","editor","setError","error","onInput","addChip","chip","execString","delChip","beforeAdd","endsWith","panel","options","resizeit","panels","ChipInput_default","blurBehavior","onUpdateInput","newChipKeyCodes","onBeforeAdd","onAdd","nameInput","onDelete","FormHelperTextProps","stretch","lib_default","bodytext","mode","wrapEnabled","highlightActiveLine","editorProps","$blockScrolling","Infinity","Send_default","BBListItem","board","posts","lastmod","BBList","openBoard","boardlist","BBoard_BBListItem","BBMessageListItem","author","date","BBMessageList","openMessage","messages","BBoard_BBMessageListItem","BBMessage","BBoard","openBB","openBBMsg","bbmsg","bboard","bb","full","BBoard_BBMessageList","BBoard_BBMessage","BBoard_BBList","Upload","startUpload","uploading","uploadLine","pauseUpload","resetText","changeDelay","delay","newtext","readOnly","stretchflex","pad","Pause_default","Redo_default","Connection","socket","isOpen","onError","onUpdate","onText","onObject","onHTML","onPueblo","onPrompt","hasData","that","isConnected","WebSocket","onopen","evt","onerror","onclose","onmessage","CHANNEL_TEXT","CHANNEL_JSON","JSON","stringify","channel","parse","log","CHANNEL_HTML","CHANNEL_PUEBLO","CHANNEL_PROMPT","onMessage","UserInput","selectionStart","selectionStop","onEnter","onEscape","onPageUp","onPageDown","keyCycleForward","keyCycleBackward","onkeydown","onkeyup","onKeyDown","onKeyUp","code","ctrl","keyCode","which","ctrlKey","shift","shiftKey","alt","altKey","prevent","isKeyCycleBackward","cycleBackward","isKeyCycleForward","cycleForward","saveCommand","moveCursor","pressKey","releaseKey","ncommand","save_current","selectionEnd","createTextRange","range","collapse","select","force","getSelection","toString","selection","createRange","activeElement","tagName","Utils","links","regex","lastIndex","exec","info","index","xch_cmd","nodeValue","extractLinks","nodeIdx","nodeStart","nodeEnd","startOff","startNode","endOff","endNode","splitText","middleNode","replaceChild","href","command","val","JSONAPI","self","bbmsglist","listcontents","EventEmitter","require","TinyCon","LOGINFAIL","Client","setBubble","hidden","tinycon","updateCounter","serverAddress","serverPort","serverSSL","events","jsPanel","loggedIn","updateLines","eatNewline","scrollThreshold","reconnectTimer","reconnectCount","reconnectMaxCount","initPanels","initNotifications","src","async","getElementsByTagName","store","localStorage","String","hasOwnProperty","bind","Number","parseCommand","scroll","nearBottom","appendMessage","_this4","scrollPageUp","scrollPageDown","_this5","arguments","onunload","onresize","fun","cfg","el","config","headerTitle","callback","ReactDOM","render","MuiThemeProvider","create","getPanels","host","port","ssl","serverUrl","re_fugueedit","RegExp","insert","scrollIfNeeded","appendHTML","appendPueblo","op","gmcp","emit","_this6","astr","_this7","shortid","generate","on","removeAllListeners","_this8","filename","node","textContent","blob","Blob","saveAs","visibilityChange","_this9","msHidden","webkitHidden","setOptions","fallback","abbreviate","defaults","minimizeTo","onminimized","onclosed","unmountComponentAtNode","dragit","saveCursor","stop","resetCursor","loadScript","location","protocol","defaultPort","connect"],"mappings":"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","file":"static/js/main.163fc1e5.chunk.js","sourcesContent":["import { createMuiTheme } from '@material-ui/core/styles';\nimport blueGrey from '@material-ui/core/colors/blueGrey';\nimport indigo from '@material-ui/core/colors/indigo';\n\nconst Theme = createMuiTheme({\n  typography: {\n    useNextVariants: true,\n//    suppressDeprecationWarnings: true,\n  },\n  palette: {\n    primary: indigo,\n    secondary: blueGrey,\n    type: 'dark',\n  },\n});\n\nexport default Theme;\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\n//import classNames from 'classnames';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Button from '@material-ui/core/Button';\nimport Icon from '@material-ui/core/Icon';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Switch from '@material-ui/core/Switch';\nimport TextField from '@material-ui/core/TextField';\nimport Popover from '@material-ui/core/Popover';\n//import ListItemText from '@material-ui/core/ListItemText';\n\nimport BugReportIcon from '@material-ui/icons/BugReport';\nimport PaletteIcon from '@material-ui/icons/Palette';\nimport WrapTextIcon from '@material-ui/icons/WrapText';\nimport EditIcon from '@material-ui/icons/Edit';\nimport CodeIcon from '@material-ui/icons/Code';\nimport BorderLeftIcon from '@material-ui/icons/BorderLeft';\nimport BorderRightIcon from '@material-ui/icons/BorderRight';\nimport VerticalSplitIcon from '@material-ui/icons/VerticalSplit';\nimport PictureInPictureIcon from '@material-ui/icons/PictureInPicture';\nimport GroupWorkIcon from '@material-ui/icons/GroupWork';\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport ExploreIcon from '@material-ui/icons/Explore';\nimport FormatIndentIncreaseIcon from '@material-ui/icons/FormatIndentIncrease';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    position: \"relative\",\n    height: \"auto\",\n    width: \"100%\",\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    alignItems: \"stretch\",\n  },\n  left: {\n    flex: 1,\n  },\n  right: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n  },\n  content: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n  },\n  switchText: {\n    paddingLeft: 0,\n    marginRight: 2*theme.spacing.unit,\n  },\n  buttons: {\n    flex: 1,\n    display: \"flex\",\n    flexFlow: \"row nowrap\",\n    height: \"100%\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Settings extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      colorAnchor: null,\n    };\n    \n    this.color = null;\n    \n    this.state = Object.assign(this.state, window.client.settings);\n  }\n  \n  handleSwitch = name => event => {\n    window.client.changeSetting(name, event.target.checked);\n    this.setState({ [name]: window.client.settings[name] });\n    window.client.saveSettings();\n    window.client.react.portal.forceUpdate();\n  };\n  \n  handleValue = name => event => {\n    window.client.changeSetting(name, event.target.value);\n    this.setState({ [name]: window.client.settings[name] });\n    window.client.saveSettings();\n    window.client.react.portal.forceUpdate();\n  };\n  \n  showColor = name => event => {\n    this.color = name;\n    this.setState({ colorAnchor: event.currentTarget });\n  };\n  \n  closeColor = () => {\n    this.setState({ colorAnchor: null });\n  };\n  \n  chooseColor = color => event => {\n    this.setState({ [this.color]: \"ansi-\"+color });\n    this.closeColor();\n  };\n  \n  loadSettings = () => {\n    this.setState({ ...window.client.settings });\n  }\n  \n  resetSettings = () => {\n    if (!window.confirm(\"Are you sure you want to reset settings to defaults?\")) {\n      return;\n    }\n    \n    window.client.settings = Object.assign({}, window.client.defaultSettings);\n    this.loadSettings();\n    window.client.saveSettings();\n    window.client.react.portal.forceUpdate();\n  };\n  \n  componentDidMount() {\n  }\n  \n  componentWillUnmount() {\n  }\n\n  render() {\n    const { classes, closeDrawer } = this.props;\n    const { debugEvents, decompileEditor, decompileKey, ansiFG, ansiBG, wrapWidth,\n      sidebarOpen, sidebarAnchor, sidebarAlwaysShow, colorAnchor, sidebarShowPlayers,\n      sidebarShowThings, sidebarShowExits, sidebarShowCompass, sidebarWidth } = this.state;\n    \n    return (\n      <div className={classes.frame}>\n        <div className={classes.left}>\n          <div className={classes.content} tabIndex={0} role=\"button\">\n            <Popover id=\"settings.color\" anchorEl={colorAnchor} open={false} onClose={this.closeColor}>\n            </Popover>\n            \n            <List disablePadding dense subheader={<ListSubheader>Debugging</ListSubheader>}>\n              <ListItem dense>\n                <ListItemIcon>\n                  <BugReportIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Debug server events?\" />\n                <ListItemSecondaryAction>\n                  <Switch checked={debugEvents} value=\"debugEvents\" onChange={this.handleSwitch('debugEvents')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n            </List>\n\n            <List disablePadding dense subheader={<ListSubheader>Display Settings</ListSubheader>}>\n              <ListItem dense>\n                <ListItemIcon>\n                  <WrapTextIcon />\n                </ListItemIcon>\n                <TextField label=\"Terminal Width\" value={wrapWidth} onChange={this.handleValue('wrapWidth')} type=\"number\" />\n              </ListItem>\n              \n              <ListItem dense>\n                <ListItemIcon>\n                  <PaletteIcon />\n                </ListItemIcon>\n                <TextField label=\"Background Color\" value={ansiBG} onChange={this.handleValue('ansiBG')} />\n              </ListItem>\n\n              <ListItem dense>\n                <ListItemIcon>\n                  <PaletteIcon />\n                </ListItemIcon>\n                <TextField label=\"Foreground Color\" value={ansiFG} onChange={this.handleValue('ansiFG')} />\n              </ListItem>\n            </List>\n            \n            <List disablePadding dense subheader={<ListSubheader>@decompile/tf</ListSubheader>}>\n              <ListItem dense>\n                <ListItemIcon>\n                  <EditIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Send @dec/tf to editor.\" />\n                <ListItemSecondaryAction>\n                  <Switch checked={decompileEditor} value=\"decompileEditor\" onChange={this.handleSwitch('decompileEditor')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n\n              <ListItem dense>\n                <ListItemIcon>\n                  <CodeIcon />\n                </ListItemIcon>\n                <TextField label=\"TFPREFIX\" value={decompileKey} onChange={this.handleValue('decompileKey')} helperText=\"Prefix used by @dec/tf.\" />\n              </ListItem>\n            </List>\n\n            <List disablePadding dense subheader={<ListSubheader>Sidebar Display</ListSubheader>}>\n              <ListItem dense>\n                <ListItemIcon>\n                  <VerticalSplitIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Show sidebar?\" />\n                <ListItemSecondaryAction>\n                  <Switch checked={sidebarOpen} value=\"sidebarOpen\" onChange={this.handleSwitch('sidebarOpen')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n              \n              <ListItem dense disabled={!sidebarOpen}>\n                <ListItemIcon>\n                  <PictureInPictureIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Keep panels off sidebar?\" />\n                <ListItemSecondaryAction>\n                  <Switch disabled={!sidebarOpen} checked={sidebarAlwaysShow} value=\"sidebarAlwaysShow\" onChange={this.handleSwitch('sidebarAlwaysShow')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n              \n              <ListItem dense disabled={!sidebarOpen}>\n                <Icon color=\"action\">\n                  <BorderLeftIcon />\n                </Icon>\n                <ListItemText primary=\"Left\" />\n                <Switch checked={sidebarAnchor === \"right\"}\n                  color=\"default\" disabled={!sidebarOpen}\n                  value={sidebarAnchor === \"right\" ? \"left\" : \"right\"}\n                  onChange={this.handleValue('sidebarAnchor')}\n                />\n                <ListItemText primary=\"Right\" />\n                <Icon color=\"action\">\n                  <BorderRightIcon />\n                </Icon>\n              </ListItem>\n              \n              <ListItem dense disabled={!sidebarOpen}>\n                <ListItemIcon>\n                  <FormatIndentIncreaseIcon />\n                </ListItemIcon>\n                <TextField label=\"Sidebar Width\" value={sidebarWidth} onChange={this.handleValue('sidebarWidth')} />\n              </ListItem>\n            </List>\n            \n            <List disabled={!sidebarOpen} disablePadding dense subheader={<ListSubheader>Sidebar Content</ListSubheader>}>\n              <ListItem dense disabled={!sidebarOpen}>\n                <ListItemIcon>\n                  <AccountCircleIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Show players?\" />\n                <ListItemSecondaryAction>\n                  <Switch disabled={!sidebarOpen} checked={sidebarShowPlayers} value=\"sidebarShowPlayers\" onChange={this.handleSwitch('sidebarShowPlayers')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n              \n              <ListItem dense disabled={!sidebarOpen}>\n                <ListItemIcon>\n                  <GroupWorkIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Show things?\" />\n                <ListItemSecondaryAction>\n                  <Switch disabled={!sidebarOpen} checked={sidebarShowThings} value=\"sidebarShowThings\" onChange={this.handleSwitch('sidebarShowThings')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n              \n              <ListItem dense disabled={!sidebarOpen}>\n                <ListItemIcon>\n                  <ExploreIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Show exits?\" />\n                <ListItemSecondaryAction>\n                  <Switch checked={sidebarShowExits} disabled={!sidebarOpen} value=\"sidebarShowExits\" onChange={this.handleSwitch('sidebarShowExits')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n              \n              <ListItem dense disabled={!sidebarOpen || !sidebarShowExits}>\n                <ListItemIcon>\n                  <ExploreIcon />\n                </ListItemIcon>\n                <ListItemText className={classes.switchText} primary=\"Show compass?\" />\n                <ListItemSecondaryAction>\n                  <Switch disabled={!sidebarOpen || !sidebarShowExits} checked={sidebarShowCompass} value=\"sidebarShowCompass\" onChange={this.handleSwitch('sidebarShowCompass')} />\n                </ListItemSecondaryAction>\n              </ListItem>\n            </List>\n          </div>\n        </div>\n        <div className={classes.right}>\n          <div className={classes.buttons}>\n            <Button className={classes.reset} onClick={this.resetSettings}>\n              Reset\n            </Button>\n            <Button className={classes.close} onClick={closeDrawer}>\n              Close\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nSettings.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  closeDrawer: PropTypes.func.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Settings);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Badge from '@material-ui/core/Badge';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport Popover from '@material-ui/core/Popover';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nimport MenuIcon from '@material-ui/icons/Menu';\nimport MailIcon from '@material-ui/icons/Mail';\nimport ForumIcon from '@material-ui/icons/Forum';\nimport TabIcon from '@material-ui/icons/Tab';\nimport PeopleIcon from '@material-ui/icons/People';\nimport RemoveRedEyeIcon from '@material-ui/icons/RemoveRedEye';\nimport BusinessCenterIcon from '@material-ui/icons/BusinessCenter';\nimport BackspaceIcon from '@material-ui/icons/Backspace';\nimport SaveIcon from '@material-ui/icons/Save';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport KeyboardIcon from '@material-ui/icons/Keyboard';\nimport SearchIcon from '@material-ui/icons/Search';\nimport WifiIcon from '@material-ui/icons/Wifi';\n\nimport Settings from '../Settings';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst drawerHeight = 240;\n\nconst styles = theme => ({\n  root: {\n    flexGrow: 1,\n  },\n  title: {\n    margin: '0 20px',\n  },\n  tasksep: {\n    marginRight: theme.spacing.unit,\n  },\n  taskbutton: {\n    margin: theme.spacing.unit,\n  },\n  taskicon: {\n    marginRight: theme.spacing.unit,\n  },\n  tasklabel: {\n//    display: \"flex\",\n//    \"flex-direction\": \"column\",\n  },\n  cmdbutton: {\n  },\n  cmdlabel: {\n    display: \"flex\",\n    \"flex-direction\": \"column\",\n  },\n  flex: {\n    flex: 1,\n  },\n  drawerFrame: {\n    width: '100%',\n  },\n  drawerButton: {\n    margin: theme.spacing.unit,\n  },\n  hide: {\n    display: 'none',\n  },\n  drawerPaper: {\n    position: 'relative',\n    height: drawerHeight,\n  },\n  mailButton: {\n    margin: theme.spacing.unit,\n  },\n  BBButton: {\n    margin: theme.spacing.unit,\n  },\n  fileinput: {\n    display: 'none',\n  },\n  padded: {\n    width: \"calc(100%-\"+2*theme.spacing.unit+\")\",\n    padding: -theme.spacing.unit,\n    margin: theme.spacing.unit,\n  },\n  historyPopover: {\n    maxHeight: \"10em\",\n    overflowY: \"auto\",\n  },\n});\n\n\nfunction BadgeIcon(props) {\n  if (props.count > 0) {\n    return (\n      <Badge badgeContent={props.count} color=\"error\">\n        {props.children}\n      </Badge>\n    );\n  }\n  return props.children;\n};\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Taskbar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n      title: props.title,\n      taskbar: [ ],\n      unreadBB: 0,\n      unreadMail: 0,\n      menuAnchor: null,\n      uploadAnchor: null,\n      helpAnchor: null,\n      logAnchor: null,\n      historyAnchor: null,\n    };\n    \n    this.help = \"\";\n    this.url = \"\";\n    this.file = \"\";\n    this.logname = \"\";\n    this.history = null;\n    this.frame = React.createRef();\n    \n  }\n\n  openDrawer = () => {\n    this.closeMenu();\n    this.setState({open: true});\n  };\n  \n  closeDrawer = () => {\n    this.setState({open: false});\n    window.client.react.portal.forceUpdate();\n    window.client.focus(true);\n  };\n  \n  setTitle = t => {\n    this.setState({title: t});\n  };\n\n  clearScreen = () => {\n    if (window.confirm('Do you want to clear the screen?')) {\n      window.client.clear();\n    }\n  };\n\n  sendCommand = (cmd) => {\n    window.client.sendCommand(cmd);\n  };\n\n  sendText = (txt) => {\n    window.client.sendText(txt);\n  };\n\n  sendAPI = (cmd, args) => {\n    window.client.sendAPI(cmd, args);\n  };\n\n  setUnreadMail = u => {\n    this.setState({unreadMail: u});\n  };\n\n  setUnreadBB = u => {\n    this.setState({unreadBB: u});\n  };\n  \n  pushTask = (task) => {\n    const { taskbar } = this.state;\n    taskbar.push(task);\n    this.setState({ taskbar });\n  };\n  \n  popTask = (task) => {\n    const { taskbar } = this.state;\n    const i = taskbar.indexOf(task);\n    taskbar.splice(i, 1);\n    task.unsmallify();\n    task.front();\n    this.setState({ taskbar });\n  };\n  \n  showMenu = event => {\n    this.setState({ menuAnchor: event.currentTarget });\n  };\n  \n  closeMenu = () => {\n    this.setState({ menuAnchor: null });\n    window.client.focus(true);\n  };\n  \n  showHelp = event => {\n    this.help = null;\n    this.setState({ helpAnchor: event.currentTarget });\n  };\n  \n  closeHelp = () => {\n    this.setState({ helpAnchor: null });\n    window.client.focus(true);\n  };\n  \n  typeHelp = event => {\n    this.help = event.target.value;\n  };\n  \n  searchHelp = event => {\n    event.preventDefault();\n    if (this.help && this.help.length > 0) {\n      window.client.sendCommand(\"help \"+this.help);\n    } else {\n      window.client.sendCommand(\"help\");\n    }\n\n    this.closeHelp();\n  };\n  \n  showUpload = event => {\n    this.file = null;\n    this.closeMenu();\n    this.setState({ uploadAnchor: event.currentTarget });\n  };\n  \n  closeUpload = () => {\n    this.setState({ uploadAnchor: null });\n    window.client.focus(true);\n  };\n  \n  insertCommand = cmd => event => {\n    window.client.input.root.value = cmd;\n    this.closeHistory();\n  };\n  \n  clearHistory = () => {\n    if (window.confirm(\"Do you want to clear the command history?\")) {\n      window.client.input.clearHistory();\n      this.closeHistory();\n    }\n  };\n  \n  showHistory = event => {\n    this.closeMenu();\n    this.setState({ historyAnchor: event.currentTarget });\n  };\n  \n  closeHistory = () => {\n    this.setState({ historyAnchor: null });\n    window.client.focus(true);\n  };\n  \n  showLog = event => {\n    this.logname = null;\n    this.closeMenu();\n    this.setState({ logAnchor: event.currentTarget });\n  };\n  \n  closeLog = () => {\n    this.setState({ logAnchor: null });\n    window.client.focus(true);\n  };\n  \n  typeLog = event => {\n    this.logname = event.target.value;\n  };\n  \n  saveLog = event => {\n    event.preventDefault();\n    \n    if (!this.logname || !(this.logname.length > 0)) return;\n    \n    window.client.saveLog(this.logname+\".txt\");\n    \n    this.closeLog();\n  };\n  \n  typeURL = event => {\n    this.url = event.target.value;\n  };\n  \n  previewUpload = () => {\n    window.client.addReactPanel(\"Upload\");\n\n    if (this.file && this.file.length > 0) {\n      window.client.react.upload.setText(this.file);\n    }\n    \n    this.closeUpload();\n  };\n  \n  handleFile = event => {\n    event.preventDefault();\n    const files = event.target.files;\n    \n    if (files.length > 0) {\n      var reader = new FileReader();\n      reader.onload = () => {\n        this.file = reader.result;\n        this.previewUpload();\n      };\n      reader.readAsText(files[0]);\n    }\n  };\n  \n  handleURL = event => {\n    event.preventDefault();\n    \n    if (!this.url || !this.url.startsWith(\"http\")) return;\n\n    var req = new window.XMLHttpRequest();\n    req.onreadystatechange = () => {\n      if (req.readyState === 4) {\n        // The request is done; did it work?\n        if (req.status === 200) {\n          this.file = req.responseText;\n          this.previewUpload();\n        } else {\n          alert(\"Unable to download URL! See console for more information.\");\n        }\n      }\n    };\n    req.open(\"GET\", this.url);\n    req.send();\n  };\n  \n  reconnect() {\n    if (window.confirm(\"Do you want to reconnect?\")) {\n      window.client.conn.reconnect();\n    }\n  }\n  \n  componentDidMount() {\n    window.client.react.taskbar = this;\n  }\n\n  componentWillUnmount() {\n    window.client.react.taskbar = null;\n  }\n  \n  render() {\n    const input = window.client.input;\n    const { classes } = this.props;\n    const { title, taskbar, open, unreadBB, unreadMail, historyAnchor,\n            menuAnchor, uploadAnchor, helpAnchor, logAnchor } = this.state;\n\n    var rev = input ? input.history.slice().reverse() : [];\n    \n    return (\n      <AppBar className={classes.root} position=\"static\" onClick={() => window.client.focus()}>\n        <Toolbar disableGutters={!this.state.open}>\n          <Typography variant=\"h6\" color=\"inherit\" noWrap className={classes.title}>\n            {title}\n          </Typography>\n          <div className={classes.flex}></div>\n          {taskbar.map((task,i) => (\n            <Tooltip key={i} title={task.headertitle.innerText}>\n              <Button key={task.id} classes={{ label: classes.tasklabel }} className={classes.taskbutton} aria-label=\"open-task\" onClick={() => this.popTask(task)}>\n                <TabIcon className={classes.taskicon} />\n                {task.headertitle.innerText}\n              </Button>\n            </Tooltip>\n          ))}\n          \n          <div className={classes.tasksep}></div>\n          \n          <Tooltip title=\"Look around.\">\n            <Button aria-label=\"send-look\" onClick={() => { this.sendCommand(\"look\"); this.sendAPI(\"listcontents\"); }}>\n              <RemoveRedEyeIcon />\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"What am I carrying?\">\n            <Button aria-label=\"send-inventory\" onClick={() => this.sendCommand(\"inventory\")}>\n              <BusinessCenterIcon />\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"Who's online?\">\n            <Button aria-label=\"send-who\" onClick={() => this.sendCommand(\"who\")}>\n              <PeopleIcon />\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"Bulletin Boards\">\n            <Button aria-label=\"open-bbs\" onClick={() => this.sendAPI(\"boardlist\")}>\n              <BadgeIcon count={unreadBB}>\n                <ForumIcon />\n              </BadgeIcon>\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"@mail Inbox\">\n            <Button aria-label=\"open-mail\" onClick={() => this.sendAPI(\"maillist\")}>\n              <BadgeIcon count={unreadMail}>\n                <MailIcon />\n              </BadgeIcon>\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"Need help?\">\n            <Button aria-owns={helpAnchor ? 'taskbar.help' : null} aria-label=\"help\" aria-haspopup=\"true\" onClick={this.showHelp}>\n              <SearchIcon />\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"More tasks...\">\n            <Button aria-owns={menuAnchor ? 'taskbar.menu' : null} aria-label=\"open-menu\" aria-haspopup=\"true\" onClick={this.showMenu}>\n              <MenuIcon />\n            </Button>\n          </Tooltip>\n          \n          <SwipeableDrawer\n            variant=\"temporary\"\n            anchor=\"top\"\n            open={open}\n            onClose={this.closeDrawer}\n            onOpen={this.openDrawer}\n          >\n            <Settings closeDrawer={this.closeDrawer} />\n          </SwipeableDrawer>\n\n          <Popover id=\"taskbar.help\" anchorEl={helpAnchor} open={Boolean(helpAnchor)} onClose={this.closeHelp}>\n            <form onSubmit={this.searchHelp}>\n              <TextField label=\"Help topic\" className={classes.padded} autoComplete=\"false\" autoFocus variant=\"outlined\" onChange={this.typeHelp} />\n            </form>\n            <Button fullWidth onClick={this.searchHelp}>\n              Get Help\n            </Button>\n          </Popover>\n          \n          <Popover id=\"taskbar.log\" anchorEl={logAnchor} open={Boolean(logAnchor)} onClose={this.closeLog}>\n            <form onSubmit={this.saveLog}>\n              <TextField label=\"File Name\" variant=\"outlined\" className={classes.padded}\n                onChange={this.typeLog} autoFocus\n                InputProps={{ inputProps: { style: { textAlign: 'right' }}, endAdornment: <InputAdornment position=\"end\">.txt</InputAdornment> }}\n              />\n            </form>\n            <Button fullWidth onClick={this.saveLog}>\n              Save Log\n            </Button>\n          </Popover>\n          \n          <Popover id=\"taskbar.upload\" anchorEl={uploadAnchor} open={Boolean(uploadAnchor)} onClose={this.closeUpload}>\n            <form onSubmit={this.handleURL} className={classes.padded}>\n              <TextField type=\"url\" fullWidth label=\"Insert URL\" variant=\"outlined\" onChange={this.typeURL} autoFocus />\n            </form>\n            <Button onClick={this.handleURL}>\n              Upload URL\n            </Button>\n            <input\n              accept=\"text/plain\"\n              className={classes.fileinput}\n              id=\"file.upload\"\n              type=\"file\"\n              onChange={this.handleFile}\n            />\n            <label htmlFor=\"file.upload\">\n              <Button component=\"span\">\n                Choose File\n              </Button>\n            </label>\n            <Button onClick={this.previewUpload}>\n              Paste Text\n            </Button>\n          </Popover>\n          \n          <Popover id=\"taskbar.history\" anchorEl={historyAnchor} open={Boolean(historyAnchor)} onClose={this.closeHistory}>\n            <List className={classes.historyPopover}>\n              {rev.map((cmd, i) => (\n                <ListItem key={i} button dense divider onClick={this.insertCommand(cmd)}>\n                  <ListItemText primary={cmd} />\n                </ListItem>\n              ))}\n            </List>\n            <Button onClick={this.clearHistory}>\n              Clear History\n            </Button>\n          </Popover>\n          \n          <Menu disableEnforceFocus id=\"taskbar.menu\" anchorEl={menuAnchor} open={Boolean(menuAnchor)} onClick={this.closeMenu} onClose={this.closeMenu}>\n            <MenuItem onClick={this.closeMenu}>\n              <Tooltip title=\"Close menu.\">\n                <MenuIcon />\n              </Tooltip>\n            </MenuItem>\n            <MenuItem onClick={this.openDrawer}>\n              <Tooltip title=\"Change settings.\">\n                <SettingsIcon />\n              </Tooltip>\n            </MenuItem>\n            <MenuItem aria-owns={uploadAnchor ? 'taskbar.upload' : null} aria-label=\"open-upload\" aria-haspopup=\"true\" onClick={this.showUpload}>\n              <Tooltip title=\"Upload file/URL.\">\n                <CloudUploadIcon />\n              </Tooltip>\n            </MenuItem>\n            <MenuItem aria-owns={logAnchor ? 'taskbar.log' : null} aria-label=\"open-log\" aria-haspopup=\"true\" onClick={this.showLog}>\n              <Tooltip title=\"Save display log.\">\n                <SaveIcon />\n              </Tooltip>\n            </MenuItem>\n            <MenuItem aria-owns={historyAnchor ? 'taskbar.history' : null} aria-label=\"open-history\" aria-haspopup=\"true\" onClick={this.showHistory}>\n              <Tooltip title=\"Show command history.\">\n                <KeyboardIcon />\n              </Tooltip>\n            </MenuItem>\n            <MenuItem onClick={this.clearScreen}>\n              <Tooltip title=\"Clear screen.\">\n                <BackspaceIcon />\n              </Tooltip>\n            </MenuItem>\n            <MenuItem onClick={this.reconnect}>\n              <Tooltip title=\"Reconnect.\">\n                <WifiIcon />\n              </Tooltip>\n            </MenuItem>            \n          </Menu>\n\n          <div className={classes.tasksep}></div>\n        </Toolbar>\n      </AppBar>\n    );\n  }\n}\n\nTaskbar.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Taskbar);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    position: \"relative\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n    margin: 0,\n    padding: 0,\n    border: \"none\",\n    \"background-color\": theme.palette.primary.main,\n    flex: 1,\n    height: \"100%\",\n    \"font-family\": \"'Courier New', monospace\",\n    \"font-weight\": \"normal\",\n    \"font-size\": \"10pt\",\n    [theme.breakpoints.down('sm')]: {\n      \"font-size\": \"5pt\",\n    },\n  },\n  terminal: {\n    flex: 1,\n    position: \"relative\",\n    overflowY: \"scroll\",\n    overflowX: \"hidden\",\n    padding: \"0.25em 0.5em\",\n  },\n  output: {\n    \"white-space\": \"pre-wrap\",\n    \"word-wrap\": \"break-word\",\n    position: \"absolute\",\n    margin: 0,\n    border: 0,\n    padding: 0,\n  },\n  taskbar: {\n    padding: \"0\",\n    position: \"relative\",\n    overflow: \"hidden\",\n  },\n  prompt: {\n    overflow: \"hidden\",\n    \"white-space\": \"pre-wrap\",\n    \"text-align\": \"left\",\n    \"vertical-align\": \"middle\",\n    height: \"1em\",\n    padding: \"0.25em\",\n  },\n  scrollcount: {\n    position: \"absolute\",\n    right: 0,\n    bottom: 0,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Terminal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lines: 0,\n    };\n    \n    this.terminal = React.createRef();\n    this.output = React.createRef();\n    this.prompt = React.createRef();\n\n    this.init = false;\n  }\n  \n  focusInput = () => {\n    window.client.focus();\n  };\n\n  componentDidMount() {\n    document.addEventListener('resize', this.onResize);\n    window.client.react.terminal = this;\n    window.client.initOutput(this.output.current, this.terminal.current);\n    window.client.initPrompt(this.prompt.current);\n    this.init = true;\n    this.forceUpdate();\n  }\n  \n  onResize = event => {\n    window.client.output.calcDimensions();\n    window.client.sendText(\"SCREENWIDTH \" + window.client.settings.wrapWidth);\n    window.client.sendText(\"SCREENHEIGHT \" + Math.floor(window.client.output.root.parentNode.clientHeight / window.client.output.dims.height));\n    window.client.output.scrollDown();\n\n    this.onChange();\n  };\n\n  onChange = () => {\n    this.setState({ lines: this.linesOfScroll() });\n  };\n  \n  linesOfScroll() {\n    return window.client.output.linesOfScroll();\n  }\n\n  render() {\n    const { classes, width, ansiFG, ansiBG, containerRef } = this.props;\n    const { lines } = this.state;\n    \n    var dim;\n    if (this.init) {\n      dim = width * window.client.output.dims.width + \"px\";\n    } else {\n      dim = \"100%\";\n    }\n    \n    return (\n      <div id=\"terminal-container\" className={classes.frame} onClick={this.focusInput} ref={containerRef}>\n        <div ref={this.terminal} className={classNames(classes.terminal, ansiFG, ansiBG)} onScroll={this.onChange}>\n          <div ref={this.output} className={classNames(classes.output, ansiFG, ansiBG)} style={{ maxWidth: dim }}></div>\n        </div>\n        <div className={classes.taskbar}>\n          <div ref={this.prompt} className={classNames(classes.prompt, ansiFG, ansiBG)}></div>\n          <div className={classes.scrollcount}>\n            <Typography color=\"error\" align=\"right\">\n              {lines > 0 && \"...and \"+lines+\" more lines...\"}\n            </Typography>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nTerminal.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  ansiFG: PropTypes.string.isRequired,\n  ansiBG: PropTypes.string.isRequired,\n  containerRef: PropTypes.object,\n};\n\nexport default withStyles(styles, { withTheme: true })(Terminal);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    \"background-color\": theme.palette.primary.main,\n    display: \"flex\",\n  },\n  text: {\n    flex: 1,\n    \"background-color\": \"black\",\n    color: \"silver\",\n    margin: \"1px 0 0 0\",\n    border: \"none\",\n    outline: \"none\",\n    \"vertical-align\": \"middle\",\n    padding: \"0.25em\",\n    resize: \"none\",\n    height: \"3em\",\n    \"font-family\": \"'Courier New', monospace\",\n    \"font-weight\": \"normal\",\n    \"font-size\": \"16pt\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Input extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n    };\n    this.input = React.createRef();\n  }\n  \n  componentDidMount() {\n    window.client.react.input = this;\n    window.client.initInput(this.input.current);\n  }\n  \n  render() {\n    const { classes } = this.props;\n    \n    return (\n      <div className={classes.frame}>\n        <textarea ref={this.input} className={classes.text}  autoComplete=\"off\" autoFocus></textarea>\n      </div>\n    );\n  }\n}\n\nInput.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Input);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Typography from '@material-ui/core/Typography';\nimport { withStyles } from '@material-ui/core/styles';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    background: theme.palette.primary.main,\n    margin: 0,\n    border: \"none\",\n    outline: \"none\",\n    \"text-align\": \"right\",\n    \"vertical-align\": \"middle\",\n    padding: \"0.25em\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Statusbar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: \".\",\n    };\n  }\n  \n  setStatus(status) {\n    this.setState({ status });\n  }\n  \n  componentDidMount() {\n    window.client.react.statusbar = this;\n  }\n  \n  componentWillUnmount() {\n    window.client.react.statusbar = null;\n  }\n  \n  render() {\n    const { classes } = this.props;\n    const { status } = this.state;\n    \n    return (\n      <div className={classes.frame} onClick={() => window.client.focus()}>\n        <Typography\n          align=\"right\"\n          color=\"textPrimary\"\n          noWrap\n        >\n          {status}\n        </Typography>\n      </div>\n    );\n  }\n}\n\nStatusbar.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Statusbar);\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport withMobileDialog from '@material-ui/core/withMobileDialog';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport PersonIcon from '@material-ui/icons/Person';\nimport PersonOutlineIcon from '@material-ui/icons/PersonOutline';\nimport PersonAddIcon from '@material-ui/icons/PersonAdd';\nimport SettingsIcon from '@material-ui/icons/Settings';\n\nconst styles = theme => ({\n  frame: {\n  },\n  left: {\n    marginRight: \"auto\",\n  },\n  text: {\n    \"font-size\": \"16pt\",\n  },\n  title: {\n    position: \"relative\",\n  },\n  block: {\n    display: \"flex\",\n    \"flex-direction\": \"column\",\n  },\n});\n\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n      msg: null,\n    };\n  }\n\n  openLogin = (msg) => {\n    this.setState({ open: true });\n    this.setState({ msg: msg });\n    this.focusInput('username');\n  };\n\n  closeLogin = () => {\n    this.setState({ open: false });\n    window.client.focus();\n  };\n  \n  submitLogin = () => {\n    var username = document.getElementById('username').value;\n    var password = document.getElementById('password').value;\n    document.getElementById('password').value = '';\n    \n    var str = 'connect \"' + username + '\" ' + password\n    window.client.sendText(str);\n    \n    this.closeLogin();\n  };\n  \n  submitGuest = () => {\n    window.client.sendText('connect guest');\n    this.closeLogin();\n  };\n  \n  submitCreate = () => {\n    var username = document.getElementById('username').value;\n    var password = document.getElementById('password').value;\n    document.getElementById('password').value = '';\n    \n    var str = 'create \"' + username + '\" ' + password\n    window.client.sendText(str);\n    \n    this.closeLogin();\n  };\n  \n  catchReturn = (e) => {\n    if (e.key === 'Enter') {\n      // Do code here\n      this.submitLogin();\n      e.preventDefault();\n    }\n  };\n  \n  focusInput(id) {\n    var input = document.getElementById(id);\n    input && input.focus();\n  }\n\n  componentDidMount() {\n    window.client.react.login = this;\n  }\n  \n  render() {\n    const { classes } = this.props;\n    const { open, msg } = this.state;\n    \n    return (\n      <div className={classes.frame}>\n        <Dialog\n          open={open}\n          onEscapeKeyDown={() => window.client.react.taskbar.openDrawer()}\n          onClose={this.closeLogin}\n          aria-labelledby=\"responsive-dialog-title\"\n          disableBackdropClick\n          disableEscapeKeyDown\n        >\n          <DialogTitle className={classes.title} id=\"responsive-dialog-title\">\n            Character Login\n            <ListItemSecondaryAction>\n              <IconButton onClick={() => window.client.react.taskbar.openDrawer()}>\n                <SettingsIcon />\n              </IconButton>\n            </ListItemSecondaryAction>\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              <span dangerouslySetInnerHTML={{ __html: msg }} />\n            </DialogContentText>\n            <TextField\n              className={classes.text}\n              margin=\"dense\"\n              id=\"username\"\n              label=\"Character Name\"\n              type=\"string\"\n              fullWidth\n              onKeyPress={this.catchReturn}\n            />\n            <TextField\n              className={classes.text}\n              margin=\"dense\"\n              id=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              fullWidth\n              onKeyPress={this.catchReturn}\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button className={classes.left} classes={{ label: classes.block }} onClick={this.submitCreate} color=\"primary\" variant=\"extendedFab\">\n              <PersonAddIcon />\n              Register\n            </Button>\n            <Button classes={{ label: classes.block }} onClick={this.submitGuest} color=\"primary\" variant=\"extendedFab\">\n              <PersonOutlineIcon />\n              Guest\n            </Button>\n            <Button classes={{ label: classes.block }} onClick={this.submitLogin} color=\"primary\" variant=\"extendedFab\" aria-label=\"login\">\n              <PersonIcon />\n              Login\n            </Button>\n          </DialogActions>\n        </Dialog>\n      </div>\n    );\n  }\n}\n\nLogin.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n};\n\nexport default withMobileDialog()(withStyles(styles, { withTheme: true })(Login));\n\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Avatar from '@material-ui/core/Avatar';\nimport IconButton from '@material-ui/core/IconButton';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport Typography from '@material-ui/core/Typography';\nimport Tooltip from '@material-ui/core/Tooltip';\n\n//import RemoveRedEyeIcon from '@material-ui/icons/RemoveRedEye';\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport CallMadeIcon from '@material-ui/icons/CallMade';\nimport CallReceivedIcon from '@material-ui/icons/CallReceived';\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\nimport LaunchIcon from '@material-ui/icons/Launch';\n\nconst COMPASS = {\n  NORTH: (<ArrowUpwardIcon />),\n  SOUTH: (<ArrowDownwardIcon />),\n  WEST: (<ArrowBackIcon />),\n  EAST: (<ArrowForwardIcon />),\n  SOUTHEAST: (<SvgIcon><polygon points=\"12,12 0,12 12,0\"/></SvgIcon>),\n  SOUTHWEST: (<SvgIcon><polygon points=\"12,12 12,0 24,12\"/></SvgIcon>),\n  NORTHEAST: (<SvgIcon><polygon points=\"12,12 12,24 0,12\"/></SvgIcon>),\n  NORTHWEST: (<SvgIcon><polygon points=\"12,12 12,24 24,12\"/></SvgIcon>),\n  UP: (<CallMadeIcon />),\n  DOWN: (<CallReceivedIcon />),\n  IN: (<ExitToAppIcon />),\n  OUT: (<LaunchIcon />),\n};\n\nconst styles = theme => ({\n  frame: {\n    position: \"relative\",\n    height: \"100%\",\n    minWidth: \"192px\",\n    backgroundColor: theme.palette.background.paper,\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n    textAlign: \"center\",\n    justifyContent: 'space-between',\n  },\n  contents: {\n    flexShrink: 1,\n    overflowX: 'hidden',\n    overflowY: 'auto',\n  },\n  playerItem: {\n    padding: 2,\n  },\n  thingItem: {\n  },\n  customExits: {\n    flexGrow: 1,\n    position: \"relative\",\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n  },\n  bottom: {\n    position: \"absolute\",\n    bottom: 0,\n    width: \"100%\",\n  },\n  navWidget: {\n    position: \"relative\",\n    bottom: 0,\n    left: \"50%\",\n    flexShrink: 0,\n    '-webkit-transform': 'translateX(-50%)',\n    transform: 'translateX(-50%)',\n  },\n});\n\nclass Sidebar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      exits: [],\n      things: [],\n      players: [],\n      friends: [],\n    };\n    \n    this.ucExits = [];\n    this.customExits = [];\n    this.useCompass = false;\n  }\n  \n  parseExits(exits) {\n    const { sidebarShowCompass } = this.props;\n    \n    this.ucExits = [];\n    this.customExits = [];\n    this.useCompass = false;\n    \n    exits.forEach((exit, i) => {\n      this.ucExits.push(exit.toUpperCase());\n    });\n    \n    if (!sidebarShowCompass) {\n      this.customExits = exits.slice(0);\n      return;\n    }\n    \n    var keys = Object.keys(COMPASS);\n    for (let i = 0; i < exits.length; i++) {\n      let fullexit = this.ucExits[i];\n      let match = -1;\n\n      fullexit.split(\";\").forEach((exit, n) => {\n        if (match === -1) {\n          match = keys.indexOf(exit);\n        }\n      });\n\n      if (match === -1) {\n        this.customExits.push(exits[i]);\n      } else {\n        this.useCompass = true;\n      }\n    }\n    \n  }\n  \n  getContents() {\n    window.client.sendAPI(\"listcontents\");\n  }\n\n  go = exit => event => {\n    const { jsonapi, delayContents } = window.client;\n    \n    if (exit && exit.length > 0) {\n      this.sendCommand(\"go \"+exit);\n      if (!jsonapi) {\n        // if we dont have movement events, do our own on a timer\n        clearTimeout(this.getContents);\n        setTimeout(this.getContents, delayContents);\n      }\n    }\n  };\n  \n  action = event => {\n    window.client.sendCommand(\"look\");\n    window.client.sendAPI(\"listcontents\");\n  };\n  \n  matchExit = exit => {\n    for (let i = 0; i < this.ucExits.length; i++) {\n      let fullexit = this.ucExits[i];\n      if (fullexit.split(\";\").indexOf(exit) !== -1) {\n        return i;\n      }\n    }\n    \n    return -1;\n  };\n  \n  buildExit = exit => {\n    var uc = exit.toUpperCase();\n    var disabled = this.matchExit(uc) === -1;\n    return (\n      <Tooltip disabled={disabled} title={exit}>\n        <span>\n          <IconButton onClick={this.go(exit)} disabled={disabled}>\n            {COMPASS[uc]}\n          </IconButton>\n        </span>\n      </Tooltip>\n    );    \n  };\n  \n  updateExits(exits) {\n    this.setState({ exits });\n  }\n  \n  updateThings(things) {\n    this.setState({ things });\n  }\n  \n  updatePlayers(players) {\n    this.setState({ players });\n  }\n  \n  addObject(obj) {\n    const { players, things } = this.state;\n    if (obj.player) {\n      players.push(obj.name);\n      this.setState({ players });\n    } else {\n      things.push(obj.name);\n      this.setState({ things });\n    }\n  }\n  \n  delObject(obj) {\n    const { players, things } = this.state;\n    var i;\n    \n    if (obj.player) {\n      i = players.indexOf(obj.name);\n      if (i !== -1) {\n        players.splice(i, 1);\n        this.setState({ players });\n      }\n    } else {\n      i = things.indexOf(obj.name);\n      if (i !== -1) {\n        things.splice(i, 1);\n        this.setState({ things });\n      }\n    }\n  }\n\n  sendCommand = cmd => {\n    window.client.sendCommand(cmd);\n  };\n  \n  componentDidMount() {\n    window.client.react.sidebar = this;\n    window.client.sendAPI(\"listcontents\");\n  }\n  \n  componentWillUnMount() {\n    window.client.react.sidebar = null;\n  }\n  \n  render() {\n    const { classes, sidebarWidth, sidebarShowPlayers,\n      sidebarShowThings, sidebarShowExits, sidebarShowCompass } = this.props;\n    const { exits, things, players } = this.state;\n    const customExits = this.customExits;\n    var exitWidget;\n    var navWidget;\n    \n    if (sidebarShowExits) {\n      this.parseExits(exits);\n      \n      if (customExits.length > 0) {\n        exitWidget = (\n          <div className={classes.customExits}>\n            <div className={classes.bottom}>\n              <List dense disablePadding subheader={<ListSubheader component=\"div\">Other Exits</ListSubheader>}>\n                {customExits.map((exit, i) => (\n                  <ListItem className={classes.exitItem} key={i} button onClick={this.go(exit.split(\";\")[0])}>\n                    <ListItemText primary={exit.split(\";\")[0]} />\n                  </ListItem>\n                ))}\n              </List>\n            </div>\n          </div>\n        );\n      }\n      \n      if (this.useCompass) {\n        navWidget = (\n          <div className={classes.navWidget}>\n            <Typography variant=\"subtitle2\" color=\"textSecondary\">Navigation</Typography>\n            {this.buildExit(\"Northwest\")}\n            {this.buildExit(\"North\")}\n            {this.buildExit(\"Northeast\")}\n            {this.buildExit(\"Up\")}\n            <br />\n            {this.buildExit(\"West\")}\n            {this.buildExit(\"In\")}\n            {this.buildExit(\"East\")}\n            {this.buildExit(\"Out\")}\n            <br />\n            {this.buildExit(\"Southwest\")}\n            {this.buildExit(\"South\")}\n            {this.buildExit(\"Southeast\")}\n            {this.buildExit(\"Down\")}\n          </div>\n        );\n      }\n    }\n\n    return (\n      <div className={classes.frame} style={{ width: sidebarWidth }} onClick={() => window.client.focus()}>\n        <div className={classes.contents}>\n          <span>\n            {sidebarShowPlayers && players.length > 0 && (\n              <List dense disablePadding subheader={<ListSubheader component=\"div\">Players</ListSubheader>}>\n                {players.map((player, i) => (\n                  <ListItem disableGutters className={classes.playerItem} key={i}\n                    button onClick={() => this.sendCommand(\"look \"+player)}\n                  >\n                    <ListItemAvatar>\n                      <Avatar>{player.split(\" \").map(p => p[0]).join(\"\")}</Avatar>\n                    </ListItemAvatar>\n                    <ListItemText primary={player} />\n                  </ListItem>\n                ))}\n              </List>\n            )}\n            {sidebarShowThings && things.length > 0 && (\n              <List dense disablePadding subheader={<ListSubheader component=\"div\">Contents</ListSubheader>}>\n                {things.map((thing, i) => (\n                  <ListItem className={classes.thingItem} key={i} button onClick={() => this.sendCommand(\"look \"+thing)}>\n                    <ListItemText primary={thing} />\n                  </ListItem>\n                ))}\n              </List>\n            )}\n          </span>\n        </div>\n        {sidebarShowExits && exitWidget}\n        {sidebarShowExits && sidebarShowCompass && navWidget}\n      </div>\n    );\n  }\n}\n\nSidebar.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  sidebarShowPlayers: PropTypes.bool.isRequired,\n  sidebarShowThings: PropTypes.bool.isRequired,\n  sidebarShowExits: PropTypes.bool.isRequired,\n  sidebarShowCompass: PropTypes.bool.isRequired,\n  sidebarWidth: PropTypes.string.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Sidebar);\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles, MuiThemeProvider } from '@material-ui/core/styles';\nimport Theme from '../Theme';\n\nimport Taskbar from '../Taskbar';\nimport Terminal from '../Terminal';\nimport Input from '../Input';\nimport Statusbar from '../Statusbar';\nimport Login from '../Login';\nimport Sidebar from '../Sidebar';\n\nconst styles = theme => ({\n  frame: {\n    width: \"100%\",\n    height: \"100%\",\n    background: \"white\",\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  top: {\n    top: 0,\n    left: 0,\n    width: \"100%\",\n  },\n  middle: {\n    position: \"relative\",\n    display: \"flex\",\n    \"flex-flow\": \"row nowrap\",\n    flex: 1,\n    left: 0,\n    width: \"100%\",\n  },\n  flex: {\n    flex: 1,\n  },\n  bottom: {\n    bottom: 0,\n    left: 0,\n    width: \"100%\",\n  },\n  dock: {\n    position: \"relative\",\n    height: \"100%\",\n    backgroundColor: theme.palette.background.paper,\n  }\n});\n\nclass Portal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n    \n    this.middle = React.createRef();\n    this.terminal = React.createRef();\n    this.dock = React.createRef();\n  }\n  \n  componentDidMount() {\n    const { sidebarAlwaysShow } = window.client.settings;\n    \n    window.client.react.portal = this;\n    window.scrollTo(0,1);\n    window.client.container = this.middle.current;\n\n    if (sidebarAlwaysShow) {\n      window.client.container = this.terminal.current;\n    } else {\n      window.client.container = this.middle.current;\n    }\n\n  }\n\n  componentWillUnmount() {\n    window.client.react.portal = null;\n  }\n  \n  render() {\n    const { classes } = this.props;\n    const { sidebarOpen, sidebarAnchor, ansiFG, ansiBG, wrapWidth,\n      sidebarAlwaysShow, sidebarShowExits, sidebarShowPlayers,\n      sidebarShowThings, sidebarShowCompass, sidebarWidth } = window.client.settings;\n    \n    var left = sidebarOpen && sidebarAnchor === \"left\";\n    var right = sidebarOpen && sidebarAnchor === \"right\";\n    \n    if (sidebarAlwaysShow) {\n      window.client.container = this.terminal.current;\n    } else {\n      window.client.container = this.middle.current;\n    }\n    \n    var sidebar = (<Sidebar sidebarShowCompass={sidebarShowCompass} sidebarWidth={sidebarWidth} sidebarShowExits={sidebarShowExits} sidebarShowPlayers={sidebarShowPlayers} sidebarShowThings={sidebarShowThings} />);\n\n    return (\n      <MuiThemeProvider theme={Theme}>\n        <div className={classes.frame}>\n          <div className={classes.top}>\n            <Taskbar title=\"MUSH Portal\" />\n          </div>\n          <div className={classes.middle} ref={this.middle}>\n            {left && sidebar}\n            <Terminal width={wrapWidth} ansiFG={ansiFG} ansiBG={ansiBG} containerRef={this.terminal} />\n            {right && sidebar}\n          </div>\n          <div className={classes.bottom}>\n            <Input />\n            <Statusbar />\n          </div>\n          <Login />\n        </div>\n      </MuiThemeProvider>\n    );\n  }\n}\n\nPortal.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Portal);\n\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  frame: {\n  },\n});\n\nclass Chargen extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n  }\n  \n  componentDidMount() {\n  }\n  \n  render() {\n    const { classes } = this.props;\n    return (\n      <div className={classes.frame}>Character Builder?</div>\n    );\n  }\n}\n\nChargen.propTypes = {\n  classes: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(Chargen);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport MailIcon from '@material-ui/icons/Mail';\nimport DraftsIcon from '@material-ui/icons/Drafts';\nimport PriorityHighIcon from '@material-ui/icons/PriorityHigh';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport CancelIcon from '@material-ui/icons/Cancel';\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n  },\n  listicon: {\n    margin: 0,\n  },\n  read: {\n    opacity: 0.5,\n  },\n  odd: {\n    backgroundColor: 'rgba(0, 0, 0, 0.2)',\n  },\n  even: {\n    backgroundColor: 'rgba(0, 0, 0, 0.05)',\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass MailListItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n  }\n  \n  render() {\n    const { classes, mail, onOpen, quickDelete, handleMark, selected, id } = this.props;\n    \n    var icon;\n    if (mail.deleted) {\n      icon = (<DeleteIcon className={mail.unread ? null : classes.read} />);\n    } else if (mail.unread) {\n      if (mail.urgent) {\n        icon = (<PriorityHighIcon />);\n      } else {\n        icon = (<MailIcon />);\n      }\n    } else {\n      icon = (<DraftsIcon className={classes.read} />);\n    }\n    \n    var even = (id % 2 === 0);\n\n    return (\n      <div className={classes.frame}>\n        <ListItem\n          key={mail.id}\n          button\n          dense\n          divider\n          selected={selected}\n          onClick={quickDelete ? () => {} : onOpen}\n          className={even ? classes.even : classes.odd}\n        >\n          <ListItemIcon className={classes.listicon}>\n            {icon}\n          </ListItemIcon>\n          <ListItemText\n            primary={mail.subject}\n            secondary={\n              <span>\n                <span>\n                  {mail.from}\n                </span><br />\n                <span>\n                  {mail.time}\n                </span>\n              </span>\n            }\n          />\n          {quickDelete && (\n            <ListItemSecondaryAction>\n              <IconButton onClick={handleMark}>\n                {mail.deleted ? (\n                  <CheckCircleIcon />\n                ) : (\n                  <CancelIcon />\n                )}\n              </IconButton>\n            </ListItemSecondaryAction>\n          )}\n        </ListItem>\n      </div>\n    );\n  }\n}\n\nMailListItem.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  mail: PropTypes.object.isRequired,\n  quickDelete: PropTypes.bool,\n  onOpen: PropTypes.func,\n  handleMark: PropTypes.func,\n  selected: PropTypes.bool,\n  id: PropTypes.number,\n};\n\nexport default withStyles(styles, { withTheme: true })(MailListItem);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport List from '@material-ui/core/List';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nimport DeleteForeverIcon from '@material-ui/icons/DeleteForever';\nimport DeleteSweepIcon from '@material-ui/icons/DeleteSweep';\nimport CreateIcon from '@material-ui/icons/Create';\n\nimport MailListItem from './MailListItem';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    maxHeight: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  header: {\n  },\n  title: {\n  },\n  overflow: {\n    overflowY: \"auto\",\n    flex: 1,\n  },\n  container: {\n    display: \"inline-flex\",\n    paddingLeft: theme.spacing.unit,\n    \"align-items\": \"center\",\n  },\n  flex: {\n    flex: 1,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass MailList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      quickDelete: false,\n      selected: -1,\n    };\n  }\n\n  purgeMail = () => {\n    window.client.react.mailbox.purgeMail();\n    this.setState({ quickDelete: false });\n  };\n\n  sendMail = () => {\n    window.client.react.mailbox.sendMail(null, \"\", \"\");\n  };\n  \n  toggleDelete = () => {\n    this.setState({ quickDelete: !this.state.quickDelete });\n  };\n  \n  render() {\n    const { classes, openMail, maillist, unread, handleMark } = this.props;\n    const { quickDelete, selected } = this.state;\n    \n    return (\n      <div className={classes.frame}>\n        <div className={classes.header}>\n          <Typography variant=\"subtitle1\" className={classes.title}>\n            <span className={classes.container}>\n              {maillist.length} Messages ({unread} unread)\n              <Tooltip title=\"Move multiple files to trash.\">\n                <IconButton onClick={this.toggleDelete}>\n                  <DeleteSweepIcon />\n                </IconButton>\n              </Tooltip>\n              <Tooltip title=\"Purge deleted mail.\">\n                <IconButton onClick={this.purgeMail}>\n                  <DeleteForeverIcon />\n                </IconButton>\n              </Tooltip>\n              <Tooltip title=\"Send a new message.\">\n                <IconButton onClick={this.sendMail} disabled={quickDelete}>\n                  <CreateIcon />\n                </IconButton>\n              </Tooltip>\n            </span>\n          </Typography>\n        </div>\n        <div className={classes.overflow}>\n          <List\n            dense\n            disablePadding\n          >\n            {maillist.map((mail,i) => (\n              <MailListItem selected={selected === i} id={i} key={i} quickDelete={quickDelete} mail={mail}\n                onOpen={() => {\n                  this.setState({ selected: i });\n                  openMail(i);\n                }}\n                handleMark={() => handleMark(i)}\n              />\n            ))}\n          </List>\n        </div>\n      </div>\n    );\n  }\n}\n\nMailList.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  openMail: PropTypes.func,\n  handleMark: PropTypes.func,\n  maillist: PropTypes.array,\n  unread: PropTypes.number.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(MailList);\n\n","// MU* terminal emulator.\nclass Emulator {\n\n  static get PARSE_PLAIN() { return 0; }\n  static get PARSE_CR() { return 1; }\n  static get PARSE_ESC1() { return 2; }\n  static get PARSE_ESC2() { return 3; }\n\n  static get ANSI_NORMAL() { return 0; }\n  static get ANSI_BRIGHT() { return 1; }\n  static get ANSI_UNDERLINE() { return 4; }\n  static get ANSI_BLINK() { return 5; }\n  static get ANSI_INVERSE() { return 7; }\n  static get ANSI_XTERM_FG() { return 38; }\n  static get ANSI_XTERM_BG() { return 48; }\n\n  static get DEFAULT_FG() { return 37; }\n  static get DEFAULT_BG() { return 30; }\n  \n  static get UNCLOSED_TAGS() { return ['area', 'base', 'br', 'col', 'command', 'embed', 'hr', 'img',\n          'input', 'keygen', 'link', 'menuitem', 'meta', 'param', 'source', 'track', 'wbr']; }\n\n  constructor(root) {\n    this.root = root;\n    this.container = null;\n    \n    this.dims = { };\n    \n    this.calcDimensions();\n    \n    // setup the pueblo xch_cmd callback\n    this.onCommand = null;\n\n    this.clear();\n  }\n\n\n\n  /////////////////////////////////////////////////////\n  // ansi parsing routines\n  \n  static encodeState(state) {\n    if (!state) {\n      return '';\n    }\n\n    var classes = [];\n\n    if (state[Emulator.ANSI_INVERSE]) {\n      var value = state.fg;\n      state.fg = state.bg;\n      state.bg = value;\n      \n      value = state.fg256;\n      state.fg256 = state.bg256;\n      state.bg256 = value;\n    }\n    \n    var fg = state.fg;\n    var bg = state.bg;\n    \n    if (state[Emulator.ANSI_UNDERLINE]) {\n      classes[classes.length] = 'ansi-' + Emulator.ANSI_UNDERLINE;\n    }\n\n    // make sure to avoid conflict with XTERM256 color's usage of blink (code 5)\n    if (state.fg256) {\n      classes[classes.length] = 'ansi-38-5-' + state.fg;\n    } else {  \n      if (state[Emulator.ANSI_BRIGHT]) {\n        if (state[Emulator.ANSI_INVERSE]) {\n          if (fg !== Emulator.DEFAULT_FG) {\n            classes[classes.length] = 'ansi-' + fg;\n          }\n        } else {\n          classes[classes.length] = 'ansi-1-' + fg;\n        }\n      } else if (fg !== Emulator.DEFAULT_FG) {\n        classes[classes.length] = 'ansi-' + fg;\n      }\n    }\n    \n    if (state.bg256) {\n      classes[classes.length] = 'ansi-48-5-' + state.bg;\n    } else {\n      if (state[Emulator.ANSI_BRIGHT]) {\n        if (state[Emulator.ANSI_INVERSE]) {\n          classes[classes.length] = 'ansi-1-' + (bg + 10);\n        } else {\n          if (bg !== Emulator.DEFAULT_BG) {\n            classes[classes.length] = 'ansi-' + (bg + 10);\n          }\n        }\n      } else if (bg !== Emulator.DEFAULT_BG) {\n        classes[classes.length] = 'ansi-' + (bg + 10);\n      }\n    }\n\n    if (state[Emulator.ANSI_BLINK] && !(state.fg256 || state.bg256)) {\n      classes[classes.length] = 'ansi-' + Emulator.ANSI_BLINK;\n    }\n    \n    return classes.join(' ');\n  };\n\n  /////////////////////////////////////////////////////\n  // get the current ansi state, or a default if there is none\n  getANSI() {\n    if (!this.ansiState) {\n      this.ansiState = {\n        fg: Emulator.DEFAULT_FG,\n        bg: Emulator.DEFAULT_BG,\n        fg256: false,\n        bg256: false\n      };\n    }\n\n    return this.ansiState;\n  }\n\n  /////////////////////////////////////////////////////\n  // apply ansi to the current state\n  applyANSI(ansi) {\n    switch (ansi.charCodeAt(ansi.length - 1)) {\n    case 109: // m (SGR)\n      var codes = ansi.substring(0, ansi.length - 1).split(';');\n\n      var value, state;\n      for (var ii = 0; (value = codes[ii]) !== undefined; ++ii) {\n        if (value.length === 0) {\n          // Empty is treated as the equivalent of 0.\n          value = Emulator.ANSI_NORMAL;\n        } else {\n          value = parseInt(value, 10);\n        }\n        \n        state = this.getANSI();\n        \n        // check for xterm256 fg/bg first, fallback to standard codes otherwise\n        if (state[Emulator.ANSI_XTERM_FG] && state[Emulator.ANSI_BLINK]) {\n          if (value >= 0 && value <= 255) {\n            state.fg = value;\n            state.fg256 = true;\n            state[Emulator.ANSI_XTERM_FG] = false;\n            state[Emulator.ANSI_BLINK] = false;\n          } else {\n            // invalid xterm256, let's reset the ansi state due to bad codes\n            this.ansiState = null;\n          }\n        } else if (state[Emulator.ANSI_XTERM_BG] && state[Emulator.ANSI_BLINK]) {\n          if (value >= 0 && value <= 255) {\n            state.bg = value;\n            state.bg256 = true;\n            state[Emulator.ANSI_XTERM_BG] = false;\n            state[Emulator.ANSI_BLINK] = false;\n          } else {\n            // invalid xterm256, let's reset the ansi state due to bad codes\n            this.ansiState = null;\n          }\n        } else {\n          // detect regular ansi codes\n          switch (value) {\n          case Emulator.ANSI_NORMAL: // reset\n            this.ansiState = null;\n            break;\n\n          case Emulator.ANSI_BRIGHT:\n          case Emulator.ANSI_UNDERLINE:\n          case Emulator.ANSI_BLINK:\n          case Emulator.ANSI_INVERSE:\n          case Emulator.ANSI_XTERM_FG:\n          case Emulator.ANSI_XTERM_BG:\n            state[value] = true;\n            break;\n\n          default:\n            if (30 <= value && value <= 37) {\n              state.fg = value;\n            } else if (40 <= value && value <= 47) {\n              state.bg = value - 10;\n            }\n           break;\n          }\n        }\n\n        this.ansiDirty = true;\n      }\n      break;\n    default:\n      break;\n    }\n  }\n\n  /////////////////////////////////////////////////////\n  // write a string to be emulated\n  write(value, start, end) {\n    if (start === end) {\n      return;\n    }\n\n    if (this.ansiDirty) {\n      var next = Emulator.encodeState(this.ansiState);\n\n      if (this.ansiClass !== next) {\n        this.ansiClass = next;\n        this.span = null;\n      }\n\n      this.ansiDirty = false;\n    }\n\n    if (this.ansiClass && !this.span) {\n      this.span = document.createElement('span');\n      this.span.className = this.ansiClass;\n      this.stack[this.stack.length - 1].appendChild(this.span);\n    }\n\n    var text = document.createTextNode(value.substring(start, end));\n    this.lineBuf[this.lineBuf.length] = text;\n\n    this.appendChild(text);\n  }\n\n  /////////////////////////////////////////////////////\n  // end of line\n  endLine() {\n    var that = this;\n    this.onLine && this.onLine(that, this.lineBuf);\n\n    this.write('\\n', 0, 1);\n    this.lineBuf.length = 0;\n  }\n\n  /////////////////////////////////////////////////////\n  // handle end of escape code\n  abortParse(value, start, end) {\n    switch (this.state) {\n    case Emulator.PARSE_PLAIN:\n      this.write(value, start, end);\n      break;\n\n    case Emulator.PARSE_ESC1:\n      this.write('\\u001B', 0, 1);\n      break;\n\n    case Emulator.PARSE_ESC2:\n      this.write('\\u001B[', 0, 2);\n      this.write(this.parseBuf, 0, this.parseBuf.length);\n      this.parseBuf = '';\n      break;\n    default:\n      break;\n    }\n  }\n\n  /////////////////////////////////////////////////////\n  // appends a text string to the terminal, parsing ansi escape codes into html/css\n  appendText(data) {\n    var start = 0;\n\n    // Scan for sequence start characters.\n    // TODO: Could scan with RegExp; not convinced sufficiently simpler/faster.\n    for (var ii = 0, ilen = data.length; ii < ilen; ++ii) {\n      var ch = data.charCodeAt(ii);\n\n      // Resynchronize at special characters.\n      switch (ch) {\n      case 10: // newline\n        if (this.state !== Emulator.PARSE_CR) {\n          this.abortParse(data, start, ii);\n          this.endLine();\n        }\n\n        start = ii + 1;\n        this.state = Emulator.PARSE_PLAIN;\n        continue;\n\n      case 13: // carriage return\n        this.abortParse(data, start, ii);\n        this.endLine();\n        start = ii + 1;\n        this.state = Emulator.PARSE_CR;\n        continue;\n\n      case 27: // escape\n        this.abortParse(data, start, ii);\n        start = ii + 1;\n        this.state = Emulator.PARSE_ESC1;\n        continue;\n      \n      default:\n        break;\n      }\n\n      // Parse other characters.\n      switch (this.state) {\n      case Emulator.PARSE_CR:\n        this.state = Emulator.PARSE_PLAIN;\n        break;\n\n      case Emulator.PARSE_ESC1:\n        if (ch === 91) {\n          // Start of escape sequence (\\e[).\n          start = ii + 1;\n          this.state = Emulator.PARSE_ESC2;\n        } else {\n          // Not an escape sequence.\n          this.abortParse(data, start, ii);\n          start = ii;\n          this.state = Emulator.PARSE_PLAIN;\n        }\n        break;\n\n      case Emulator.PARSE_ESC2:\n        if (64 <= ch && ch <= 126) {\n          // End of escape sequence.\n          this.parseBuf += data.substring(start, (start = ii + 1));\n          this.applyANSI(this.parseBuf);\n          this.parseBuf = '';\n          this.state = Emulator.PARSE_PLAIN;\n        }\n        break;\n        \n      default:\n        break;\n      }\n    }\n\n    // Handle tail.\n    switch (this.state) {\n    case Emulator.PARSE_PLAIN:\n      this.write(data, start, data.length);\n      break;\n\n    case Emulator.PARSE_ESC2:\n      this.parseBuf += data.substring(start);\n      break;\n      \n    default:\n      break;\n    }\n  }\n\n  /////////////////////////////////////////////////////\n  // append HTML code fragment\n  appendHTML(html) {\n    var div = document.createElement('div');\n    var fragment = document.createDocumentFragment();\n\n    div.innerHTML = html;\n\n    // append child elements\n    for (var child = div.firstChild; child; child = child.nextSibling) {\n      // check for xch_cmd and replace with click handler\n      var cmd = child.getAttribute('xch_cmd');\n      if (cmd !== null && cmd !== '') {\n        child.setAttribute('onclick', 'this.onCommand(\"' + cmd + '\");');\n        child.onCommand = this.onCommand;\n        child.removeAttribute('xch_cmd');\n      }\n      fragment.appendChild(child);\n    }\n\n    this.appendChild(fragment);\n  }\n\n  /////////////////////////////////////////////////////\n  // append DOM element\n  appendChild(child) {\n    var last = (this.span || this.stack[this.stack.length - 1]);\n    last.appendChild(child);\n  }\n  \n  /////////////////////////////////////////////////////\n  // append a log message to the terminal\n  appendMessage(classid, message) {\n    var div = document.createElement('div');\n    div.className = classid;\n    \n    // create a text node to safely append the string without rendering code\n    var text = document.createTextNode(message);\n    div.appendChild(text);\n    \n    this.appendChild(div);\n  }\n  \n  /////////////////////////////////////////////////////\n  // push a new html element onto the stack\n  pushElement(element) {\n    this.span = null;\n    this.stack[this.stack.length - 1].appendChild(element);\n    this.stack[this.stack.length] = element;\n  }\n\n  /////////////////////////////////////////////////////\n  // remove 1 level from the stack, check consistency \n  popElement() {\n    this.span = null;\n\n    if (this.stack.length > 1) {\n      --this.stack.length;\n    } else {\n      window.console && window.console.warn('element stack underflow');\n    }\n  }\n\n  /////////////////////////////////////////////////////\n  // append a pueblo tag to the terminal stack (or pop if an end tag)\n  appendPueblo(data) {\n    var tag, attrs;\n\n    var idx = data.indexOf(' ');\n    if (idx !== -1) {\n      tag = data.substring(0, idx);\n      attrs = data.substring(idx + 1);\n    } else {\n      tag = data;\n      attrs = '';\n    }\n    \n    var html = '<' + tag + (attrs ? ' ' : '') + attrs + '>';\n\n    var start;\n    if (tag[0] !== '/') {\n      start = true;\n    } else {\n      start = false;\n      tag = tag.substring(1);\n    }\n    \n    // detect a self closed tag\n    var selfClosing = false;\n    if ((tag.substring(-1) === '/') || (attrs.substring(-1) === '/')) {\n      selfClosing = true;\n    }\n    \n    if (Emulator.UNCLOSED_TAGS.indexOf(tag.toLowerCase()) > -1) {\n      selfClosing = true;\n    }\n\n    if ((tag === 'XCH_PAGE') || \n        ((tag === 'IMG') && (attrs.search(/xch_graph=((\"[^\"]*\")|('[^']*')|([^\\s]*))/i) !== -1))) {\n      //console.log(\"unhandled pueblo\", html);\n      return;\n    }\n\n    // we have a starting <tag> (not </tag>)\n    if (start) {\n      var div = document.createElement('div');\n\n      html = html.replace(\n        /xch_graph=((\"[^\"]*\")|('[^']*')|([^\\s]*))/i,\n        ''\n      );\n\n      html = html.replace(\n        /xch_mode=((\"[^\"]*\")|('[^']*')|([^\\s]*))/i,\n        ''\n      );\n\n      html = html.replace(\n        /xch_hint=\"([^\"]*)\"/i,\n        'title=\"$1\"'\n      );\n\n      div.innerHTML = html.replace(\n        /xch_cmd=\"([^\"]*)\"/i,\n        \"onclick='this.onCommand(&quot;$1&quot;)'\"\n      );\n      \n      div.firstChild.onCommand = this.onCommand;\n\n      div.setAttribute('target', '_blank');\n      \n      // add this tag to the stack to keep track of nested elements\n      this.pushElement(div.firstChild);\n\n      // automatically pop the tag if it is self closing\n      if (selfClosing) {\n        this.popElement();\n      }\n\n    } else {\n      // we have an ending </tag> so remove the closed tag from the stack\n      // don't bother for self closing tags with an explicit end tag, we already popped them\n      if (!selfClosing) {\n        this.popElement();\n      }\n    }\n  }\n  \n  /////////////////////////////////////////////////////\n  // clear the output and current ansi state\n  clear() {\n    if (this.root === null) {\n      return null;\n    }\n\n    this.root.innerHTML = '';\n\n    this.stack = [this.root];\n\n    this.state = Emulator.PARSE_PLAIN;\n    this.line = null;\n    this.lineBuf = [];\n    this.span = null;\n    this.parseBuf = '';\n\n    this.ansiClass = '';\n    this.ansiState = null;\n    this.ansiDirty = false;\n  }\n  \n  // are we already scrolled down to the bottom?\n  nearBottom(threshold) {\n    var root = this.root;\n    \n    if (!root) {\n      return false;\n    }\n    \n    if (this.linesOfScroll() <= threshold) {\n      return true;\n    }\n    \n    return false;\n  }\n  \n  // calculate the width and height in characters\n  calcDimensions() {\n    var element = this.root;\n    if (!element) {\n      return 0.0;\n    }\n    \n    var txt = \"0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789\";\n    \n    var temp = document.createElement(element.nodeName);\n    temp.setAttribute(\"style\",\"margin:0px;padding:0px;font-family:\"+element.style.fontFamily+\";font-size:\"+element.style.fontSize);\n    temp.innerText = txt;\n    temp = element.appendChild(temp);\n    this.dims.width = temp.clientWidth / 100.0;\n    this.dims.height = temp.clientHeight;\n    temp.parentNode.removeChild(temp);\n    \n    return this.dims;\n  }\n  \n  // return the number of lines of text below the current viewport\n  linesOfScroll() {\n    var root = this.container || this.root;\n    if (!root) {\n      return 0.0;\n    }\n    \n    if (this.dims.height <= 0.0) {\n      return 0.0;\n    }\n    \n    return Math.round(Math.abs((root.scrollHeight - root.offsetHeight - root.scrollTop) / this.dims.height));\n  }\n\n  //////////////////////////////////////////////////////\n  // scroll one page up\n  scrollPageUp() {\n    var root = this.container || this.root;\n    root.scrollTop -= root.clientHeight - this.dims.height*5;\n  }\n\n  //////////////////////////////////////////////////////\n  // scroll one page down\n  scrollPageDown() {\n    var root = this.container || this.root;\n    root.scrollTop += root.clientHeight - this.dims.height*4;\n  }  \n\n  //////////////////////////////////////////////////////\n  // animate scrolling the terminal window to the bottom\n  scrollDown() {\n    var root = this.container || this.root;\n\n    if (!root) {\n      return;\n    }\n\n    root.scrollTop = root.scrollHeight;\n    return;\n/*    \n    // animated scrolling alternative\n    var scrollCount = 0;\n    var scrollDuration = 500.0;\n    var oldTimestamp = performance.now();\n    \n    var step = (newTimestamp) => {\n      var bottom = root.scrollHeight - root.clientHeight;\n      var delta = (bottom - root.scrollTop) / 2.0;\n\n      scrollCount += Math.PI / (scrollDuration / (newTimestamp - oldTimestamp));\n      if (scrollCount >= Math.PI) root.scrollTo(0, bottom);\n      if (root.scrollTop === bottom) { return; }\n      root.scrollTo(0, Math.round(root.scrollTop + delta));\n      oldTimestamp = newTimestamp;\n      window.requestAnimationFrame(step);\n    };\n    \n    window.requestAnimationFrame(step);\n*/\n  }\n\n  \n}\n\nexport default Emulator;\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Card from '@material-ui/core/Card';\nimport CardHeader from '@material-ui/core/CardHeader';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardActions from '@material-ui/core/CardActions';\n//import Typography from '@material-ui/core/Typography';\nimport Icon from '@material-ui/core/Icon';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport ReplyIcon from '@material-ui/icons/Reply';\nimport ForwardIcon from '@material-ui/icons/Forward';\n\nimport Emulator from '../../client/emulator';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  card: {\n    height: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  header: {\n    display: \"flex\",\n    \"flex-flow\": \"row nowrap\",\n  },\n  sub: {\n    display: \"flex\",\n  },\n  left: {\n    flex: 1,\n  },\n  right: {\n    marginLeft: \"3em\",\n  },\n  body: {\n    flex: 1,\n    display: \"flex\",\n  },\n  actions: {\n    \"justify-content\": \"space-evenly\",\n  },\n  button: {\n    display: \"block\",\n  },\n  wrap: {\n    \"font-family\": \"'Courier New', monospace\",\n    \"font-weight\": \"normal\",\n    \"font-size\": \"10pt\",\n    width: \"100%\",\n    flex: 1,\n    \"overflow-y\": \"auto\",\n    \"overflow-x\": \"hidden\",\n    \"white-space\": \"pre-wrap\",\n    \"word-wrap\": \"break-word\",\n    padding: \"0.25em 0.5em\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass MailItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      anchorEl: null,\n    };\n\n    this.body = React.createRef();\n    this.emulator = null;\n  }\n  \n  componentDidMount() {\n    const { mail } = this.props;\n    this.emulator = new Emulator(this.body.current);\n    this.emulator.appendText(mail.body);\n  }\n  \n  showMenu = event => {\n    this.setState({ anchorEl: event.currentTarget });\n  };\n  \n  closeMenu = () => {\n    this.setState({ anchorEl: null });\n  };\n  \n  markUnread = () => {\n    window.client.react.mailbox.markUnread();\n    this.closeMenu();\n  };\n  \n  markDeleted = () => {\n    window.client.react.mailbox.markDeleted();\n    this.closeMenu();\n  };\n  \n  markUndeleted = () => {\n    window.client.react.mailbox.markUndeleted();\n    this.closeMenu();\n  };\n  \n  replyMail = () => {\n    const { mail } = this.props;\n    window.client.react.mailbox.sendMail(mail.from, \"Re: \"+mail.subject, \"\");\n  };\n  \n  forwardMail = () => {\n    const { mail } = this.props;\n    window.client.react.mailbox.sendMail(\"\", \"Fwd: \"+mail.subject, mail.body);\n  };\n  \n  render() {\n    const { classes, mail } = this.props;\n    const { anchorEl } = this.state;\n    const { ansiFG, ansiBG } = window.client.settings;    \n\n    this.emulator && this.emulator.clear();\n    this.emulator && this.emulator.appendText(mail.body);\n    \n    return (\n      <Card className={classes.card}>\n        <CardHeader className={classes.header}\n          title={mail.subject}\n          subheader={\n            <span className={classes.sub}>\n              <span className={classes.left}>\n                {mail.from}\n              </span>\n              <span className={classes.right}>\n                {mail.time}\n              </span>\n            </span>\n          }\n        />\n        <CardContent className={classes.body}>\n          <div ref={this.body} className={classNames(classes.wrap, ansiFG, ansiBG)}></div>\n        </CardContent>\n        <CardActions className={classes.actions}>\n          <Button className={classes.button} onClick={this.replyMail}>\n            <Icon>\n              <ReplyIcon />\n            </Icon>\n            Reply\n          </Button>\n          <Button className={classes.button} onClick={this.forwardMail}>\n            <Icon>\n              <ForwardIcon />\n            </Icon>\n            Forward\n          </Button>\n          <IconButton aria-owns={anchorEl ? 'mailitem.menu' : null} aria-haspopup=\"true\" onClick={this.showMenu}>\n            <MoreVertIcon />\n          </IconButton>\n          <Menu id=\"mailitem.menu\" anchorEl={anchorEl} open={Boolean(anchorEl)} onClose={this.closeMenu}>\n            <MenuItem onClick={this.markUnread}>Mark as Unread</MenuItem>\n            {mail.deleted ? (\n              <MenuItem onClick={this.markUndeleted}>Restore Message</MenuItem>\n            ) : (\n              <MenuItem onClick={this.markDeleted}>Move to Trash</MenuItem>\n            )}\n          </Menu>\n        </CardActions>\n      </Card>\n    );\n  }\n}\n\nMailItem.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  mail: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(MailItem);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport MailList from './MailList';\nimport MailItem from './MailItem';\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    position: \"absolute\",\n    height: \"100%\",\n    width: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"row nowrap\",\n  },\n  left: {\n    position: \"relative\",\n    maxHeight: \"100%\",\n  },\n  right: {\n    flex: 1,\n    maxHeight: \"100%\",\n    position: \"relative\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Mailbox extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mailitem: null,\n      unreadMail: props.unread ? props.unread : 0,\n      folder: props.folder ? props.folder : 0,\n      folderlist: [{ id: 0, name: \"Inbox\" }],\n      maillist: props.maillist ? props.maillist : [ ],\n    };\n  }\n  \n  openMail = (message) => {\n    const { maillist, unreadMail } = this.state;\n    const mail = maillist[message];\n    \n    if (mail.unread) {\n      mail.unread = false;\n      this.setState({ maillist, unreadMail: unreadMail-1 });\n      window.client.sendText(\"@mail/status \"+mail.id+\"=read\");\n    }\n    \n    window.client.sendAPI(\"mailitem\", mail.id);\n  }\n  \n  handleMark = (message) => {\n    const { maillist } = this.state;\n    const mail = maillist[message];\n    \n    mail.deleted = !mail.deleted;\n    \n    if (mail.deleted) {\n      window.client.sendText(\"@mail/clear \"+mail.id);\n    } else {\n      window.client.sendText(\"@mail/unclear \"+mail.id);\n    }\n    \n    this.setState({ maillist });\n  }\n  \n  setUnreadMail(unreadMail) {\n    this.setState({ unreadMail })\n    window.client.react.taskbar.setUnreadMail(unreadMail);\n  }\n\n  markDeleted() {\n    const { maillist, mailitem } = this.state;\n    \n    if (mailitem.deleted) {\n      return;\n    }\n    \n    mailitem.deleted = true;\n    maillist[mailitem.key].deleted = true;\n    window.client.sendText(\"@mail/clear \"+mailitem.id);\n    this.setState({ maillist, mailitem });\n  }\n\n  markUndeleted() {\n    const { maillist, mailitem } = this.state;\n    \n    if (!mailitem.deleted) {\n      return;\n    }\n    \n    mailitem.deleted = false;\n    maillist[mailitem.key].deleted = false;\n    window.client.sendText(\"@mail/unclear \"+mailitem.id);\n    this.setState({ maillist, mailitem });\n  }\n\n  markUnread() {\n    const { maillist, mailitem, unreadMail } = this.state;\n    \n    if (mailitem.unread) {\n      return;\n    }\n    \n    mailitem.unread = true;\n    maillist[mailitem.key].unread = true;\n    window.client.sendText(\"@mail/status \"+mailitem.id+\"=unread\");\n    this.setState({ maillist, mailitem, unreadMail: unreadMail+1 });\n  }\n\n  purgeMail() {\n    if (window.confirm(\"Do you want to purge deleted mail?\")) {\n      const { maillist, mailitem } = this.state;\n\n      if (mailitem && maillist[mailitem.key].deleted) {\n        // we are purging the current mailitem, so clear it\n        this.setState({ mailitem: null });\n      }\n      window.client.sendText(\"@mail/purge\");\n      window.client.sendAPI(\"maillist\");\n    }\n  }\n  \n  sendMail(to, subject, body) {\n    if (window.client.react.sendmail) {\n      window.client.focusPanel(\"Sendmail\");\n      if (window.confirm(\"Replace current draft with new mail?\")) {\n        window.client.react.sendmail.setFields(to, subject, body);\n      }\n    } else {\n      window.client.addReactPanel(\"Sendmail\", { panelSize: \"30em 30em\" });\n      window.client.react.sendmail.setFields(to, subject, body);\n    }  \n  }\n\n  componentDidMount() {\n    window.client.react.mailbox = this;\n  }\n  \n  componentWillUnmount() {\n    window.client.react.mailbox = null;\n  }\n  \n  updateMailList(folder, maillist, unreadMail) {\n    this.setState({ folder, maillist, unreadMail });\n  }\n  \n  updateFolderList(folderlist) {\n    this.setState({ folderlist });\n  }\n  \n  openMailItem(mailitem) {\n    const { maillist } = this.state;\n    maillist.forEach((mail,i) => {\n      if (mail.id === mailitem.id) {\n        mailitem.key = i;\n      }\n    });\n    this.setState({ mailitem });\n  }\n\n  render() {\n    const { classes } = this.props;\n    const { maillist, mailitem, unreadMail } = this.state;\n\n    return (\n      <div className={classes.frame}>\n        <div className={classes.left}>\n          { maillist && (\n            <MailList maillist={maillist} unread={unreadMail} openMail={this.openMail} handleMark={this.handleMark} />\n          )}\n        </div>\n        <div className={classes.right}>\n          { mailitem && (\n            <MailItem mail={mailitem} />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nMailbox.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  folder: PropTypes.number,\n  maillist: PropTypes.array,\n  mailitem: PropTypes.object,\n  unread: PropTypes.number,\n};\n\nexport default withStyles(styles, { withTheme: true })(Mailbox);\n\n\t","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Card from '@material-ui/core/Card';\nimport CardHeader from '@material-ui/core/CardHeader';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardActions from '@material-ui/core/CardActions';\nimport Icon from '@material-ui/core/Icon';\nimport Button from '@material-ui/core/Button';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport TextField from '@material-ui/core/TextField';\n\nimport SendIcon from '@material-ui/icons/Send';\nimport CancelIcon from '@material-ui/icons/Cancel';\n\nimport ChipInput from 'material-ui-chip-input';\n\nimport AceEditor from 'react-ace';\nimport 'brace/mode/mushcode';\nimport 'brace/theme/tomorrow_night_bright';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  card: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  header: {\n    display: \"flex\",\n    \"flex-flow\": \"row nowrap\",\n  },\n  sub: {\n    display: \"flex\",\n  },\n  left: {\n    flex: 1,\n  },\n  right: {\n    marginLeft: \"3em\",\n  },\n  stretch: {\n    width: \"100%\",\n  },\n  body: {\n    position: \"relative\",\n    flex: 1,\n    display: \"flex\",\n    overflow: \"hidden\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  bodytext: {\n    flex: 1,\n  },\n  actions: {\n    \"justify-content\": \"space-evenly\",\n  },\n  button: {\n    display: \"block\",\n  },\n  helperText: {\n    textAlign: 'right',\n    width: '100%',\n  },\n  nameInput: {\n    minWidth: \"10em\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Sendmail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      subject: props.subject ? props.subject : \"\",\n      body: props.body ? props.body : \"\",\n      error: null,\n      chips: []\n    };\n    \n    this.editor = React.createRef();\n  }\n\n  setTarget(to) {\n    this.addChip(to);\n  }\n  \n  setSubject(subject) {\n    this.setState({ subject });\n  }\n  \n  setBody(body) {\n    this.setState({ body });\n  }\n\n  setFields(to, subject, body) {\n    to && this.addChip(to);\n    this.setState({ subject, body });\n  }\n  \n  sendMail = () => {\n    const { chips, subject, body } = this.state;\n    var realsub = subject;\n    \n    if (chips.length < 1) {\n      alert(\"Invalid recipients.\");\n      return;\n    }\n    \n    if (!body || body === \"\") {\n      alert(\"Empty message.\");\n      return;\n    }\n    \n    if (!subject || subject === \"\") {\n      if (body.length > 20) {\n        realsub = body.substr(0,20)+\"...\";\n      } else {\n        realsub = body;\n      }\n    }\n    \n    var to = '\"'+chips.join('\" \"')+'\"';\n    window.client.sendCommand(\"@mail \"+to+\"=\"+realsub+\"/\"+body.split('\\n').join('%r'));\n    this.closePanel();\n  };\n  \n  closePanel = () => {\n    window.client.closePanel(\"Sendmail\");\n  };\n  \n  componentDidMount() {\n    window.client.react.sendmail = this;\n    \n    const { panel, to } = this.props;\n    panel.options.resizeit.resize = this.onResize;\n    window.client.panels.resizeit(panel, panel.options.resizeit);\n    \n    to && this.addChip(to);\n  }\n  \n  componentWillUnmount() {\n    window.client.react.sendmail = null;\n  }\n  \n  handleChange = name => event => {\n    this.setState({\n      [name]: event.target.value,\n    });\n  };\n\n  changeText = body => {\n    this.setState({ body });\n  };\n  \n  onResize = () => {\n    this.editor.current.editor.resize();\n  };\n  \n  setError = error => {\n    this.setState({ error });\n//    setTimeout(() => { this.setState({ error: null }); }, 1000);\n  };\n  \n  onInput = () => {\n    this.setError(null);\n  };\n  \n  addChip = chip => {\n    const { chips } = this.state;\n    var str = chip.replace(/(?<!\\\\)\\\\/g, '').replace(/(?<!\\\\)\"/g, '');\n    window.client.execString('if(setr(0,namelist(\"'+str+'\")),name(%q0))', (result) => {\n      if (result !== \"\") {\n        if (chips.indexOf(result) === -1) {\n          chips.push(result);\n          this.setState({ chips });\n        }\n        this.setError(null);\n      } else {\n        this.setError(\"Unknown player.\");\n      }\n    });\n\n  };\n  \n  delChip = (chip, i) => {\n    const { chips } = this.state;\n    chips.splice(i, 1);\n    this.setState({ chips });\n    this.setError(null);\n  };\n  \n  beforeAdd = (chip) => {\n    if ((chip.startsWith('\"') && !chip.endsWith('\"')) || \n        (chip.startsWith(\"'\") && !chip.endsWith(\"'\")) || chip.endsWith('\\\\')) {\n      return false;\n    }\n    \n    \n    \n    return true;\n  };\n  \n  render() {\n    const { classes } = this.props;\n    const { chips, subject, body, error } = this.state;\n    \n    return (\n      <Card className={classes.card}>\n        <CardHeader className={classes.header}\n          title={(\n            <ChipInput label=\"Recipients\" fullWidth value={chips} blurBehavior=\"add\" onUpdateInput={this.onInput}\n              newChipKeyCodes={[13,32,187]} onBeforeAdd={this.beforeAdd} onAdd={this.addChip} classes={{ input: classes.nameInput }}\n              onDelete={this.delChip} helperText={error} FormHelperTextProps={{ error: true, className: classes.helperText }}\n            />\n          )}\n          subheader={(\n            <TextField label=\"Subject\" value={subject} onChange={this.handleChange(\"subject\")} className={classes.stretch} />\n          )}\n        />\n        <CardContent className={classes.body}>\n          <AceEditor\n            className={classes.bodytext}\n            ref={this.editor}\n            mode=\"mushcode\"\n            width=\"100%\"\n            theme=\"tomorrow_night_bright\"\n            value={body}\n            onChange={this.changeText}\n            wrapEnabled={true}\n            highlightActiveLine={false}\n            editorProps={{ $blockScrolling: Infinity }}\n          />\n        </CardContent>\n        <CardActions className={classes.actions}>\n          <Tooltip title=\"Send draft.\">\n            <Button fullWidth className={classes.button} onClick={this.sendMail}>\n              <Icon>\n                <SendIcon />\n              </Icon>\n            </Button>\n          </Tooltip>\n          <Tooltip title=\"Discard draft.\">\n            <Button fullWidth className={classes.button} onClick={this.closePanel}>\n              <Icon>\n                <CancelIcon />\n              </Icon>\n            </Button>\n          </Tooltip>\n        </CardActions>\n      </Card>\n    );\n  }\n}\n\nSendmail.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  to: PropTypes.string,\n  subject: PropTypes.string,\n  body: PropTypes.string,\n  panel: PropTypes.object,\n};\n\nexport default withStyles(styles, { withTheme: true })(Sendmail);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport ListItem from '@material-ui/core/ListItem';\n//import ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\n\n//import IconButton from '@material-ui/core/IconButton';\n\n//import MailIcon from '@material-ui/icons/Mail';\n//import DraftsIcon from '@material-ui/icons/Drafts';\n//import PriorityHighIcon from '@material-ui/icons/PriorityHigh';\n//import DeleteIcon from '@material-ui/icons/Delete';\n//import CheckCircleIcon from '@material-ui/icons/CheckCircle';\n//import CancelIcon from '@material-ui/icons/Cancel';\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n  },\n  listicon: {\n    margin: 0,\n  },\n  read: {\n    opacity: 0.5,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass BBListItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n  }\n  \n  render() {\n    const { classes, board, onOpen } = this.props;\n    \n    return (\n      <div className={classes.frame}>\n        <ListItem\n          key={board.id}\n          button\n          dense\n          divider\n          onClick={onOpen}\n        >\n          <ListItemText\n            primary={board.name}\n            secondary={\n              <span>\n                <span>\n                  {board.posts} Posts\n                </span><br />\n                <span>\n                  {board.lastmod}\n                </span>\n              </span>\n            }\n          />\n        </ListItem>\n      </div>\n    );\n  }\n}\n\nBBListItem.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  board: PropTypes.object.isRequired,\n  onOpen: PropTypes.func.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(BBListItem);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport List from '@material-ui/core/List';\nimport Typography from '@material-ui/core/Typography';\n\n//import IconButton from '@material-ui/core/IconButton';\n//import Tooltip from '@material-ui/core/Tooltip';\n\n//import DeleteForeverIcon from '@material-ui/icons/DeleteForever';\n//import DeleteSweepIcon from '@material-ui/icons/DeleteSweep';\n//import CreateIcon from '@material-ui/icons/Create';\n\nimport BBListItem from './BBListItem';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    maxHeight: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  header: {\n  },\n  title: {\n  },\n  overflow: {\n    overflowY: \"auto\",\n    flex: 1,\n  },\n  container: {\n    display: \"flex\",\n    paddingLeft: \"2em\",\n  },\n  flex: {\n    flex: 1,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass BBList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n  }\n\n  render() {\n    const { classes, openBoard, boardlist } = this.props;\n    \n    return (\n      <div className={classes.frame}>\n        <div className={classes.header}>\n          <Typography variant=\"subtitle1\" className={classes.title}>\n            <span className={classes.container}>\n              {boardlist.length} Bulletin Boards\n              <span className={classes.flex} />\n            </span>\n          </Typography>\n        </div>\n        <div className={classes.overflow}>\n          <List\n            dense\n            disablePadding\n          >\n            {boardlist.map((board,i) => (\n              <BBListItem key={i} board={board} onOpen={() => openBoard(i)} />\n            ))}\n          </List>\n        </div>\n      </div>\n    );\n  }\n}\n\nBBList.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  openBoard: PropTypes.func.isRequired,\n  boardlist: PropTypes.array.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(BBList);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport ListItem from '@material-ui/core/ListItem';\n//import ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\n\n//import IconButton from '@material-ui/core/IconButton';\n\n//import MailIcon from '@material-ui/icons/Mail';\n//import DraftsIcon from '@material-ui/icons/Drafts';\n//import PriorityHighIcon from '@material-ui/icons/PriorityHigh';\n//import DeleteIcon from '@material-ui/icons/Delete';\n//import CheckCircleIcon from '@material-ui/icons/CheckCircle';\n//import CancelIcon from '@material-ui/icons/Cancel';\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n  },\n  listicon: {\n    margin: 0,\n  },\n  read: {\n    opacity: 0.5,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass BBMessageListItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n  }\n  \n  render() {\n    const { classes, message, onOpen } = this.props;\n    \n    return (\n      <div className={classes.frame}>\n        <ListItem\n          key={message.id}\n          button\n          dense\n          divider\n          onClick={onOpen}\n        >\n          <ListItemText\n            primary={message.subject}\n            secondary={\n              <span>\n                <span>\n                  {message.author}\n                </span><br />\n                <span>\n                  {message.date}\n                </span>\n              </span>\n            }\n          />\n        </ListItem>\n      </div>\n    );\n  }\n}\n\nBBMessageListItem.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  message: PropTypes.object.isRequired,\n  onOpen: PropTypes.func.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(BBMessageListItem);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport List from '@material-ui/core/List';\nimport Typography from '@material-ui/core/Typography';\n\n//import IconButton from '@material-ui/core/IconButton';\n//import Tooltip from '@material-ui/core/Tooltip';\n\n//import DeleteForeverIcon from '@material-ui/icons/DeleteForever';\n//import DeleteSweepIcon from '@material-ui/icons/DeleteSweep';\n//import CreateIcon from '@material-ui/icons/Create';\n\nimport BBMessageListItem from './BBMessageListItem';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    maxHeight: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  header: {\n  },\n  title: {\n  },\n  overflow: {\n    overflowY: \"auto\",\n    flex: 1,\n  },\n  container: {\n    display: \"flex\",\n    paddingLeft: \"2em\",\n  },\n  flex: {\n    flex: 1,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass BBMessageList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n  }\n\n  render() {\n    const { classes, openMessage, board } = this.props;\n    \n    return (\n      <div className={classes.frame}>\n        <div className={classes.header}>\n          <Typography variant=\"subtitle1\" className={classes.title}>\n            <span className={classes.container}>\n              {board.messages.length} Posts\n              <span className={classes.flex} />\n            </span>\n          </Typography>\n        </div>\n        <div className={classes.overflow}>\n          <List\n            dense\n            disablePadding\n          >\n            {board.messages.map((msg,i) => (\n              <BBMessageListItem key={i} message={msg} onOpen={() => openMessage(i)} />\n            ))}\n          </List>\n        </div>\n      </div>\n    );\n  }\n}\n\nBBMessageList.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  openMessage: PropTypes.func.isRequired,\n  board: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(BBMessageList);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Card from '@material-ui/core/Card';\nimport CardHeader from '@material-ui/core/CardHeader';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardActions from '@material-ui/core/CardActions';\n//import Typography from '@material-ui/core/Typography';\n\n//import Icon from '@material-ui/core/Icon';\n//import Button from '@material-ui/core/Button';\n//import IconButton from '@material-ui/core/IconButton';\n\n//import Menu from '@material-ui/core/Menu';\n//import MenuItem from '@material-ui/core/MenuItem';\n\n//import MoreVertIcon from '@material-ui/icons/MoreVert';\n//import ReplyIcon from '@material-ui/icons/Reply';\n//import ForwardIcon from '@material-ui/icons/Forward';\n\nimport Emulator from '../../client/emulator';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  card: {\n    height: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  header: {\n    display: \"flex\",\n    \"flex-flow\": \"row nowrap\",\n  },\n  sub: {\n    display: \"flex\",\n  },\n  left: {\n    flex: 1,\n  },\n  right: {\n    marginLeft: \"3em\",\n  },\n  body: {\n    flex: 1,\n    \"overflow-y\": \"auto\",\n    \"overflow-x\": \"hidden\",\n  },\n  actions: {\n    \"justify-content\": \"space-evenly\",\n  },\n  button: {\n    display: \"block\",\n  },\n  output: {\n    \"font-family\": \"'Courier New', monospace\",\n    \"font-weight\": \"normal\",\n    \"font-size\": \"10pt\",\n    width: \"100%\",\n    height: \"100%\",\n    \"overflow-y\": \"scroll\",\n    \"overflow-x\": \"hidden\",\n    \"white-space\": \"pre-wrap\",\n    \"word-wrap\": \"break-word\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass BBMessage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { };\n    this.body = React.createRef();\n    this.emulator = null;\n  }\n  \n  componentDidMount() {\n    const { message } = this.props;\n    this.emulator = new Emulator(this.body.current);\n    this.emulator.appendText(message.body);\n  }\n  \n  render() {\n    const { classes, message } = this.props;\n    const { ansiFG, ansiBG } = window.client.settings;\n    \n    this.emulator && this.emulator.clear();\n    this.emulator && this.emulator.appendText(message.body);\n    \n    return (\n      <Card className={classes.card}>\n        <CardHeader className={classes.header}\n          title={message.subject}\n          subheader={\n            <span className={classes.sub}>\n              <span className={classes.left}>\n                {message.author}\n              </span>\n              <span className={classes.right}>\n                {message.date}\n              </span>\n            </span>\n          }\n        />\n        <CardContent className={classes.body}>\n          <div ref={this.body} className={classNames(classes.output, ansiFG, ansiBG)}></div>\n        </CardContent>\n        <CardActions className={classes.actions}>\n        </CardActions>\n      </Card>\n    );\n  }\n}\n\nBBMessage.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  message: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles, { withTheme: true })(BBMessage);\n\n","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport BBList from './BBList';\nimport BBMessageList from './BBMessageList';\nimport BBMessage from './BBMessage';\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    position: \"absolute\",\n    height: \"100%\",\n    width: \"100%\",\n    display: \"flex\",\n    \"flex-flow\": \"row nowrap\",\n  },\n  left: {\n    position: \"relative\",\n    maxHeight: \"100%\",\n    flex: 1,\n  },\n  right: {\n    flex: 1,\n    maxHeight: \"100%\",\n    position: \"relative\",\n  },\n  full: {\n    flex: 1,\n    position: \"relative\",\n    display: \"flex\",\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass BBoard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      bbmsg: null,\n      board: null,\n      boardlist: props.boardlist ? props.boardlist : [ ],\n    };\n  }\n  \n  openBB = (key) => {\n    const { boardlist } = this.state;\n    const board = boardlist[key];\n\n    window.client.sendAPI(\"bbmsglist\", board.id);\n  };\n  \n  openBBMsg = (key) => {\n    const { board } = this.state;\n    const msg = board.messages[key];\n\n    window.client.sendAPI(\"bbmsg\", board.id+\"=\"+msg.id);\n  };\n  \n  componentDidMount() {\n    window.client.react.bboard = this;\n  }\n  \n  componentWillUnmount() {\n    window.client.react.bboard = null;\n  }\n  \n  updateBoardList(boardlist) {\n    this.setState({ boardlist, board: null, bbmsg: null });\n  }\n  \n  updateBoard(board) {\n    this.setState({ board, bbmsg: null });\n  }\n  \n  openMessage(bbmsg) {\n    const { board } = this.state;\n    board.messages.forEach((bb,i) => {\n      if (bbmsg.id === bb.id) {\n        bbmsg.key = i;\n      }\n    });\n    this.setState({ bbmsg });\n  }\n\n  render() {\n    const { classes } = this.props;\n    const { boardlist, board, bbmsg } = this.state;\n\n    return (\n      <div className={classes.frame}>\n        { board ? (\n          <div className={classes.full}>\n            <div className={classes.left}>\n              <BBMessageList board={board} openMessage={this.openBBMsg} />\n            </div>\n            <div className={classes.right}>\n              { bbmsg && (\n                <BBMessage message={bbmsg} />\n              )}\n            </div>\n          </div>\n        ) : (\n          <div className={classes.full}>\n            <div className={classes.left}>\n              <BBList boardlist={boardlist} openBoard={this.openBB} />\n            </div>\n            <div className={classes.right}></div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nBBoard.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  folder: PropTypes.number,\n  maillist: PropTypes.array,\n  mailitem: PropTypes.object,\n  unread: PropTypes.number,\n};\n\nexport default withStyles(styles, { withTheme: true })(BBoard);\n\n\t","\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport RedoIcon from '@material-ui/icons/Redo';\n\nimport AceEditor from 'react-ace';\nimport 'brace/mode/mushcode';\nimport 'brace/theme/tomorrow_night_bright';\n\n//////////////////////////////////////////////////////////////////////\n\n\nconst styles = theme => ({\n  frame: {\n    position: \"absolute\",\n    display: \"flex\",\n    height: \"100%\",\n    width: \"100%\",\n    \"flex-flow\": \"column nowrap\",\n  },\n  editor: {\n    flex: 1,\n  },\n  flex: {\n    display: 'flex',\n  },\n  stretch: {\n    flex: 1,\n  },\n  stretchflex: {\n    display: \"flex\",\n    flex: 1,\n  },\n  pad: {\n    margin: \"1em\",\n  },\n  padded: {\n    margin: theme.spacing.unit,\n  },\n});\n\n\n//////////////////////////////////////////////////////////////////////\n\n\nclass Upload extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      uploading: false,\n      text: \"\",\n      delay: 1000,\n    };\n    this.text = \"\";\n    this.editor = React.createRef();\n  }\n  \n  componentDidMount() {\n    window.client.react.upload = this;\n    \n    const { panel } = this.props;\n    panel.options.resizeit.resize = this.onResize;\n    window.client.panels.resizeit(panel, panel.options.resizeit);\n  }\n  \n  componentWillUnmount() {\n    window.client.react.upload = null;\n  }\n  \n  setText(text) {\n    this.text = text;\n    this.setState({ text });\n  }\n  \n  uploadLine() {\n    const { text } = this.state;\n    var { delay } = this.state;\n    \n    if (delay < 100) {\n      delay = 100;\n    } else if (delay > 100000) {\n      delay = 100000;\n    }\n    \n    setTimeout(() => {\n      const { uploading } = this.state;\n      if (!uploading) return;\n    \n      var lines = text.split('\\n');\n      if (lines.length > 0) {\n      \n        var line = lines[0];\n        if (line.length > 0) {\n          window.client.sendCommand(line);\n        }\n        \n        // remove the sent command\n        lines.splice(0,1);\n        var newtext = lines.join('\\n');\n        this.setState({ text: newtext });\n        \n        if (lines.length > 0) {\n          // queue the next line\n          this.uploadLine();\n        } else {\n          this.setState({ uploading: false });\n          window.client.closePanel(\"Upload\");\n        }\n      } else {\n        // we reached the end of the file, close up\n        this.setState({ uploading: false });\n        window.client.closePanel(\"Upload\");\n      }\n      \n    }, delay);\n  }\n  \n  startUpload = () => {\n    this.setState({ uploading: true });\n    this.uploadLine();\n  };\n  \n  pauseUpload = () => {\n    this.setState({ uploading: false });\n  };\n\n  resetText = () => {\n    this.setState({ text: this.text });\n  };\n  \n  changeDelay = event => {\n    const { uploading } = this.state;\n    if (uploading) return;\n    \n    var delay = event.target.value;\n    this.setState({ delay });\n  };\n  \n  changeText = text => {\n    const { uploading } = this.state;\n    if (uploading) return;\n    \n    this.setText(text);\n  };\n  \n  onResize = () => {\n    this.editor.current.editor.resize();\n  };\n  \n  render() {\n    const { classes } = this.props;\n    const { text, uploading, delay } = this.state;\n\n    return (\n      <div className={classes.frame}>\n        <AceEditor\n          className={classes.editor}\n          ref={this.editor}\n          mode=\"mushcode\"\n          width=\"100%\"\n          theme=\"tomorrow_night_bright\"\n          value={text}\n          onChange={this.changeText}\n          readOnly={uploading}\n          wrapEnabled={true}\n          highlightActiveLine={false}\n          editorProps={{ $blockScrolling: Infinity }}\n        />\n        <div className={classes.flex}>\n          <div className={classes.stretchflex}>\n            <div className={classes.pad}></div>\n            <TextField className={classes.padded} label=\"Command delay (in ms)\" value={delay} type=\"number\" variant=\"outlined\" onChange={this.changeDelay} fullWidth />\n          </div>\n          { !uploading ? (\n            <div className={classes.stretchflex}>\n              <Tooltip title=\"Start uploading.\">\n                <Button className={classes.stretch} onClick={this.startUpload}>\n                  <CloudUploadIcon />\n                </Button>\n              </Tooltip>\n              <Tooltip title=\"Reset partially uploaded text.\">\n                <Button className={classes.stretch} onClick={this.resetText}>\n                  <RedoIcon />\n                </Button>\n              </Tooltip>\n            </div>\n          ) : (\n            <div className={classes.stretchflex}>\n              <Tooltip title=\"Pause uploading.\">\n                <Button className={classes.stretch} onClick={this.pauseUpload}>\n                  <PauseIcon />\n                </Button>\n              </Tooltip>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nUpload.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  panel: PropTypes.object,\n};\n\nexport default withStyles(styles, { withTheme: true })(Upload);\n\n\t","// MU* protocol carried over the WebSocket API.\nclass Connection {\n\n  static get CHANNEL_TEXT() { return 't'; }\n  static get CHANNEL_JSON() { return 'j'; }\n  static get CHANNEL_HTML() { return 'h'; }\n  static get CHANNEL_PUEBLO() { return 'p'; }\n  static get CHANNEL_PROMPT() { return '>'; }\n\n  constructor(url) {\n    var that = this;\n    \n    this.url = url;\n    this.socket = null;\n    this.isOpen = false;\n    \n    this.onOpen = null;\n    this.onError = null;\n    this.onClose = null;\n\n    this.onUpdate = null;\n    this.onText = null;\n    this.onObject = null;\n    this.onHTML = null;\n    this.onPueblo = null;\n    this.onPrompt = null;\n    \n    this.hasData = false;\n    \n    this.reconnect(that);\n  }\n  \n  static reconnect(that) {\n    that.reconnect();\n  }\n  \n  static onopen(that, evt) {\n    that.isOpen = true;\n    that.onOpen && that.onOpen(evt);\n  }\n\n  static onerror(that, evt) {\n    that.isOpen = false;\n    that.onError && that.onError(evt);\n  }\n\n  static onclose(that, evt) {\n    that.isOpen = false;\n    that.onClose && that.onClose(evt);\n  }\n\n  static onmessage(that, evt) {\n    that.onMessage && that.onMessage(evt.data[0], evt.data.substring(1));\n  }\n\n  reconnect() {\n    var that = this;\n    \n    // quit the old connection, if we have one\n    if (this.isConnected()) {\n      this.sendText('QUIT');\n    }\n\n    this.socket = new window.WebSocket(this.url);\n    this.isOpen = false;\n\n    this.socket.onopen = function (evt) {\n      Connection.onopen(that, evt);\n    };\n\n    this.socket.onerror = function (evt) {\n      Connection.onerror(that, evt);\n    };\n\n    this.socket.onclose = function (evt) {\n      Connection.onclose(that, evt);\n    };\n\n    this.socket.onmessage = function (evt) {\n      Connection.onmessage(that, evt);\n    };\n  }\n  \n  isConnected() {\n    return (this.socket && this.isOpen && (this.socket.readyState === 1));\n  }\n\n  close() {\n    this.socket && this.socket.close();\n  }\n\n  sendText(data) {\n    this.isConnected() && this.socket.send(Connection.CHANNEL_TEXT + data + '\\r\\n');\n  }\n\n  sendObject(data) {\n    this.isConnected() && this.socket.send(Connection.CHANNEL_JSON + window.JSON.stringify(data));\n  }\n\n  onMessage(channel, data) {\n    this.onUpdate && this.onUpdate(channel, data);\n    this.hasData = true;\n    \n    switch (channel) {\n    case Connection.CHANNEL_TEXT:\n      this.onText && this.onText(data);\n      break;\n\n    case Connection.CHANNEL_JSON:\n      try {\n        this.onObject && this.onObject(window.JSON.parse(data));\n      }\n      catch (e) {\n        console.log(\"JSON ERROR \", e, data);\n      }\n      break;\n\n    case Connection.CHANNEL_HTML:\n      this.onHTML && this.onHTML(data);\n      break;\n\n    case Connection.CHANNEL_PUEBLO:\n      this.onPueblo && this.onPueblo(data);\n      break;\n    \n    case Connection.CHANNEL_PROMPT:\n      this.onPrompt && this.onPrompt(data);\n      break;\n\n    default:\n      window.console && window.console.log('unhandled message', channel, data);\n      return false;\n    }\n\n    return true;\n  }\n\n\n}\n\nexport default Connection;\n\n","class UserInput {\n\n  //////////////////////////////////////////////////////////////\n  // clear the history for a given UserInput object\n  static clearhistory(that) {\n    that.clearHistory && that.clearHistory();\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // passthrough to the local onKeyDown callback\n  static onkeydown(that, evt) {\n    that.onKeyDown && that.onKeyDown(evt);\n  }\n\n  //////////////////////////////////////////////////////////////\n  // passthrough to the local onKeyUp callback\n  static onkeyup(that, evt) {\n    that.onKeyUp && that.onKeyUp(evt);\n  }\n  \n  //////////////////////////////////////////////////////////////\n  static isKeyCycleForward(that, key) {\n    if (that && that.keyCycleForward) {\n      return that.keyCycleForward(key);\n    } else {\n      // default key is ctrl+n\n      return (key.code === 78 && key.ctrl);\n    }\n  }\n  \n  //////////////////////////////////////////////////////////////\n  static isKeyCycleBackward(that, key) {\n    if (that && that.keyCycleBackward) {\n      return that.keyCycleBackward(key);\n    } else {\n      // default key is ctrl+p\n      return (key.code === 80 && key.ctrl);\n    }\n  }\n  \n  //////////////////////////////////////////////////////////////////\n  // default handler for key press events\n  static pressKey(that, e) {\n    var key = { code: (e.keyCode ? e.keyCode : e.which),\n                ctrl: e.ctrlKey,\n                shift: e.shiftKey,\n                alt: e.altKey };\n\n    var prevent = true;\n    \n    if (UserInput.isKeyCycleBackward(that, key)) {\n\n      // cycle history backward\n      that.cycleBackward();\n\n    } else if (UserInput.isKeyCycleForward(that, key)) {\n\n      // cycle history forward\n      that.cycleForward();\n\n    } else if (key.code === 13) {\n      // enter key\n      \n      // save the command string and clear the input box\n      var cmd = that.root.value;\n      that.saveCommand();\n\n      // pass through to the local callback for sending data\n      that.onEnter && that.onEnter(cmd);\n        \n    } else if (key.code === 27) {\n\n      // pass through to the local callback for the escape key\n      that.onEscape && that.onEscape();\n    \n    } else if (key.code === 33) {\n    \n      // pass through to the local callback for the pageup key\n      that.onPageUp && that.onPageUp();\n\n    } else if (key.code === 34) {\n\n      // pass through to the local callback for the pagedown key\n      that.onPageUp && that.onPageDown();\n\n    } else { \n      // didn't capture anything, pass it through\n      prevent = false;\n\n    }\n    \n    if (prevent) {\n      e.preventDefault();\n    }\n\n    // make sure input retains focus\n    that.focus();\n  }\n\n  //////////////////////////////////////////////////////////////////\n  // default handler for key release events\n  static releaseKey(that, e) {\n    var key = { code: (e.keyCode ? e.keyCode : e.which),\n                ctrl: e.ctrlKey,\n                shift: e.shiftKey,\n                alt: e.altKey };\n\n    if (UserInput.isKeyCycleBackward(that, key) ||\n        UserInput.isKeyCycleForward(that, key)) {\n\n      // move the cursor to end of the input text after a history change\n      that.moveCursor();\n    }\n  }\n  //////////////////////////////////////////////////////////////\n  // User input handler (command history, callback events)\n  constructor(root) {\n    var that = this;\n    \n    this.root = root;\n    \n    this.selectionStart = 0;\n    this.selectionStop = 0;\n    \n    // user-defined handlers for main actions\n    this.onEnter = null;\n    this.onEscape = null;\n    this.onPageUp = null;\n    this.onPageDown = null;\n\n    // user-defined keys for command history\n    this.keyCycleForward = null;\n    this.keyCycleBackward = null;\n    \n    this.clearHistory();\n    \n    this.root.onkeydown = function(evt) {\n      UserInput.onkeydown(that, evt);\n    };\n    \n    this.root.onkeyup = function(evt) {\n      UserInput.onkeyup(that, evt);\n    };\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // set the default onKeyDown handler\n  onKeyDown(e) {\n    UserInput.pressKey(this, e);\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // set the default onKeyUp handler\n  onKeyUp(e) {\n    UserInput.releaseKey(this, e);\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // clear the command history\n  clearHistory() {\n    this.history = [];\n    this.ncommand = 0;\n    this.save_current = '';\n    this.current = -1;\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // push a command onto the history list and clear the input box\n  saveCommand() {\n    if (this.root.value !== '') {\n      this.history[this.ncommand] = this.root.value;\n      this.ncommand++;\n      this.save_current = '';\n      this.current = -1;\n      this.root.value = '';\n    }\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // cycle the history backward\n  cycleBackward() {\n    // save the current entry in case we come back\n    if (this.current < 0) {\n      this.save_current = this.root.value;\n    }\n    \n    // cycle command history backward\n    if (this.current < this.ncommand - 1) {\n      this.current++;\n      this.root.value = this.history[this.ncommand - this.current - 1];\n    }\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // cycle the history forward\n  cycleForward() {\n    // cycle command history forward\n    if (this.current > 0) {\n      this.current--;\n      this.root.value = this.history[this.ncommand - this.current - 1];\n    } else if (this.current === 0) {\n      // recall the current entry if they had typed something already\n      this.current = -1;\n      this.root.value = this.save_current;\n    }\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // move the input cursor to the end of the input elements current text\n  moveCursor() {\n    if (typeof this.root.selectionStart === \"number\") {\n        this.root.selectionStart = this.root.selectionEnd = this.root.value.length;\n    } else if (typeof this.root.createTextRange !== \"undefined\") {\n        this.focus();\n        var range = this.root.createTextRange();\n        range.collapse(false);\n        range.select();\n    }\n  }\n  \n  // save the cursor position\n  saveCursor() {\n    this.selectionStart = this.root.selectionStart;\n    this.selectionStop = this.root.selectionStop;\n  }\n  \n  // reset cursor position\n  resetCursor() {\n    if (this.selectionStart && this.selectionStop) {\n      this.root.selectionStart = this.selectionStart;\n      this.root.selectionStop = this.selectionStop;\n      this.selectionStart = null;\n      this.selectionStop = null;\n    } else {\n      this.root.selectionStart = this.root.selectionStop = this.root.value.length;\n    }\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // clear the current input text\n  clear() {\n    this.root.value = '';\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // get the current text in the input box\n  value() {\n    return this.root.value;\n  }\n  \n  //////////////////////////////////////////////////////////////\n  // refocus the input box\n  focus(force) {\n  \n    // see if we are selecting some text\n    var text = \"\";\n    \n    if (!force) {\n      if (window.getSelection) {\n        text = window.getSelection().toString();\n      } else if (document.selection && document.selection.type !== \"Control\") {\n        text = document.selection.createRange().text;\n      }\n      \n      // or if we are in an input element\n      var element = document.activeElement;\n      var tagName = element.tagName.toLowerCase();\n      if (tagName === 'textarea') return;\n      \n      if (tagName === 'input') {\n        var type = element.getAttribute('type').toLowerCase();\n        // if any of these input types is not supported by a browser, it will behave as input type text.\n        var inputTypes = ['text', 'password', 'number', 'email', 'tel', 'url', 'search', 'date', 'datetime', 'datetime-local', 'time', 'month', 'week'];\n        if (inputTypes.indexOf(type) >= 0) {\n          return;\n        }\n      }\n    }\n    \n    var re_blank = /^\\w*$/;\n    // if we are selecting or inputting, don't focus\n    if (text.match(re_blank)) {\n      this.root.focus();\n    }\n  } \n\n}\n\nexport default UserInput;\n\n","class Utils {\n\n  //////////////////////////////////////////////////////////////////\n  // Link scanner function search line for links and returns an array\n  static extractLinks(line) {\n    var links = [], result;\n    var regex = /(^|[^a-zA-Z0-9]+)(?:((?:http|https):\\/\\/[-a-zA-Z0-9_.~:/?#[\\]@!$&'()*+,;=%]+[-a-zA-Z0-9_~:/?#@!$&*+;=%])|([-.+a-zA-Z0-9_]+@[-a-zA-Z0-9]+(?:\\.[-a-zA-Z0-9]+)+)|(@[a-zA-Z]\\w*))/g;\n\n\n    regex.lastIndex = 0;\n    while ((result = regex.exec(line))) {\n      var info = {};\n\n      info.start = result.index + result[1].length;\n      info.xch_cmd = '';\n      if (result[2]) {\n        result = result[2];\n        info.url = result;\n      } else if (result[3]) {\n        result = result[3];\n        info.url = 'mailto:' + result;\n      } else if (result[4]) {\n        result = result[4];\n        info.url = '';\n        info.xch_cmd = 'help ' + result;\n        info.className = \"ansi-1-37\";\n      }\n\n      info.end = info.start + result.length;\n\n      links[links.length] = info;\n    }\n\n    return links;\n  }\n\n  //////////////////////////////////////////////////////////////////\n  // some string helper functions for replacing links and user input tokens\n  // Example onLine() handler that linkifies URLs in text.\n  static parseLinks(that, lineBuf) {\n    // Merge text so we can scan it.\n    if (!lineBuf.length) {\n      return;\n    }\n    \n    var ii, ilen;\n    var line = '';\n\n    for (ii = 0, ilen = lineBuf.length; ii < ilen; ++ii) {\n      line += lineBuf[ii].nodeValue;\n    }\n\n    // Scan the merged text for links.\n    var links = Utils.extractLinks(line);\n    if (!links.length) {\n      return;\n    }\n\n    // Find the start and end text nodes.\n    var nodeIdx = 0, nodeStart = 0, nodeEnd = lineBuf[0].nodeValue.length;\n    for (ii = 0, ilen = links.length; ii < ilen; ++ii) {\n      var info = links[ii], startOff, startNode, endOff, endNode;\n\n      while (nodeEnd <= info.start) {\n        nodeStart = nodeEnd;\n        nodeEnd += lineBuf[++nodeIdx].nodeValue.length;\n      }\n\n      startOff = info.start - nodeStart;\n      startNode = lineBuf[nodeIdx];\n\n      while (nodeEnd < info.end) {\n        nodeStart = nodeEnd;\n        nodeEnd += lineBuf[++nodeIdx].nodeValue.length;\n      }\n\n      endOff = info.end - nodeStart;\n      endNode = lineBuf[nodeIdx];\n\n      // Wrap the link text.\n      // TODO: In this version, we won't try to cross text nodes.\n      // TODO: Discard any text nodes that are already part of links?\n      if (startNode !== endNode) {\n        window.console && window.console.warn('link', info);\n        continue;\n      }\n\n      lineBuf[nodeIdx] = endNode.splitText(endOff);\n      nodeStart += endOff;\n\n      var middleNode = startNode.splitText(startOff);\n      var anchor = document.createElement('a');\n      middleNode.parentNode.replaceChild(anchor, middleNode);\n\n      anchor.target = '_blank';\n      if (info.url === '' && info.xch_cmd !== '') {\n        anchor.setAttribute('onClick', 'this.onCommand(\"'+info.xch_cmd+'\");');\n        anchor.onCommand = that.onCommand;\n      } else {\n        anchor.href = info.url;\n      }\n      anchor.appendChild(middleNode);\n    }\n  }\n\n\n  //////////////////////////////////////////////////////////////////\n  // detect if more user input is required for a pueblo command\n  static parseCommand(command) {\n    var cmd = command;\n    var regex = /\\?\\?/;\n    \n    // check for the search token '??'\n    if (cmd.search(regex) !== -1) {\n      var val = prompt(command);\n      \n      if (val === null) {\n        // user cancelled the prompt, don't send any command\n        cmd = '';\n      } else {\n        // replace the ?? token with the prompt value\n        cmd = cmd.replace(regex, val);\n      }\n    }\n    \n    return cmd;\n  }\n}\n\nexport default Utils;\n\n","\nconst JSONAPI = {\n  maillist: function(self, args) {\n    self.sendText(\"th null(oob(%#,maillist,json(object,folder,json(number,if(%0,before(%0,:),0)),maillist,\\\\[[iter(maillist(%#,if(%0,before(%0,:):,0:)),json(object,id,json(string,%i0),deleted,switch(setr(0,mailstatus(%#,%i0)),*C*,true,false),unread,switch(%q0,N*,true,false),urgent,switch(%q0,*U*,true,false),time,json(string,mailtime(%#,%i0)),subject,json(string,mailsubject(%#,%i0)),from,json(string,if(setr(0,mailfrom(%#,%i0)),name(%q0),!PURGED!))),,\\\\,)]\\\\],unread,json(number,extract(mailfstats(%#),6,1)))))\");\n  },\n  mailitem: function(self, args) {\n    self.sendText(\"th null(oob(%#,mailitem,json(object,id,json(string,\"+args+\"),deleted,switch(setr(0,mailstatus(%#,\"+args+\")),*C*,true,false),unread,switch(%q0,N*,true,false),urgent,switch(%q0,*U*,true,false),time,json(string,mailtime(%#,\"+args+\")),subject,json(string,mailsubject(%#,\"+args+\")),from,json(string,if(setr(0,mailfrom(%#,\"+args+\")),name(%q0),!PURGED!)),body,json(string,mail(%#,\"+args+\")))))\");\n  },\n  boardlist: function(self, args) {\n    self.sendText(\"+bbread\");\n  },\n  bbmsglist: function(self, args) {\n    self.sendText(\"+bbread \"+args);\n  },\n  bbmsg: function(self, args) {\n    self.sendText(\"+bbread \"+args);\n  },\n  listcontents: function(self, args) {\n    self.sendText(\"th null(oob(%#,listcontents,json(object,players,\\\\[[iter(remove(lvplayers(%l),%#),json(string,name(%i0)),,\\\\,)]\\\\],exits,\\\\[[iter(lexits(%l),json(string,fullname(%i0)),,\\\\,)]\\\\],things,\\\\[[iter(lvthings(%l),json(string,name(%i0)),,\\\\,)]\\\\])))\");\n  },\n};\n\nexport default JSONAPI;\n","\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { MuiThemeProvider } from '@material-ui/core/styles';\n\nimport saveAs from 'file-saver';\n\nimport Theme from '../modules/Theme';\nimport Chargen from '../modules/Chargen';\nimport Mailbox from '../modules/Mailbox';\nimport Sendmail from '../modules/Sendmail';\nimport BBoard from '../modules/BBoard';\nimport Upload from '../modules/Upload';\n\nimport Connection from './connection';\nimport Emulator from './emulator';\nimport UserInput from './userinput';\nimport Utils from './utils';\nimport JSONAPI from './jsonapi';\n\nimport './ansi.css';\nimport './scrollbar.css';\nimport 'jspanel4/dist/jspanel.min.css';\n\nimport { jsPanel } from 'jspanel4';\n\nimport shortid from 'shortid';\n\n//import 'jspanel4/es6module/extensions/hint/jspanel.hint.js';\n//import 'jspanel4/es6module/extensions/modal/jspanel.modal.js';\n//import 'jspanel4/es6module/extensions/contextmenu/jspanel.contextmenu.js';\n//import 'jspanel4/es6module/extensions/tooltip/jspanel.tooltip.js';\n//import 'jspanel4/es6module/extensions/layout/jspanel.layout.js';\n//import 'jspanel4/es6module/extensions/dock/jspanel.dock.js';\n\nconst EventEmitter = require('events');\nconst TinyCon = require('tinycon');\n\nconst LOGINFAIL = [\n  /There is no player with that name\\./,\n  /That is not the correct password\\./,\n  /Either that player does not exist, or has a different password\\./,\n  /You cannot connect to that player at this time\\./,\n  /Guest connections not allowed\\./,\n  /Connection to .* (Non-GUEST) not allowed from .* (.*)/,\n  /Too many guests are connected now\\./\n];\n\nclass Client {\n\n  constructor() {\n    // client settings\n    this.settings = {\n      // default emulator fg/bg\n      ansiFG: 'ansi-37',\n      ansiBG: 'ansi-40',\n      wrapWidth: 100,\n      // upload editor\n      decompileEditor: true,\n      decompileKey: 'FugueEdit > ',\n      // sidebar navigation\n      sidebarOpen: true,\n      sidebarAnchor: \"left\",\n      sidebarWidth: \"192px\",\n      sidebarAlwaysShow: true,\n      sidebarShowPlayers: true,\n      sidebarShowThings: true,\n      sidebarShowExits: true,\n      sidebarShowCompass: true,\n      // debugging\n      debugEvents: false,\n      // connection settings,\n      serverAddress: \"node.grapenut.org\",\n      serverPort: 2001,\n      serverSSL: true,\n    };\n    this.defaultSettings = Object.assign({}, this.settings);\n    this.loadSettings();\n    \n    // Terminal UI elements\n    this.output = null;\n    this.prompt = null;\n    this.input = null;\n    \n    // App Components\n    this.events = new EventEmitter();\n    this.panels = jsPanel;\n    this.theme = Theme;\n    this.tinycon = TinyCon;\n    \n    // React Components\n    this.react = {\n      portal: null,\n      taskbar: null,\n      terminal: null,\n      input: null,\n      statusbar: null,\n      login: null,\n      mailbox: null,\n      sendmail: null,\n      bboard: null,\n      upload: null,\n    };\n    \n    // client variables\n    this.conn = null;\n    this.container = null;\n\n    // app instance toggles\n    this.loggedIn = false;\n    this.jsonapi = false;\n    this.hidden = false;\n    this.updateCounter = 0;\n    this.updateLines = 0;\n    this.eatNewline = false;\n    \n    // delay time for auto-contents\n    this.delayContents = 500;\n    \n    // number of lines of scroll within which the output scroll down when new items are received\n    this.scrollThreshold = 5;\n    \n    // handle auto-reconnects\n    this.reconnectTimer = 2000;\n    this.reconnectCount = 0;\n    this.reconnectMaxCount = 10;\n    \n    // init other libraries\n    window.client = this;\n    this.initPanels();\n    this.initNotifications();\n  }\n  \n  // load additional scripts for custom events\n  loadScript(src) {\n    var tag = document.createElement('script');\n    tag.async = false;\n    tag.src = src;\n    document.getElementsByTagName('body')[0].appendChild(tag);\n  }\n  \n  // load settings from localstorage\n  loadSettings() {\n    const store = window.localStorage;\n    Object.keys(this.settings).forEach((key) => {\n      if (store[\"settings_\"+key]) {\n        this.changeSetting(key, store[\"settings_\"+key]);\n      }\n    });\n  }\n  \n  // save settings to localstorage\n  saveSettings() {\n    const store = window.localStorage;\n    Object.keys(this.settings).forEach((key) => {\n      store[\"settings_\"+key] = String(this.settings[key]);\n    });\n  }\n  \n  // change a setting, casting the string argument to the correct type\n  changeSetting(key, value) {\n    if (!this.settings.hasOwnProperty(key)) return;\n    \n    var type = typeof this.settings[key];\n    \n    if (typeof value === type) {\n      this.settings[key] = value;\n      return;\n    }\n    \n    switch (type) {\n      case \"string\":\n        this.settings[key] = String.bind(null, value)();\n        break;\n      case \"number\":\n        this.settings[key] = Number.bind(null, value)();\n        break;\n      case \"boolean\":\n        this.settings[key] = (value === \"true\" ? true : false);\n        break;\n      default:\n        this.settings[key] = value;\n        break;\n    }\n  }\n  \n  // pueblo command links, prompt for user input and replace ?? token if present\n  onCommand(cmd) {\n    this.sendCommand && this.sendCommand(Utils.parseCommand(cmd));\n  }\n\n  // log messages to the output terminal\n  appendMessage(classid, msg) {\n    var scroll = false;\n    if (this.output) {\n      if (this.output.nearBottom(this.scrollThreshold)) {\n        scroll = true;\n      }\n      \n      this.output.appendMessage(classid, msg);\n      \n      scroll && this.output.scrollDown();\n      \n      this.react.terminal && this.react.terminal.onChange();\n    }\n  }\n  \n  /////////////////////////////////////////////////////////////////////////////////////////////////\n  \n  // clear terminal\n  clear() {\n    this.output && this.output.clear();\n    this.prompt && this.prompt.clear();\n    this.input && this.input.clear();\n  }\n\n  // initialize terminal input window\n  initInput(input) {\n    // Input window\n    if (input !== null) {\n      this.input = new UserInput(input);\n\n      // enter key passthrough from UserInput.pressKey\n      this.input.onEnter = (cmd) => { this.sendCommand(cmd); this.prompt && this.prompt.clear(); };\n\n      // escape key passthrough from UserInput.pressKey\n      this.input.onEscape = () => { this.input.clear(); };\n      \n      // pageup key passthrough from UserInput.pressKey\n      this.input.onPageUp = () => { this.output && this.output.scrollPageUp(); };\n\n      // pagedown key passthrough from UserInput.pressKey\n      this.input.onPageDown = () => { this.output && this.output.scrollPageDown(); };\n    }\n  }\n\n  // initialize terminal output window\n  initOutput(output, container=null) {\n    // Output window\n    if (output !== null) {\n      this.output = new Emulator(output);\n      this.output.container = container;\n      this.output.onCommand = (cmd) => { this.onCommand(cmd); };\n\n      output.onunload = () => { this.sendText('QUIT'); this.close(); };\n      output.onresize = () => { this.output && this.output.scrollDown(); };\n    }\n  }\n  \n  // initialize command prompt\n  initPrompt(prompt) {\n    // Prompt window\n    if (prompt !== null) {\n      this.prompt = new Emulator(prompt);\n    }\n  }\n  \n  /////////////////////////////////////////////////////////////////////////////////////////////////\n  \n  //////////////////////////////////////////////////////\n  // animate scrolling the terminal window to the bottom\n  scrollDown(root) {\n    if (!root) {\n      return;\n    }\n\n    root.scrollTop = this.root.scrollHeight;\n    return;\n/*    \n    // animated scrolling alternative\n    var scrollCount = 0;\n    var scrollDuration = 500.0;\n    var oldTimestamp = performance.now();\n    \n    var step = (newTimestamp) => {\n      var bottom = root.scrollHeight - root.clientHeight;\n      var delta = (bottom - root.scrollTop) / 2.0;\n\n      scrollCount += Math.PI / (scrollDuration / (newTimestamp - oldTimestamp));\n      if (scrollCount >= Math.PI) root.scrollTo(0, bottom);\n      if (root.scrollTop === bottom) { return; }\n      root.scrollTo(0, Math.round(root.scrollTop + delta));\n      oldTimestamp = newTimestamp;\n      window.requestAnimationFrame(step);\n    };\n    \n    window.requestAnimationFrame(step);\n*/\n  }\n  \n  // input focus passthrough\n  focus(force) {\n    this.input && this.input.focus(force);\n  }\n  \n  // wrapper that scrolls the output if needed\n  scrollIfNeeded(fun) {\n    var scroll = false;\n    \n    if (this.output) {\n      if (this.output.nearBottom(this.scrollThreshold)) {\n        scroll = true;\n      }\n      \n      fun()\n      \n      scroll && this.output.scrollDown();\n      \n      this.react.terminal && this.react.terminal.onChange();\n    }\n  }\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n  \n  addReactPanel(name, cfg) {\n    var el = null;\n    var obj = null;\n    switch (name) {\n      case 'Chargen':\n        el = Chargen;\n        break;\n      case 'Mailbox':\n        el = Mailbox;\n        obj = this.react.mailbox;\n        break;\n      case 'Upload':\n        el = Upload;\n        obj = this.react.upload;\n        break;\n      case 'Sendmail':\n        el = Sendmail;\n        obj = this.react.sendmail;\n        break;\n      case 'BBoard':\n        el = BBoard;\n        obj = this.react.bboard;\n        break;\n      default:\n        break;\n    }\n    \n    if (!el) {\n      return;\n    }\n    \n    if (obj) {\n      this.focusPanel(name);\n      return;\n    }\n    \n    var config = cfg || {};\n    \n    if (!config.headerTitle) {\n      config.headerTitle = name;\n    }\n    \n    config.callback = function(container) {\n      container.content.style.backgroundColor = Theme.palette.background.paper;\n      var child = React.createElement(el, { panel: container }, null);\n      ReactDOM.render(React.createElement(MuiThemeProvider, { theme: Theme }, child), container.content);\n    };\n    \n    config.container = this.container;\n    \n    this.panels.create(config);\n  }\n  \n  closePanel(name) {\n    var panels = this.panels.getPanels(function() {\n      return (this.id === name || this.headertitle.innerText === name);\n    });\n    \n    if (panels.length > 0) {\n      if (panels[0].status === 'minimized') {\n        this.react.taskbar.popTask(panels[0]);\n      }\n      panels[0].close();\n    }\n  }\n  \n  focusPanel(name) {\n    var panels = this.panels.getPanels(function() {\n      return (this.id === name || this.headertitle.innerText === name);\n    });\n    \n    if (panels.length > 0) {\n      if (panels[0].status === 'minimized') {\n        this.react.taskbar.popTask(panels[0]);\n      } else {\n        panels[0].unsmallify();\n        panels[0].front();\n      }\n    }\n  }\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n\n  // connect to the game server and setup message handlers\n  connect(host, port, ssl) {\n    var client = this;\n    this.settings.serverAddress = host;\n    this.settings.serverPort = port;\n    this.settings.serverSSL = ssl;\n\n    let serverProto = this.settings.serverSSL ? \"wss://\" : \"ws://\";\n\n    // The connection URL is ws://host:port/wsclient (or wss:// for SSL connections)\n    let serverUrl = serverProto + this.settings.serverAddress + \":\" + this.settings.serverPort + '/wsclient'\n    \n    this.close();\n    this.conn = new Connection(serverUrl);\n\n    // just log a standard message on these socket status events\n    this.conn.onOpen = function (evt) {\n      client.appendMessage('logMessage', '%% Connected.');\n      client.reconnectCount = 0;\n    };\n    \n    this.conn.onError = function (evt) {\n      client.appendMessage('logMessage', '%% Connection error!');\n      console.log(evt);\n    };\n    \n    this.conn.onClose = function (evt) {\n      client.appendMessage('logMessage', '%% Connection closed.');\n      setTimeout(() => { client.reconnect() }, (client.serverSSL ? 2.0 : 1.0) * client.reconnectTimer);\n    };\n    \n    // onMessage callback before data handler\n    this.conn.onUpdate = function(channel, data) {\n      if (!client.conn.hasData) {\n        // this is the first update, show the login screen\n        client.react.login && client.react.login.openLogin();\n        \n        // send the screen dimensions\n        client.sendText(\"SCREENWIDTH \" + client.settings.wrapWidth);\n        client.sendText(\"SCREENHEIGHT \" + Math.floor(client.output.root.parentNode.clientHeight / client.output.dims.height));\n      }\n      \n      if (client.hidden && data.endsWith('\\n')) {\n        client.updateCounter++;\n        // eventually set client.updateLines to the number of new lines\n        // and show that instead\n\n        /* use a timer to prevent update spamming */\n        clearTimeout(client.setBubble);\n        setTimeout(client.setBubble, 1000);\n      }\n    }\n\n    // handle incoming text\n    this.conn.onText = function (text) {\n      if (!client.loggedIn) {\n        // match some login error conditions\n        for (let i = 0; i < LOGINFAIL.length; i++) {\n          if (text.match(LOGINFAIL[i])) {\n            client.react.login && client.react.login.openLogin(text);\n            break;\n          }\n        }\n        \n        // we logged in\n        if (text.match(/Last( FAILED)? connect was from/)) {\n          client.loggedIn = true;\n          setTimeout(() => {\n            if (!client.jsonapi) {\n              client.sendAPI(\"listcontents\");\n            }\n          }, client.delayContents);\n        }\n      }\n    \n      var re_fugueedit = new RegExp('^'+client.settings.decompileKey);\n      if (text.match(re_fugueedit)) {\n        var str = text.replace(re_fugueedit, \"\");\n        client.eatNewline = true;\n        \n        // send @dec/tf to the upload editor, or the command window\n        if (client.settings.decompileEditor) {\n          client.addReactPanel(\"Upload\");\n          client.react.upload.editor.current.editor.insert(str+\"\\n\");\n        } else {\n          client.input.root.value = str;\n        }\n        return;\n      } else if (client.eatNewline && (text === \"\\n\" || text === \"\\r\\n\")) {\n        client.eatNewline = false;\n        return;\n      }\n      \n      client.eatNewline = false;\n      client.scrollIfNeeded(() => client.output.appendText(text));\n    };\n    \n    // handle incoming html\n    this.conn.onHTML = function (fragment) {\n      if (client.output) {\n        client.scrollIfNeeded(() => client.output.appendHTML(fragment));\n      }\n    };\n    \n    // handle incoming pueblo\n    this.conn.onPueblo = function (tag, attrs) {\n      if (client.output) {\n        client.scrollIfNeeded(() => client.output.appendPueblo(tag, attrs));\n      }\n    };\n    \n    // handle incoming command prompts\n    this.conn.onPrompt = function (text) {\n      if (client.prompt !== null) {\n        client.prompt.clear();\n        client.prompt.appendText(text + '\\r\\n');\n      }\n    };\n\n    // handle incoming JSON objects\n    // use the Events handler collection\n    this.conn.onObject = function (obj) {\n      var op = \"\";\n      if (obj.hasOwnProperty('gmcp')) {\n        op = obj.gmcp;\n      } else if (obj.hasOwnProperty('op')) {\n        op = obj.op;\n      }\n      \n      if (op && op !== \"\") {\n        client.settings.debugEvents && console.log(\"JSON \"+op+\":\", obj);\n        client.events.emit(op, obj);\n      } else {\n        client.settings.debugEvents && console.log(\"JSON (unknown):\", obj);\n      }\n    };\n  }\n\n  reconnect() {\n    if (this.isConnected()) {\n      return;\n    }\n    \n    if (this.reconnectCount < this.reconnectMaxCount) {\n      this.reconnectCount++;\n      this.conn && this.conn.reconnect();\n    } else {\n      this.appendMessage('logMessage', '%% Auto-reconnect aborted.');\n    }\n  }\n  \n  isConnected() {\n    return (this.conn && this.conn.isConnected());\n  }\n  \n  close() {\n    this.conn && this.conn.close();\n  }\n  \n  sendText(data) {\n    this.conn && this.conn.sendText(data);\n  }\n  \n  /////////////////////////////////////////////////////////////////////////////////////////////////\n\n  // function to send a user input command string to the server\n  sendCommand(cmd) {\n    if (this.isConnected()) {\n      if (cmd !== '') {\n        this.sendText(cmd);\n        this.scrollIfNeeded(() => this.appendMessage('localEcho', cmd));\n      }\n    } else {\n      // connection was broken, let's force a reconnect\n      this.conn && this.conn.reconnect();\n      this.scrollIfNeeded(() => this.appendMessage('logMessage', '%% Reconnecting to server...'));\n    }\n  }\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////\n  \n  // send an API command, falling back to the raw softcode if the server doesn't support it\n  sendAPI(cmd, args) {\n    if (this.jsonapi) {\n      var str = String(cmd);\n      \n      if (args) {\n        var astr = String(args);\n        if (astr.length > 0) {\n          str += \" \"+astr;\n        }\n      }\n      \n      this.sendText(\"jsonapi/\"+str);\n    } else {\n      if (JSONAPI.hasOwnProperty(cmd)) {\n        JSONAPI[cmd](this, args);\n      }\n    }\n  }\n  \n  execString(code, callback) {\n    var id = \"exec_\"+shortid.generate();\n    var cmd = \"th null(oob(%#,\"+id+\",json(object,result,json(string,\"+code+\"))))\";\n    \n    this.events.on(id, (obj) => {\n      callback(obj.result);\n      this.events.removeAllListeners([id]);\n    });\n    \n    this.sendText(cmd);\n  }\n\n  execJSON(code, callback) {\n    var id = \"exec_\"+shortid.generate();\n    var cmd = \"th null(oob(%#,\"+id+\",\"+code+\"))\";\n    \n    this.events.on(id, (obj) => {\n      callback(obj);\n      this.events.removeAllListeners([id]);\n    });\n    \n    this.sendText(cmd);\n  }\n  \n  \n  /////////////////////////////////////////////////////////////////////////////////////////////////\n  \n  // save the current display to a log file\n  saveLog(filename) {\n    if (!this.output) return;\n    var node = this.output.root;\n    var text = (node.innerText || node.textContent);\n    if (text.length > 0) {\n      var blob = new Blob([text], {type: \"text/html;charset=utf-8\"});\n      saveAs(blob, filename);\n    } else {\n      alert(\"File not saved! The current output is empty.\");\n    }\n  }\n  \n  \n  /////////////////////////////////////////////////////////////////////////////////////////////////\n  \n  \n  setBubble = () => {\n    if (this.hidden) {\n      this.tinycon.setBubble(this.updateCounter);\n    } else {\n      this.tinycon.setBubble(0);\n    }\n  };\n  \n  initNotifications() {\n    // Set the name of the hidden property and the change event for visibility\n    var hidden, visibilityChange; \n    if (typeof document.hidden !== \"undefined\") { // Opera 12.10 and Firefox 18 and later support \n      hidden = \"hidden\";\n      visibilityChange = \"visibilitychange\";\n    } else if (typeof document.msHidden !== \"undefined\") {\n      hidden = \"msHidden\";\n      visibilityChange = \"msvisibilitychange\";\n    } else if (typeof document.webkitHidden !== \"undefined\") {\n      hidden = \"webkitHidden\";\n      visibilityChange = \"webkitvisibilitychange\";\n    }\n    \n    // Warn if the browser doesn't support addEventListener or the Page Visibility API\n    if (typeof document.addEventListener === \"undefined\" || hidden === undefined) {\n      console.log(\"This browser does not support background notifications.\");\n    } else {\n      // Handle page visibility change   \n      document.addEventListener(visibilityChange, () => {\n        this.updateCounter = 0;\n        this.updateLines = 0;\n        if (document[hidden]) {\n          this.hidden = true;\n        } else {\n          this.hidden = false;\n        }\n        this.setBubble();\n      }, false);\n    }\n    \n    // set tinycon options\n    this.tinycon.setOptions({\n      fallback: true,\n      abbreviate: true,\n    });\n  }\n\n  // set panel default parameters and event handlers\n  initPanels() {\n    this.panels.defaults.minimizeTo = false;\n    this.panels.defaults.onminimized = function(container) {\n      window.client.react.taskbar.pushTask(this);\n      window.client.focus();\n    };\n    \n    this.panels.defaults.onclosed = function(container) {\n      ReactDOM.unmountComponentAtNode(container.content)\n      window.client.focus();\n    };\n    \n    this.panels.defaults.dragit.start = function() {\n      window.client.input.saveCursor();\n    };\n    \n    this.panels.defaults.resizeit.start = function() {\n      window.client.input.saveCursor();\n    };\n    \n    this.panels.defaults.dragit.stop = function() {\n      window.client.focus();\n      window.client.input.resetCursor();\n    };\n    \n    this.panels.defaults.resizeit.stop = function() {\n      window.client.focus();\n      window.client.input.resetCursor();\n    };\n  }\n}\n\n\n\nexport default Client;\nexport { Connection, Emulator, UserInput, Utils };\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Portal from './modules/Portal';\nimport Client from './client';\nimport './style.css';\n\n// ========================================\n\n// create the MUSH client\nvar client = new Client();\n\n// render the react Portal app\nReactDOM.render(React.createElement(Portal, null, null), document.getElementById('root'));\n\n// custom handlers for JSON events from the MUSH\nclient.loadScript('./local.js');\n\n// setup client address and connect\nvar serverSSL = window.location.protocol === \"https:\";\nvar defaultAddress = \"node.grapenut.org\";\nvar defaultPort = serverSSL ? '2001' : '2000';\nvar serverAddress = window.location.search.substring(1) ? window.location.search.substring(1).split(\":\")[0] : defaultAddress;\nvar serverPort = window.location.search.substring(1) ? window.location.search.substring(1).split(\":\")[1] : defaultPort;\nclient.connect(serverAddress, serverPort, serverSSL);\n\n\n"],"sourceRoot":""}